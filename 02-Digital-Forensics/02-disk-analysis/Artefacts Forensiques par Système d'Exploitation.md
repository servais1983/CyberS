# Artefacts Forensiques par Système d'Exploitation

## Table des matières
- [Introduction](#introduction)
- [Windows](#windows)
- [macOS](#macos)
- [Linux](#linux)
- [Divers/Autres supports](#diversautres-supports)

## Introduction

Ce document présente une liste exhaustive des artefacts forensiques clés à examiner lors d'une analyse numérique pour Windows, macOS et Linux. Les artefacts sont classés par système d'exploitation et priorité, avec des informations détaillées sur leur emplacement, type, intérêt forensique, outils recommandés et notes spécifiques.

## Windows

| OS | Chemin complet | Type d'artefact | Intérêt forensique | Outils/requêtes conseillés | Priorité | Notes spécifiques |
|---|---|---|---|---|---|---|
| Windows | C:\Windows\System32\config\SAM | Base de données | Comptes utilisateurs, hachages de mots de passe | Registry Explorer, Autopsy, RegRipper | Haute | Nécessite des privilèges élevés, extraire à froid ou via shadow copy |
| Windows | C:\Windows\System32\config\SYSTEM | Base de données | Configuration système, services, pilotes, démarrage | Registry Explorer, Autopsy, RegRipper | Haute | Contient des informations sur les périphériques USB connectés |
| Windows | C:\Windows\System32\config\SOFTWARE | Base de données | Logiciels installés, clés de registre de persistance | Registry Explorer, Autopsy, RegRipper | Haute | Vérifier les clés Run, RunOnce pour la persistance malveillante |
| Windows | C:\Windows\Prefetch | Fichiers d'exécution | Historique d'exécution des programmes (90 jours) | PECmd, Autopsy, Prefetch Parser | Haute | Contient date/heure d'exécution et chemins d'accès aux fichiers |
| Windows | C:\$MFT | Métadonnées système de fichiers | Tous les fichiers (même supprimés), timestamps, taille | MFTECmd, FTK Imager, Autopsy | Haute | Fichier système caché, nécessite outils spécialisés pour extraction |
| Windows | C:\$USNJRNL | Journal système de fichiers | Modifications de fichiers, création, suppression, renommage | UsnJrnl2Csv, ANJP, Velociraptor | Haute | Fichier système caché, extraction via FTK Imager ou outils spécialisés |
| Windows | C:\$Recycle.Bin | Fichiers supprimés | Fichiers supprimés, métadonnées originales, date de suppression | RBCmd, Autopsy, FTK Imager | Haute | Contient $I (métadonnées) et $R (contenu) pour chaque fichier |
| Windows | C:\Users\[user]\AppData\Roaming\Microsoft\Windows\Recent | Historique utilisateur | Fichiers récemment ouverts (LNK), Jump Lists | LECmd, JLECmd, Autopsy | Haute | Les fichiers LNK contiennent des métadonnées sur les fichiers source |
| Windows | C:\Windows\System32\winevt\Logs | Journaux d'événements | Connexions, exécutions, erreurs système, authentifications | EvtxECmd, Event Log Explorer, Hayabusa | Haute | Security.evtx, System.evtx, Application.evtx sont les plus importants |
| Windows | C:\Windows\Tasks | Tâches planifiées | Tâches automatisées, persistance malveillante | Task Scheduler, Autoruns, Autopsy | Haute | Vérifier les tâches inhabituelles ou pointant vers des chemins suspects |
| Windows | C:\Users\[user]\NTUSER.DAT | Base de données | Registre utilisateur, préférences, clés de démarrage | Registry Explorer, RegRipper | Haute | Un fichier par profil utilisateur, contient MRU (Most Recently Used) |
| Windows | C:\Users\[user]\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine | Historique utilisateur | Historique des commandes PowerShell | Éditeur de texte, grep | Haute | Fichier texte ConsoleHost_history.txt contenant les commandes |
| Windows | C:\Windows\Memory.dmp | Mémoire | Dump mémoire après crash, malwares en mémoire | Volatility, Rekall, WinDbg | Haute | Peut contenir des artefacts de malware même après redémarrage |
| Windows | C:\Users\[user]\AppData\Local\ConnectedDevices\Platform | Historique utilisateur | Windows Timeline, activités utilisateur | WxTCmd, Autopsy | Moyenne | Base de données SQLite contenant l'historique des activités |
| Windows | C:\Windows\AppCompat\Programs\Amcache.hve | Base de données | Programmes exécutés, métadonnées, hachages SHA-1 | AmcacheParser, Registry Explorer | Moyenne | Contient des informations sur les exécutables même supprimés |
| Windows | C:\Users\[user]\AppData\Local\Microsoft\Windows\WebCache | Historique navigateur | Historique de navigation IE/Edge, téléchargements | ESEDatabaseView, Autopsy | Moyenne | Base de données ESE, nécessite extraction à froid |
| Windows | C:\Users\[user]\AppData\Local\Microsoft\Windows\UsrClass.dat | Base de données | Associations de fichiers, Shell Bags (vue explorateur) | Registry Explorer, ShellBags Explorer | Moyenne | Contient l'historique de navigation dans l'explorateur Windows |
| Windows | C:\Windows\System32\sru\SRUDB.dat | Base de données | Utilisation réseau, exécution d'applications, consommation énergie | SrumECmd, Autopsy | Moyenne | Nécessite extraction à froid, contient historique d'exécution détaillé |
| Windows | C:\Windows\System32\LogFiles\WMI\RtBackup | Journaux | Événements ETW, connexions réseau, exécutions PowerShell | WEPExplorer, Event Log Explorer | Moyenne | Logs de sauvegarde WMI, peuvent contenir traces d'attaques fileless |
| Windows | C:\Windows\System32\drivers\etc\hosts | Configuration | Redirections DNS, blocage de domaines malveillants | Éditeur de texte, grep | Moyenne | Vérifier les entrées inhabituelles ou les redirections suspectes |

## macOS

| OS | Chemin complet | Type d'artefact | Intérêt forensique | Outils/requêtes conseillés | Priorité | Notes spécifiques |
|---|---|---|---|---|---|---|
| macOS | /var/log | Journaux | Logs système, authentification, applications | log collect, Automator, grep | Haute | Vérifier auth.log, system.log, install.log pour activités suspectes |
| macOS | /private/var/db/diagnostics | Journaux | Unified Logs, activité système détaillée | log show, Unified Log Explorer | Haute | Logs au format .tracev3, nécessite outils spécifiques |
| macOS | /private/var/db/tcc/tcc.db | Base de données | Autorisations de confidentialité (caméra, micro, localisation) | sqlite3, DB Browser for SQLite | Haute | Vérifier les autorisations accordées à des applications suspectes |
| macOS | /private/var/db/Quarantines | Sécurité | Fichiers téléchargés mis en quarantaine | sqlite3, DB Browser for SQLite | Haute | Base de données des fichiers téléchargés avec source et timestamp |
| macOS | ~/Library/Safari | Historique navigateur | Historique Safari, téléchargements, cookies | sqlite3, DB Browser for SQLite | Haute | History.db contient l'historique de navigation |
| macOS | ~/Library/Application Support/Google/Chrome | Historique navigateur | Historique Chrome, téléchargements, cookies | sqlite3, DB Browser for SQLite | Haute | Dossier 'Default' contient History, Cookies, etc. |
| macOS | /private/var/db/dslocal/nodes/Default | Base de données | Comptes utilisateurs, groupes, permissions | dscl, plutil | Haute | Contient plist des utilisateurs et groupes |
| macOS | /private/var/audit | Journaux | Logs d'audit système | praudit, Audit Explorer | Haute | Logs binaires, nécessite outils spécifiques pour analyse |
| macOS | /Library/LaunchDaemons | Configuration | Services système, persistance malveillante | launchctl, plutil | Haute | Vérifier les plist inhabituels ou récemment modifiés |
| macOS | ~/Library/LaunchAgents | Configuration | Services utilisateur, persistance malveillante | launchctl, plutil | Haute | Vérifier les plist inhabituels ou récemment modifiés |
| macOS | ~/.bash_history | Historique utilisateur | Historique des commandes shell | cat, grep | Haute | Vérifier aussi .zsh_history pour les versions récentes de macOS |
| macOS | ~/Library/Preferences | Configuration | Préférences applications, paramètres utilisateur | plutil, Plist Editor Pro | Moyenne | Fichiers .plist contenant configurations et préférences |
| macOS | ~/Library/Containers | Applications | Données des applications sandboxées | find, grep, Automator | Moyenne | Contient données et préférences des applications App Store |
| macOS | /System/Library/Spotlight | Métadonnées | Index de recherche, métadonnées de fichiers | mdls, mdfind, Spotlight Importer | Moyenne | Contient métadonnées même pour fichiers supprimés |
| macOS | ~/Library/Application Support/com.apple.spotlight/CoreSpotlight | Métadonnées | Index utilisateur Spotlight, historique de recherche | mdls, mdfind | Moyenne | Contient des métadonnées sur les fichiers et recherches utilisateur |
| macOS | ~/Library/Application Support/MobileSync/Backup | Sauvegarde | Sauvegardes d'appareils iOS | iBackup Viewer, iPhone Backup Extractor | Moyenne | Contient sauvegardes complètes ou partielles d'iPhone/iPad |
| macOS | ~/Library/Logs | Journaux | Logs d'applications, crash reports | Console.app, grep, log | Moyenne | Logs spécifiques aux applications et diagnostics |
| macOS | /private/etc/hosts | Configuration | Redirections DNS, blocage de domaines | cat, grep | Moyenne | Vérifier les entrées inhabituelles ou les redirections suspectes |
| macOS | /private/var/db/receipts | Installation | Logiciels installés, packages | pkgutil, plutil | Moyenne | Contient des plist avec informations sur les installations |
| macOS | /private/var/folders | Temporaire | Fichiers temporaires, caches d'applications | find, grep | Basse | Structure complexe avec noms de dossiers hachés |

## Linux

| OS | Chemin complet | Type d'artefact | Intérêt forensique | Outils/requêtes conseillés | Priorité | Notes spécifiques |
|---|---|---|---|---|---|---|
| Linux | /var/log/auth.log | Journaux | Authentifications, sudo, SSH | grep, awk, Automator | Haute | Sur certaines distributions: /var/log/secure |
| Linux | /var/log/syslog | Journaux | Messages système, démarrage, services | grep, journalctl, Automator | Haute | Sur certaines distributions: /var/log/messages |
| Linux | /etc/passwd | Configuration | Comptes utilisateurs, shells | cat, grep, awk | Haute | Vérifier les utilisateurs avec UID 0 ou shells inhabituels |
| Linux | /etc/shadow | Configuration | Hachages de mots de passe, dates d'expiration | cat, grep (avec sudo) | Haute | Nécessite privilèges root, vérifier les comptes sans mot de passe |
| Linux | ~/.bash_history | Historique utilisateur | Historique des commandes shell | cat, grep | Haute | Vérifier aussi .zsh_history, .ash_history selon le shell |
| Linux | /var/log/journal | Journaux | Logs systemd, journaux binaires | journalctl, Automator | Haute | Logs persistants de systemd, plus détaillés que syslog |
| Linux | /etc/systemd/system | Configuration | Services systemd, persistance malveillante | systemctl, cat | Haute | Vérifier les services inhabituels ou récemment modifiés |
| Linux | /var/spool/cron | Configuration | Tâches planifiées, persistance malveillante | crontab -l, cat | Haute | Vérifier aussi /etc/crontab et /etc/cron.*/ |
| Linux | ~/.ssh | Configuration | Clés SSH, known_hosts, config | cat, ls -la | Haute | Vérifier authorized_keys pour clés non autorisées |
| Linux | /etc/sudoers | Configuration | Permissions sudo, élévation de privilèges | cat, visudo | Haute | Vérifier aussi /etc/sudoers.d/ pour configurations supplémentaires |
| Linux | /proc | Système | Processus en cours, mappages mémoire | ps, lsof, cat /proc/*/maps | Haute | Système de fichiers virtuel, capture à chaud uniquement |
| Linux | /var/log/audit | Journaux | Logs d'audit système (auditd) | ausearch, aureport | Haute | Nécessite auditd configuré et activé |
| Linux | /etc/ld.so.preload | Configuration | Préchargement de bibliothèques, rootkits | cat, ls -la | Haute | Fichier souvent utilisé pour les rootkits |
| Linux | /var/log/wtmp | Journaux | Connexions utilisateurs, historique | last, utmpdump | Moyenne | Format binaire, utiliser 'last' pour lecture |
| Linux | /var/log/btmp | Journaux | Tentatives de connexion échouées | lastb, utmpdump | Moyenne | Format binaire, utiliser 'lastb' pour lecture |
| Linux | /etc/hosts | Configuration | Redirections DNS, blocage de domaines | cat, grep | Moyenne | Vérifier les entrées inhabituelles ou les redirections suspectes |
| Linux | /var/log/apache2 | Journaux | Logs serveur web, requêtes HTTP | grep, awk, Automator | Moyenne | Vérifier access.log et error.log pour activités suspectes |
| Linux | /var/log/nginx | Journaux | Logs serveur web, requêtes HTTP | grep, awk, Automator | Moyenne | Vérifier access.log et error.log pour activités suspectes |
| Linux | /var/log/kern.log | Journaux | Messages noyau, chargement modules | grep, dmesg | Moyenne | Vérifier chargement de modules noyau suspects |
| Linux | /tmp | Temporaire | Fichiers temporaires, scripts malveillants | ls -la, find | Moyenne | Vérifier les fichiers exécutables ou avec sticky bit |

## Divers/Autres supports

| OS | Chemin complet | Type d'artefact | Intérêt forensique | Outils/requêtes conseillés | Priorité | Notes spécifiques |
|---|---|---|---|---|---|---|
| Divers/Autres supports | Smartphones - /data/data/ (Android) | Applications | Données applications, bases SQLite, préférences | ADB, UFED, Cellebrite | Haute | Nécessite root ou extraction physique |
| Divers/Autres supports | Smartphones - /private/var/mobile/Containers/ (iOS) | Applications | Données applications, bases SQLite, préférences | iBackup Analyzer, Cellebrite | Haute | Nécessite jailbreak ou extraction physique |
| Divers/Autres supports | Machines virtuelles - fichiers .vmdk, .vhdx | Disque virtuel | Système complet, snapshots, mémoire | FTK Imager, Autopsy, VMware Disk Mount | Haute | Traiter comme un disque physique, monter en lecture seule |
| Divers/Autres supports | Clés USB - $MFT, $LogFile | Métadonnées système de fichiers | Historique de fichiers, timestamps, suppression | FTK Imager, Autopsy, TestDisk | Moyenne | Extraction forensique complète recommandée |
| Divers/Autres supports | OneDrive - %LOCALAPPDATA%\\Microsoft\\OneDrive | Synchronisation cloud | Métadonnées, historique de synchronisation | OneDrive-Explorer, FTK Imager | Moyenne | Vérifier aussi les fichiers .odl et .odlsent |
| Divers/Autres supports | iCloud - ~/Library/Mobile Documents | Synchronisation cloud | Fichiers synchronisés, métadonnées | iCloud-Analyzer, grep | Moyenne | Sur macOS, contient les fichiers synchronisés avec iCloud |
| Divers/Autres supports | Dropbox - ~/.dropbox | Synchronisation cloud | Configuration, métadonnées, historique | Dropbox-Analyzer, sqlite3 | Moyenne | Base de données SQLite avec historique de synchronisation |
