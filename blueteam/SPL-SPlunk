# SPLUNK SPL COMMANDS - BLUE TEAM & FIDR (V2 AMÃ‰LIORÃ‰E)

## Sommaire

1. [Commandes de base](#commandes-de-base)
2. [Recherches temporelles](#recherches-temporelles)
3. [Filtres et conditions](#filtres-et-conditions)
4. [Statistiques et agrÃ©gations](#statistiques-et-agrÃ©gations)
5. [Visualisation](#visualisation)
6. [RequÃªtes d'investigation](#requÃªtes-dinvestigation)
7. [Recherches sur les logs Windows](#recherches-sur-les-logs-windows)
8. [Cas d'usage FIDR](#cas-dusage-fidr)
9. [DÃ©tection MITRE ATT\&CK](#dÃ©tection-mitre-attck)
10. [Dashboards recommandÃ©s](#dashboards-recommandÃ©s)
11. [Templates de Dashboards Splunk](#templates-de-dashboards-splunk)

...

## Templates de Dashboards Splunk

### ðŸŽ¯ Dashboard : Surveillances Authentification (Windows Logon)

* **Panel 1** : `Tentatives Ã©chouÃ©es`

```spl
index=windows EventCode=4625 | timechart span=1h count by user
```

* **Panel 2** : `Tentatives rÃ©ussies`

```spl
index=windows EventCode=4624 | timechart span=1h count by user
```

* **Panel 3** : `Type de Logon suspects`

```spl
index=windows EventCode=4624 LogonType!=2 AND LogonType!=10 | stats count by LogonType
```

### ðŸ§  Dashboard : ActivitÃ© PowerShell

* **Panel 1** : `Commandes PowerShell encodÃ©es`

```spl
index=sysmon EventCode=1 | where like(CommandLine, "%EncodedCommand%") | timechart span=1h count
```

* **Panel 2** : `Scripts Invoke suspects`

```spl
index=sysmon EventCode=1 | search CommandLine="*Invoke*" | stats count by CommandLine
```

### ðŸŒ Dashboard : ActivitÃ© rÃ©seau externe

* **Panel 1** : `Connexions sortantes par destination`

```spl
index=firewall OR index=sysmon EventCode=3 | stats count by dest_ip
```

* **Panel 2** : `Taux de DNS long ou anormal`

```spl
index=dns_logs | eval qlen=len(query) | where qlen > 50 | timechart span=1h count
```

### ðŸ›¡ï¸ Dashboard : SÃ©curitÃ© des Comptes

* **Panel 1** : `CrÃ©ation de comptes`

```spl
index=windows EventCode=4720 | timechart span=1h count by user
```

* **Panel 2** : `Ajout aux groupes admin`

```spl
index=windows EventCode=4728 OR EventCode=4732 | stats count by user, GroupName
```

### ðŸ“¦ Dashboard : Exfiltration/DLP

* **Panel 1** : `TÃ©lÃ©chargements de gros fichiers compressÃ©s`

```spl
index=proxy_logs uri="*.zip" OR uri="*.rar" OR uri="*.7z" | stats count by src_ip, uri
```

* **Panel 2** : `Transferts DNS suspects`

```spl
index=dns_logs | where like(query, "%_%") OR len(query)>50 | timechart span=30m count by query
```

---
