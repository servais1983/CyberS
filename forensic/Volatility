# ğŸ§  Volatility - Analyse Forensique de la MÃ©moire

## ğŸ“Œ Qu'est-ce que Volatility ?

**Volatility** est un framework open-source destinÃ© Ã  lâ€™analyse de la mÃ©moire volatile (RAM) dâ€™un systÃ¨me informatique. Il permet aux enquÃªteurs forensiques de :
- Extraire des informations sensibles (processus, connexions rÃ©seau, DLL, etc.)
- Analyser les traces dâ€™un logiciel malveillant
- DÃ©terminer lâ€™Ã©tat dâ€™un systÃ¨me Ã  un moment donnÃ©

Volatility est indÃ©pendant du systÃ¨me dâ€™exploitation de lâ€™hÃ´te et peut analyser des images mÃ©moire de **Windows, Linux, macOS**, etc.

Il existe deux principales versions :
- **Volatility 2.x** (Python 2, plus utilisÃ©e mais moins maintenue)
- **Volatility 3** (Python 3, rÃ©Ã©criture complÃ¨te avec une meilleure structure modulaire)

---

## âš™ï¸ Installation

### Volatility 2.x (Linux)

git clone https://github.com/volatilityfoundation/volatility.git
cd volatility
python2 vol.py -h
Volatility 3 (Linux ou Windows)

git clone https://github.com/volatilityfoundation/volatility3.git
cd volatility3
python3 vol.py -h
ğŸ§  Formats de fichiers supportÃ©s
.raw (dump brut)

.mem, .lime (Linux)

.vmem (VMware)

.dmp / .hiberfil.sys (Windows)

.elf, .core, .crash (Linux)

ğŸ” Commandes gÃ©nÃ©rales (Volatility 3)

python3 vol.py -f <fichier_memoire> windows.info
python3 vol.py -f <fichier_memoire> -p <profile> <plugin>
ğŸªŸ Modules Volatility pour Windows
ğŸ”§ Informations systÃ¨me
windows.info â€” Infos sur lâ€™OS, version, build, etc.

windows.pslist â€” Liste des processus actifs

windows.pstree â€” Arborescence des processus

windows.psscan â€” Recherche de processus (inclus processus cachÃ©s)

windows.modules â€” Liste des modules chargÃ©s

ğŸ“‚ Fichiers et registres
windows.filescan â€” Recherche de fichiers en mÃ©moire

windows.registry.printkey â€” Affiche une clÃ© de registre

windows.registry.hivescan â€” Recherche de hives en mÃ©moire

windows.registry.hivelist â€” Liste des hives

ğŸŒ RÃ©seau
windows.netscan â€” Connexions rÃ©seau et sockets (TCP/UDP)

ğŸ” Mots de passe et utilisateurs
windows.hashdump â€” Dump des mots de passe NTLM

windows.lsadump â€” Extraction des secrets du LSA

ğŸ§Ÿ DÃ©tection de malwares
windows.malfind â€” Recherche dâ€™injections de code

windows.ssdt â€” Analyse de la SSDT (rootkits)

windows.callbacks â€” VÃ©rifie les callbacks suspects

ğŸ§ Modules Volatility pour Linux
ğŸ”§ Informations systÃ¨me
linux_banner â€” Version du kernel

linux_pslist â€” Liste des processus

linux_pstree â€” Arborescence des processus

linux_psaux â€” Processus avec arguments

linux_proc_maps â€” Cartographie mÃ©moire dâ€™un processus

linux_cpuinfo â€” Infos CPU

ğŸ“‚ Fichiers et modules
linux_lsmod â€” Liste des modules noyau

linux_check_afinfo â€” VÃ©rifie les fonctions socket

linux_find_file â€” Recherche de fichiers en mÃ©moire

ğŸ”’ SÃ©curitÃ© et utilisateurs
linux_bash â€” Affiche les historiques Bash

linux_passwd â€” Montre les utilisateurs et leurs mots de passe

linux_shadow_hashes â€” Dump des hashes depuis /etc/shadow

ğŸŒ RÃ©seau
linux_netstat â€” Ports et connexions

linux_ifconfig â€” Interfaces rÃ©seau

ğŸ“˜ Exemples de commandes

# Windows - Liste des processus
python3 vol.py -f win10.raw windows.pslist

# Windows - Recherche de rootkits via malfind
python3 vol.py -f win10.raw windows.malfind

# Linux - Affiche lâ€™historique bash
python3 vol.py -f linux.lime linux_bash

# Linux - Liste les processus
python3 vol.py -f linux.lime linux_pslist
ğŸ›  Astuces
Toujours utiliser windows.psscan en plus de pslist pour dÃ©tecter les processus cachÃ©s.

Utiliser malfind pour dÃ©tecter les injections en mÃ©moire.

Combinez hivelist + printkey pour explorer les clÃ©s de registre.

ğŸ“š Liens utiles
Site officiel : https://www.volatilityfoundation.org/

Repo GitHub Volatility 3 : https://github.com/volatilityfoundation/volatility3

Profils Linux avec LiME : https://github.com/504ensicsLabs/LiME


## ğŸ§¾ Analyse du Registre Windows avec Volatility

Le **registre Windows** contient une Ã©norme quantitÃ© d'informations sur le systÃ¨me, les logiciels, les utilisateurs, les configurations, etc. Volatility permet d'extraire et d'examiner ces donnÃ©es **directement depuis l'image mÃ©moire**, sans avoir besoin dâ€™un accÃ¨s au disque.

---

### ğŸ“œ Modules liÃ©s au registre

#### `windows.registry.hivescan`
- **But** : Scanne la mÃ©moire Ã  la recherche de structures de registre (`CMHIVE`).
- **UtilitÃ©** : Identifier les emplacements des hives (bases de registre) dans la mÃ©moire, y compris celles non rÃ©pertoriÃ©es.

#### `windows.registry.hivelist`
- **But** : Affiche une liste des hives (bases du registre) trouvÃ©es dans la mÃ©moire.
- **Affiche** :
  - L'adresse mÃ©moire
  - Le chemin du fichier hive (par ex. `\SystemRoot\System32\Config\SAM`)
  - Le nom associÃ© (SAM, SYSTEM, SOFTWARE, NTUSER.DATâ€¦)

#### `windows.registry.printkey`
- **But** : Affiche le contenu d'une **clÃ© spÃ©cifique** dans le registre.
- **Usage** :

  python3 vol.py -f win10.raw windows.registry.printkey --key "Software\\Microsoft\\Windows\\CurrentVersion\\Run"
UtilitÃ© :

Voir les programmes lancÃ©s au dÃ©marrage (Run, RunOnce)

Explorer des valeurs prÃ©cises dans les branches NTUSER, SYSTEM, etc.

windows.registry.userassist
But : Affiche les programmes utilisÃ©s rÃ©cemment via les clÃ©s UserAssist

UtilitÃ© : RÃ©vÃ©ler les habitudes dâ€™utilisation dâ€™un utilisateur

ğŸ§ª Exemple de Workflow : Analyse du registre
Lister les hives disponibles


python3 vol.py -f win10.raw windows.registry.hivelist
RÃ©sultat attendu :

pgsql

Virtual            Physical           Name
0xfffff8a000022000 0x122000           \SystemRoot\System32\Config\SYSTEM
0xfffff8a000070000 0x170000           \??\C:\Users\User\ntuser.dat
Explorer une clÃ© du registre SYSTEM


python3 vol.py -f win10.raw windows.registry.printkey --key "Select" --hive-offset 0xfffff8a000022000
Explorer les programmes lancÃ©s au dÃ©marrage dâ€™un utilisateur


python3 vol.py -f win10.raw windows.registry.printkey --key "Software\\Microsoft\\Windows\\CurrentVersion\\Run" --hive-offset 0xfffff8a000070000
ğŸ“‚ Types de hives utiles
Hive	Contenu principal
SYSTEM	Infos sur les pilotes, services, contrÃ´le du dÃ©marrage
SOFTWARE	Infos sur les programmes installÃ©s
SAM	Comptes utilisateurs locaux, SID, groupes
SECURITY	Infos sur les politiques de sÃ©curitÃ©
NTUSER.DAT	ParamÃ¨tres spÃ©cifiques Ã  l'utilisateur

ğŸ” Astuce pratique
Combinez hivelist avec printkey pour naviguer et extraire n'importe quelle valeur de registre.

Les valeurs comme Run, LastVisitedMRU, TypedURLs ou MountPoints2 rÃ©vÃ¨lent souvent des indices dâ€™activitÃ©s malveillantes ou dâ€™utilisation suspecte.

ğŸ“˜ Exemple avancÃ© : Extraction du SID utilisateur
Identifier le hive SAM :


python3 vol.py -f win10.raw windows.registry.hivelist
Extraire les utilisateurs :


python3 vol.py -f win10.raw windows.registry.printkey --key "SAM\\Domains\\Account\\Users\\Names" --hive-offset 0xfffff8a000034000
Cela donne les noms d'utilisateurs et permet d'aller plus loin pour rÃ©cupÃ©rer les SID ou analyser les droits associÃ©s.

ğŸ” SÃ©curitÃ© et malveillance
Les artefacts du registre sont prÃ©cieux pour :

DÃ©tecter les persistances (Run, Services, etc.)

RÃ©vÃ©ler les utilisateurs actifs

Identifier les logiciels malveillants configurÃ©s pour se relancer

go



## ğŸ” Extraction des mots de passe avec `hashdump` (Volatility)

### â“ Quâ€™est-ce que `hashdump` ?

La commande `hashdump` permet dâ€™extraire les **hashs NTLM** des mots de passe des comptes utilisateurs Windows Ã  partir dâ€™une image mÃ©moire.

Ces hashs peuvent ensuite Ãªtre :
- ComparÃ©s Ã  des dictionnaires (attaque par dictionnaire)
- Bruts (attaque par force brute)
- CrackÃ©s via des outils comme `john`, `hashcat`, etc.

---

### ğŸ“¦ Fichiers nÃ©cessaires en mÃ©moire

Pour que `hashdump` fonctionne, Volatility doit **trouver et charger deux hives** dans la mÃ©moire :
- `SAM` â€” Contient les comptes utilisateurs
- `SYSTEM` â€” Contient la clÃ© dâ€™obfuscation nÃ©cessaire pour dÃ©chiffrer les hashs

---

### ğŸ”§ Syntaxe gÃ©nÃ©rale (Volatility 3)

python3 vol.py -f <image_memoire> windows.hashdump
Volatility 3 dÃ©tecte automatiquement les profils et les hives requis. Pas besoin de spÃ©cifier le profil contrairement Ã  Volatility 2.

âš ï¸ Avec Volatility 2
Syntaxe :

python2 vol.py -f <image_memoire> --profile=<profil_windows> hashdump
Exemples de profils :
Win7SP1x64

Win10x64_19041

Exemple complet :

python2 vol.py -f memdump.raw --profile=Win7SP1x64 hashdump
ğŸ“‹ Exemple de sortie hashdump
text

Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
User1:1001:aad3b435b51404eeaad3b435b51404ee:f1b7f8d2566c8e3ef2ddc99a9f7a17b3:::
Structure :
ruby

nom_utilisateur:RID:LM_hash:NTLM_hash:::
LM_hash : Ancienne mÃ©thode de hash (souvent dÃ©sactivÃ©e aujourd'hui)

NTLM_hash : Hash rÃ©el du mot de passe Windows

ğŸ›  Que faire avec ces hashs ?
Utiliser hashcat

hashcat -m 1000 hash.txt rockyou.txt
Utiliser john

john --format=nt hash.txt --wordlist=rockyou.txt
ğŸ” Ã‰tapes de vÃ©rification (optionnel)
Si hashdump Ã©choue, il est conseillÃ© de :

Lister les hives avec hivelist :


python3 vol.py -f memdump.raw windows.registry.hivelist
VÃ©rifier que SAM et SYSTEM sont prÃ©sents.

ğŸ§  Autres modules liÃ©s aux mots de passe
windows.lsadump â€” Extrait les secrets du LSA (tokens, clÃ©s DPAPI, etc.)

windows.cachedump â€” Hashed mots de passe en cache (utiles en cas de dÃ©connexion)

âœ… RÃ©sumÃ© des commandes
Volatility 3 (recommandÃ©)

python3 vol.py -f memdump.raw windows.hashdump
Volatility 2 (avec profil)

python2 vol.py -f memdump.raw --profile=Win7SP1x64 hashdump
ğŸ” Recommandation
Toujours coupler hashdump avec lsadump et hivelist pour faire une analyse complÃ¨te de la sÃ©curitÃ© des identifiants.

yaml


---
# ğŸ§  Analyse mÃ©moire avec Volatility sous Linux

Ce guide prÃ©sente pas Ã  pas comment utiliser **Volatility 2** pour analyser un dump mÃ©moire (`memdump.mem`) Ã  lâ€™aide de commandes de base : vÃ©rification, identification de profil, processus actifs, et connexions rÃ©seau.

---

## âœ… Ã‰tape 1 â€“ Voir les commandes disponibles

Commencez par afficher lâ€™aide pour explorer les plugins disponibles :


volatility -h
Cela liste tous les plugins disponibles (pslist, netscan, dlllist, etc.) ainsi que les options gÃ©nÃ©rales.

ğŸ” Ã‰tape 2 â€“ Identifier le profil mÃ©moire
Avant toute analyse, il faut identifier le profil (profil kernel) Ã  utiliser pour votre image mÃ©moire :


volatility -f memdump.mem imageinfo
ğŸ” Cette commande affiche :

Les profils suggÃ©rÃ©s (ex: Win7SP1x64, Win10x64_18362, etc.)

Lâ€™horodatage du systÃ¨me au moment de la capture

Le type de systÃ¨me dÃ©tectÃ© (Windows/Linux)

â¡ï¸ Choisis le profil le plus probable dans la liste retournÃ©e.

ğŸ§  Ã‰tape 3 â€“ Lister les processus en cours
Utilise le profil identifiÃ© pour extraire la liste des processus actifs avec leurs mÃ©tadonnÃ©es :


volatility -f memdump.mem --profile=NomDuProfil pslist
Exemple :


volatility -f memdump.mem --profile=Win7SP1x64 pslist
ğŸ”¹ Cette commande fournit :

PID / PPID

Nom du processus

Date/Heure de lancement

Nombre de threads/handles

ğŸ¯ Rechercher les anomalies :

Noms de processus suspects ou dÃ©guisÃ©s (svchost.exe, explorer.exe hors contexte)

Processus sans parent (PPID incohÃ©rent)

Horodatages anormaux ou postÃ©rieurs Ã  l'heure systÃ¨me

ğŸŒ Ã‰tape 4 â€“ Analyser les connexions rÃ©seau
Utilisez le plugin netscan pour extraire les connexions rÃ©seau actives (TCP/UDP) au moment du dump :


volatility -f memdump.mem --profile=NomDuProfil netscan
Cette commande retourne :

PID associÃ© Ã  chaque connexion

Adresse locale / distante

Port

Ã‰tat de la connexion (LISTENING, ESTABLISHED, etc.)

ğŸ” Ã€ surveiller :

Connexions vers des IP externes non connues

Processus inconnus Ã©tablissant des connexions rÃ©seau

Ports non standard

ğŸ§© Astuces supplÃ©mentaires
Ajouter > resultat.txt Ã  vos commandes pour exporter les rÃ©sultats dans un fichier texte.

Croiser pslist avec netscan pour identifier quels processus communiquent avec lâ€™extÃ©rieur.

Utiliser ensuite dlllist, cmdline, ou malfind pour explorer un processus suspect.

ğŸ“˜ RÃ©fÃ©rences
Volatility GitHub (v2)

Cheat Sheet officielle Volatility

