# 1. Introduction à Cortex XDR - Guide Visuel

## 1.1 Présentation visuelle de l'interface

Cortex XDR offre une interface moderne et intuitive qui centralise toutes les fonctionnalités de détection et de réponse aux menaces. Voici une présentation visuelle de l'interface principale avec ses différentes zones et fonctionnalités.

![Interface principale de Cortex XDR](https://private-us-east-1.manuscdn.com/sessionFile/IneiHlKkFeKoZw52ZHVaBe/sandbox/jXYrIFBQ1SXypO6Hab8BTM-images_1749656316887_na1fn_L2hvbWUvdWJ1bnR1L2NvcnRleF94ZHJfbWFudWVsL2ltYWdlcy9jb25zb2xlX3hkcl9kYXNoYm9hcmQ.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9wcml2YXRlLXVzLWVhc3QtMS5tYW51c2Nkbi5jb20vc2Vzc2lvbkZpbGUvSW5laUhsS2tGZUtvWnc1MlpIVmFCZS9zYW5kYm94L2pYWXJJRkJRMVNYeXBPNkhhYjhCVE0taW1hZ2VzXzE3NDk2NTYzMTY4ODdfbmExZm5fTDJodmJXVXZkV0oxYm5SMUwyTnZjblJsZUY5NFpISmZiV0Z1ZFdWc0wybHRZV2RsY3k5amIyNXpiMnhsWDNoa2NsOWtZWE5vWW05aGNtUS5wbmciLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjcyMjU2MDB9fX1dfQ__&Key-Pair-Id=K2HSFNDJXOU9YS&Signature=DZSYgzBnaQAwsfizJiZ3-DFYxqkcmf3IdgabAAP78Q7wA1gnAEKF9lbdoPpkbJvGsW~o5aNUzo9etnYe3NY4YnxUpVCNx9F9iUj8UosndvDQqFuOmScAbS-0qKxWSMhLIC8pxD~zo3gA1j8I6toXnCNMjVUAHpSMIGf6L6SBzp8FKVyHCrthuyeZwXOy3SaA9RNI4bam6XilNrN0wzKZfAGGnQEHxGiSCCmDRHc5bOENw8SujCf077v1s3qpgK7nhvi3ApOaWr1RsY5h0tnBNeB~UInLP57UBVNbtX3L8i1raEmO7CoY3HQ0uuylI98NRYvDVXRPuUVSm8XNl5M1bg__)

*Figure 1.1 : Vue d'ensemble du tableau de bord principal de Cortex XDR*

### Éléments clés de l'interface

1. **Barre de navigation supérieure** : Permet d'accéder rapidement aux principales sections de Cortex XDR
   - Logo Cortex XDR (coin supérieur gauche) : Retour à l'accueil
   - Menu principal : Dashboards, Incidents, Action Center, Assets, etc.
   - Recherche globale : Recherche rapide dans toute la plateforme
   - Notifications : Alertes système et mises à jour importantes
   - Profil utilisateur : Accès aux paramètres du compte

2. **Panneau latéral gauche** : Navigation contextuelle et filtres
   - Filtres de temps : Sélection de la période d'analyse
   - Filtres d'environnement : Sélection des groupes d'endpoints
   - Favoris : Accès rapide aux vues enregistrées

3. **Zone centrale** : Affichage principal des données et widgets
   - Widgets configurables : Graphiques, tableaux et indicateurs
   - Données en temps réel : Mises à jour automatiques des informations
   - Visualisations interactives : Possibilité de cliquer pour plus de détails

4. **Barre d'état inférieure** : Informations système et statut
   - État de la connexion : Indicateur de connectivité
   - Version du système : Numéro de version actuel
   - Dernière mise à jour : Horodatage de la dernière actualisation des données

## 1.2 Guide de connexion et navigation de base

### Connexion à la console Cortex XDR

Suivez ces étapes pour vous connecter à la console Cortex XDR :

1. **Accédez à l'URL de votre instance Cortex XDR**
   
   ![Page de connexion Cortex XDR](/home/ubuntu/cortex_xdr_manuel/images/login_page.png)
   
   *Figure 1.2 : Page de connexion à Cortex XDR*

2. **Saisissez vos identifiants**
   - Nom d'utilisateur : Votre identifiant fourni par l'administrateur
   - Mot de passe : Votre mot de passe personnel
   - (Optionnel) Cochez "Se souvenir de moi" pour faciliter les connexions futures

3. **Authentification multifacteur (si configurée)**
   
   ![Authentification multifacteur](/home/ubuntu/cortex_xdr_manuel/images/mfa_screen.png)
   
   *Figure 1.3 : Écran d'authentification multifacteur*
   
   - Saisissez le code reçu par SMS, application d'authentification ou email
   - Cliquez sur "Vérifier" pour compléter la connexion

4. **Premier accès à la console**
   
   Après connexion, vous accédez directement au tableau de bord par défaut.

### Navigation de base dans l'interface

#### Utilisation du menu principal

Le menu principal en haut de l'écran permet d'accéder aux sections principales :

![Menu principal](/home/ubuntu/cortex_xdr_manuel/images/main_menu.png)

*Figure 1.4 : Menu principal de navigation*

- **Dashboard** : Tableaux de bord et visualisations
- **Incidents** : Liste et détails des incidents de sécurité
- **Alerts** : Alertes individuelles avant corrélation
- **Action Center** : Actions et tâches en attente
- **Assets** : Inventaire des endpoints et ressources
- **Query** : Interface de requêtes XQL
- **Reports** : Rapports et analyses programmés

#### Changement de période d'analyse

Pour modifier la période d'analyse des données affichées :

1. Cliquez sur le sélecteur de temps en haut à droite
   
   ![Sélecteur de temps](/home/ubuntu/cortex_xdr_manuel/images/time_selector.png)
   
   *Figure 1.5 : Sélecteur de période d'analyse*

2. Choisissez une période prédéfinie :
   - Dernière heure
   - Dernières 24 heures
   - 7 derniers jours
   - 30 derniers jours
   - Personnalisé (sélection manuelle)

3. Pour une période personnalisée, utilisez le calendrier pour définir les dates et heures de début et de fin

4. Cliquez sur "Appliquer" pour mettre à jour toutes les visualisations

#### Filtrage par groupe d'endpoints

Pour filtrer les données par groupe d'endpoints spécifique :

1. Accédez au panneau de filtres (généralement à gauche)
   
   ![Filtres d'endpoints](/home/ubuntu/cortex_xdr_manuel/images/endpoint_filters.png)
   
   *Figure 1.6 : Filtres de groupes d'endpoints*

2. Sélectionnez un ou plusieurs groupes dans la liste
   - Groupes géographiques (par région/pays)
   - Groupes organisationnels (par département)
   - Groupes fonctionnels (serveurs, postes de travail, etc.)

3. Les visualisations se mettent à jour automatiquement pour refléter votre sélection

#### Recherche globale

La recherche globale permet de trouver rapidement des informations dans toute la plateforme :

1. Cliquez sur l'icône de recherche dans la barre supérieure
   
   ![Recherche globale](/home/ubuntu/cortex_xdr_manuel/images/global_search.png)
   
   *Figure 1.7 : Barre de recherche globale*

2. Saisissez votre terme de recherche (nom d'hôte, adresse IP, nom d'utilisateur, etc.)

3. Sélectionnez le type de résultat dans le menu déroulant (optionnel) :
   - Tous
   - Incidents
   - Alertes
   - Endpoints
   - Utilisateurs
   - Fichiers

4. Appuyez sur Entrée pour lancer la recherche

5. Les résultats s'affichent par catégorie, cliquez sur un élément pour y accéder directement

## 1.3 Personnalisation de l'interface utilisateur

Cortex XDR permet de personnaliser l'interface selon vos préférences et besoins spécifiques.

### Modification du tableau de bord par défaut

Pour changer le tableau de bord qui s'affiche à la connexion :

1. Accédez à **Dashboards & Reports > Dashboard Manager**
   
   ![Dashboard Manager](/home/ubuntu/cortex_xdr_manuel/images/dashboard_manager.png)
   
   *Figure 1.8 : Gestionnaire de tableaux de bord*

2. Localisez le tableau de bord souhaité dans la liste

3. Cliquez sur l'icône ⋮ (menu contextuel) à côté du tableau de bord

4. Sélectionnez "Définir comme tableau de bord par défaut"

5. Une confirmation apparaît, le tableau de bord sélectionné s'affichera désormais à chaque connexion

### Personnalisation des préférences utilisateur

Pour ajuster vos préférences personnelles :

1. Cliquez sur votre avatar/nom d'utilisateur en haut à droite

2. Sélectionnez "Préférences utilisateur"
   
   ![Préférences utilisateur](/home/ubuntu/cortex_xdr_manuel/images/user_preferences.png)
   
   *Figure 1.9 : Menu des préférences utilisateur*

3. Dans la fenêtre des préférences, vous pouvez configurer :
   - Langue de l'interface
   - Format de date et d'heure
   - Fuseau horaire
   - Thème visuel (clair/sombre)
   - Notifications par email
   - Préférences d'affichage des tableaux

4. Cliquez sur "Enregistrer" pour appliquer vos modifications

### Création de favoris pour un accès rapide

Pour marquer des vues fréquemment utilisées comme favoris :

1. Naviguez vers la page que vous souhaitez ajouter aux favoris (tableau de bord, vue d'incidents, etc.)

2. Cliquez sur l'icône d'étoile ★ dans la barre supérieure
   
   ![Ajout aux favoris](/home/ubuntu/cortex_xdr_manuel/images/add_favorite.png)
   
   *Figure 1.10 : Ajout d'une page aux favoris*

3. Donnez un nom à ce favori dans la fenêtre qui apparaît

4. Cliquez sur "Ajouter"

5. Pour accéder à vos favoris, cliquez sur l'icône ★ dans le menu principal

## 1.4 Comprendre les indicateurs d'état et icônes

Cortex XDR utilise un système cohérent d'icônes et d'indicateurs colorés pour communiquer rapidement l'état et la sévérité des éléments.

### Indicateurs de sévérité

![Indicateurs de sévérité](/home/ubuntu/cortex_xdr_manuel/images/severity_indicators.png)

*Figure 1.11 : Indicateurs de sévérité dans Cortex XDR*

- **Rouge** : Critique - Menace active nécessitant une attention immédiate
- **Orange** : Élevée - Menace sérieuse nécessitant une attention rapide
- **Jaune** : Moyenne - Activité suspecte nécessitant une investigation
- **Bleu** : Faible - Anomalie mineure ou information contextuelle

### Icônes d'état des endpoints

![Icônes d'état des endpoints](/home/ubuntu/cortex_xdr_manuel/images/endpoint_status_icons.png)

*Figure 1.12 : Icônes d'état des endpoints*

- **Cercle vert** : Endpoint connecté et protégé
- **Cercle orange** : Endpoint connecté avec avertissements
- **Cercle rouge** : Endpoint avec alertes critiques
- **Cercle gris** : Endpoint déconnecté ou inactif

### Icônes d'action

![Icônes d'action](/home/ubuntu/cortex_xdr_manuel/images/action_icons.png)

*Figure 1.13 : Icônes d'action courantes*

- **Loupe** : Examiner/Investiguer
- **Bouclier** : Protéger/Bloquer
- **Flèche circulaire** : Actualiser/Mettre à jour
- **Engrenage** : Configurer/Paramétrer
- **Dossier+** : Créer nouveau
- **Disquette** : Enregistrer
- **Corbeille** : Supprimer
- **Cloche** : Notifications/Alertes

## 1.5 Aide et ressources intégrées

Cortex XDR offre plusieurs ressources d'aide directement accessibles depuis l'interface.

### Centre d'aide contextuel

Pour accéder à l'aide contextuelle :

1. Cliquez sur l'icône ? en haut à droite de l'écran
   
   ![Centre d'aide](/home/ubuntu/cortex_xdr_manuel/images/help_center.png)
   
   *Figure 1.14 : Accès au centre d'aide*

2. Le panneau d'aide s'ouvre avec des informations spécifiques à la page actuelle

3. Utilisez la barre de recherche pour trouver rapidement des sujets d'aide

4. Parcourez les catégories pour explorer la documentation complète

### Tooltips et infobulles

Des infobulles explicatives sont disponibles pour la plupart des éléments de l'interface :

1. Survolez un élément avec votre curseur pour afficher une infobulle explicative
   
   ![Exemple d'infobulle](/home/ubuntu/cortex_xdr_manuel/images/tooltip_example.png)
   
   *Figure 1.15 : Exemple d'infobulle explicative*

2. Les infobulles fournissent des explications concises sur la fonction ou les données affichées

### Tutoriels interactifs

Cortex XDR propose des tutoriels interactifs pour les nouvelles fonctionnalités :

1. Les tutoriels apparaissent automatiquement lors de la première utilisation d'une fonctionnalité
   
   ![Tutoriel interactif](/home/ubuntu/cortex_xdr_manuel/images/interactive_tutorial.png)
   
   *Figure 1.16 : Exemple de tutoriel interactif*

2. Suivez les instructions étape par étape pour vous familiariser avec la fonctionnalité

3. Vous pouvez ignorer un tutoriel en cliquant sur "Ignorer" ou "Fermer"

4. Pour revoir les tutoriels, accédez à **Aide > Tutoriels** dans le menu principal
# 2. Le Dashboard Principal - Guide Visuel

## 2.1 Vue d'ensemble du dashboard principal

Le dashboard principal de Cortex XDR est le point central de votre expérience de sécurité, offrant une vue synthétique et personnalisable de votre environnement. Cette section vous présente en détail chaque élément de cette interface essentielle.

![Dashboard principal de Cortex XDR](https://private-us-east-1.manuscdn.com/sessionFile/IneiHlKkFeKoZw52ZHVaBe/sandbox/jXYrIFBQ1SXypO6Hab8BTM-images_1749656316888_na1fn_L2hvbWUvdWJ1bnR1L2NvcnRleF94ZHJfbWFudWVsL2ltYWdlcy9jb25zb2xlX3hkcl9kYXNoYm9hcmQ.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9wcml2YXRlLXVzLWVhc3QtMS5tYW51c2Nkbi5jb20vc2Vzc2lvbkZpbGUvSW5laUhsS2tGZUtvWnc1MlpIVmFCZS9zYW5kYm94L2pYWXJJRkJRMVNYeXBPNkhhYjhCVE0taW1hZ2VzXzE3NDk2NTYzMTY4ODhfbmExZm5fTDJodmJXVXZkV0oxYm5SMUwyTnZjblJsZUY5NFpISmZiV0Z1ZFdWc0wybHRZV2RsY3k5amIyNXpiMnhsWDNoa2NsOWtZWE5vWW05aGNtUS5wbmciLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3NjcyMjU2MDB9fX1dfQ__&Key-Pair-Id=K2HSFNDJXOU9YS&Signature=YA5UFuMdvXJOKZoM6lvyMw0J4zrSlsw27b2nCmu96Hl1jUaF9S5ITBG0X8sWVFawki723NGZHV1cCKP6qUfDxiT0afhbEididJLUHSdHQPT3z60lAbKH73dZWzMlUqpv~IQPDxjDfeO-g9d9MDPhZxomuG4fjkTops3Avs7hYHFiiN9pp2l81ePXj8iqsAHzfeG~IuBz8nQzFpjxytbtW~Va3yFRAZOJLVqm9sJtHM7dC2PDjXYn~0K~iNR03IM9YHi77NNBmFuvgl3PvSqcsfE~g1c6bNdSk90-ni1ALWRpFfnxJ46kL2pwwxaAMDDO2mpEOnDPT3l8Zf77hpCbMw__)

*Figure 2.1 : Vue d'ensemble du dashboard principal avec annotations*

### Anatomie du dashboard principal

1. **En-tête du dashboard**
   - Titre du dashboard actuel
   - Sélecteur de période d'analyse
   - Boutons d'action (actualiser, exporter, partager)
   - Menu déroulant pour changer de dashboard

2. **Zone des widgets**
   - Disposition modulaire et personnalisable
   - Widgets de différentes tailles et formats
   - Données en temps réel avec actualisation automatique

3. **Barre d'état**
   - Statut de la synchronisation des données
   - Horodatage de la dernière mise à jour
   - Indicateurs de santé du système

### Types de widgets disponibles

Le dashboard principal affiche plusieurs types de widgets, chacun conçu pour présenter des informations spécifiques :

![Types de widgets](/home/ubuntu/cortex_xdr_manuel/images/widget_types.png)

*Figure 2.2 : Différents types de widgets disponibles*

1. **Widgets numériques**
   - Affichent des métriques clés sous forme de chiffres
   - Souvent accompagnés d'indicateurs de tendance (↑↓)
   - Exemple : Nombre total d'incidents, Endpoints actifs

2. **Widgets graphiques**
   - Présentent des données sous forme de graphiques
   - Types disponibles : courbes, histogrammes, camemberts, etc.
   - Exemple : Évolution des alertes dans le temps

3. **Widgets tabulaires**
   - Affichent des données sous forme de tableaux
   - Permettent le tri et le filtrage
   - Exemple : Liste des incidents récents

4. **Widgets cartographiques**
   - Visualisent des données géographiques
   - Permettent de zoomer et d'explorer
   - Exemple : Distribution géographique des attaques

5. **Widgets de statut**
   - Présentent l'état des systèmes sous forme visuelle
   - Utilisent des codes couleur pour indiquer la sévérité
   - Exemple : État de santé des endpoints

## 2.2 Comment personnaliser l'affichage du dashboard

Cortex XDR vous permet de personnaliser entièrement l'affichage de votre dashboard pour l'adapter à vos besoins spécifiques.

### Modification de la période d'analyse

Pour ajuster la période d'analyse des données affichées :

1. Localisez le sélecteur de temps en haut à droite du dashboard
   
   ![Sélecteur de période](/home/ubuntu/cortex_xdr_manuel/images/time_range_selector.png)
   
   *Figure 2.3 : Sélecteur de période d'analyse*

2. Cliquez sur la période actuellement sélectionnée pour ouvrir le menu déroulant

3. Choisissez parmi les options prédéfinies :
   - Dernière heure
   - Dernières 24 heures
   - 7 derniers jours
   - 30 derniers jours
   - 90 derniers jours

4. Pour une période personnalisée :
   - Sélectionnez "Personnalisé" dans le menu
   - Utilisez le calendrier pour définir les dates de début et de fin
   - Précisez les heures si nécessaire
   - Cliquez sur "Appliquer"

5. Tous les widgets du dashboard s'actualisent automatiquement pour refléter la nouvelle période

### Réorganisation des widgets

Pour réorganiser les widgets selon vos préférences :

1. Passez en mode édition en cliquant sur l'icône de crayon en haut à droite
   
   ![Mode édition](/home/ubuntu/cortex_xdr_manuel/images/edit_mode.png)
   
   *Figure 2.4 : Activation du mode édition*

2. Pour déplacer un widget :
   - Survolez l'en-tête du widget jusqu'à ce que le curseur se transforme en croix
   - Cliquez et maintenez pour faire glisser le widget vers son nouvel emplacement
   - Relâchez pour confirmer la position

3. Pour redimensionner un widget :
   - Survolez les bords ou les coins du widget
   - Lorsque le curseur se transforme en flèche de redimensionnement, cliquez et faites glisser
   - Relâchez pour confirmer la nouvelle taille

4. Une fois les modifications terminées, cliquez sur "Enregistrer" en haut à droite

### Ajout de nouveaux widgets

Pour enrichir votre dashboard avec de nouveaux widgets :

1. En mode édition, cliquez sur le bouton "Ajouter un widget"
   
   ![Ajout de widget](/home/ubuntu/cortex_xdr_manuel/images/add_widget.png)
   
   *Figure 2.5 : Bouton d'ajout de widget*

2. Dans la bibliothèque de widgets qui s'ouvre :
   - Parcourez les catégories disponibles
   - Utilisez la barre de recherche pour trouver un widget spécifique
   - Survolez un widget pour voir un aperçu

3. Sélectionnez le widget souhaité en cliquant dessus

4. Configurez les paramètres du widget :
   - Titre personnalisé
   - Filtres spécifiques
   - Options d'affichage
   - Actualisation automatique

5. Cliquez sur "Ajouter" pour placer le widget sur votre dashboard

6. Positionnez et redimensionnez le nouveau widget selon vos besoins

7. Cliquez sur "Enregistrer" pour confirmer les modifications

### Suppression ou masquage de widgets

Pour supprimer ou masquer temporairement des widgets :

1. En mode édition, survolez le widget à modifier

2. Pour supprimer un widget :
   - Cliquez sur l'icône ⋮ (menu contextuel) dans le coin supérieur droit du widget
   - Sélectionnez "Supprimer"
   - Confirmez la suppression dans la boîte de dialogue

3. Pour masquer temporairement un widget :
   - Cliquez sur l'icône d'œil dans le coin supérieur droit du widget
   - Le widget devient grisé et n'affiche plus de données
   - Cliquez à nouveau sur l'icône d'œil pour réafficher le widget

4. N'oubliez pas de cliquer sur "Enregistrer" pour confirmer vos modifications

## 2.3 Navigation entre les différents dashboards

Cortex XDR propose plusieurs dashboards prédéfinis et vous permet de créer vos propres dashboards personnalisés. Voici comment naviguer efficacement entre ces différentes vues.

### Accès aux dashboards prédéfinis

Pour accéder aux dashboards prédéfinis :

1. Cliquez sur "Dashboards & Reports" dans le menu principal
   
   ![Menu Dashboards](/home/ubuntu/cortex_xdr_manuel/images/dashboards_menu.png)
   
   *Figure 2.6 : Accès au menu des dashboards*

2. Sélectionnez "Dashboard" dans le sous-menu

3. Dans le menu déroulant qui apparaît en haut de la page, vous verrez la liste des dashboards disponibles :
   - Agent Management (Gestion des agents)
   - Cloud Inventory (Inventaire cloud)
   - Data Ingestion (Ingestion de données)
   - Incidents Overview (Vue d'ensemble des incidents)
   - Threat Hunting (Chasse aux menaces)
   - Et d'autres dashboards spécialisés

4. Cliquez sur le nom du dashboard souhaité pour y accéder

### Utilisation du Dashboard Manager

Le Dashboard Manager vous permet de gérer tous vos dashboards :

1. Accédez à "Dashboards & Reports > Dashboard Manager"
   
   ![Dashboard Manager](/home/ubuntu/cortex_xdr_manuel/images/dashboard_manager_full.png)
   
   *Figure 2.7 : Interface du Dashboard Manager*

2. Dans cette vue, vous pouvez :
   - Voir tous les dashboards disponibles (prédéfinis et personnalisés)
   - Rechercher un dashboard spécifique
   - Trier les dashboards par nom, type ou date de modification
   - Voir qui a créé chaque dashboard et quand

3. Pour ouvrir un dashboard, cliquez simplement sur son nom

4. Pour d'autres actions, utilisez le menu ⋮ à droite de chaque dashboard :
   - Définir comme dashboard par défaut
   - Dupliquer
   - Exporter
   - Partager
   - Supprimer (uniquement pour les dashboards personnalisés)

### Navigation rapide entre dashboards

Pour passer rapidement d'un dashboard à un autre :

1. Utilisez le sélecteur de dashboard dans l'en-tête de la page
   
   ![Sélecteur rapide](/home/ubuntu/cortex_xdr_manuel/images/quick_dashboard_selector.png)
   
   *Figure 2.8 : Sélecteur rapide de dashboard*

2. Cliquez sur le nom du dashboard actuel pour ouvrir un menu déroulant

3. Sélectionnez le dashboard souhaité dans la liste

4. Pour les dashboards fréquemment utilisés, marquez-les comme favoris :
   - Cliquez sur l'icône d'étoile ★ à côté du nom du dashboard
   - Les dashboards favoris apparaîtront en haut de la liste pour un accès plus rapide

## 2.4 Comprendre les widgets et indicateurs

Chaque widget du dashboard fournit des informations spécifiques sur votre environnement de sécurité. Cette section explique comment interpréter et interagir avec les widgets les plus courants.

### Widget "Security Alerts" (Alertes de sécurité)

Ce widget présente les alertes de sécurité récentes nécessitant votre attention :

![Widget Alertes de sécurité](/home/ubuntu/cortex_xdr_manuel/images/security_alerts_widget.png)

*Figure 2.9 : Widget des alertes de sécurité*

1. **Éléments clés** :
   - Liste des alertes récentes par ordre de sévérité
   - Icône de sévérité (rouge, orange, jaune, bleu)
   - Description concise de l'alerte
   - Horodatage de détection

2. **Comment l'utiliser** :
   - Cliquez sur une alerte pour accéder directement à ses détails
   - Utilisez les filtres en haut du widget pour affiner l'affichage
   - Survolez l'icône de sévérité pour voir le niveau exact

3. **Indicateurs à surveiller** :
   - Augmentation soudaine du nombre d'alertes
   - Alertes critiques (rouge) nécessitant une attention immédiate
   - Modèles récurrents d'alertes similaires

### Widget "Endpoint Status" (État des endpoints)

Ce widget offre une vue d'ensemble de l'état de santé de vos endpoints :

![Widget État des endpoints](/home/ubuntu/cortex_xdr_manuel/images/endpoint_status_widget.png)

*Figure 2.10 : Widget d'état des endpoints*

1. **Éléments clés** :
   - Graphique circulaire montrant la répartition des états
   - Nombre total d'endpoints surveillés
   - Catégories d'état : Connectés, Déconnectés, En alerte, Non supportés

2. **Comment l'utiliser** :
   - Cliquez sur un segment du graphique pour filtrer la liste des endpoints
   - Utilisez le menu déroulant pour changer la métrique affichée
   - Exportez les données via l'icône de téléchargement

3. **Indicateurs à surveiller** :
   - Pourcentage élevé d'endpoints déconnectés
   - Endpoints en état d'alerte (rouge ou orange)
   - Tendances de déconnexion inhabituelles

### Widget "Threats Over Time" (Menaces dans le temps)

Ce widget montre l'évolution des menaces détectées sur une période donnée :

![Widget Menaces dans le temps](/home/ubuntu/cortex_xdr_manuel/images/threats_over_time_widget.png)

*Figure 2.11 : Widget des menaces dans le temps*

1. **Éléments clés** :
   - Graphique temporel avec courbes de tendance
   - Différentes couleurs pour les niveaux de sévérité
   - Axe horizontal représentant le temps
   - Axe vertical représentant le nombre de menaces

2. **Comment l'utiliser** :
   - Survolez les points du graphique pour voir les détails
   - Utilisez les boutons de légende pour afficher/masquer certaines sévérités
   - Cliquez sur une période spécifique pour zoomer
   - Utilisez les contrôles en bas pour ajuster la période affichée

3. **Indicateurs à surveiller** :
   - Pics soudains d'activité malveillante
   - Tendances à la hausse sur plusieurs jours
   - Corrélation entre différents types de menaces

### Widget "Recent Incidents" (Incidents récents)

Ce widget affiche les incidents de sécurité récemment détectés :

![Widget Incidents récents](/home/ubuntu/cortex_xdr_manuel/images/recent_incidents_widget.png)

*Figure 2.12 : Widget des incidents récents*

1. **Éléments clés** :
   - ID de l'incident
   - Description concise
   - Sévérité (indiquée par couleur et icône)
   - Horodatage de création
   - Statut de l'incident

2. **Comment l'utiliser** :
   - Cliquez sur un incident pour accéder à sa page de détails
   - Utilisez le menu de tri pour réorganiser la liste
   - Filtrez par sévérité ou statut via les options en haut

3. **Indicateurs à surveiller** :
   - Incidents critiques non résolus
   - Incidents similaires ou liés
   - Temps écoulé depuis la détection initiale

## 2.5 Interaction avancée avec les widgets

Les widgets de Cortex XDR offrent des fonctionnalités d'interaction avancées pour une analyse plus approfondie.

### Filtrage des données dans un widget

Pour affiner les données affichées dans un widget :

1. Localisez l'icône de filtre en haut du widget
   
   ![Filtres de widget](/home/ubuntu/cortex_xdr_manuel/images/widget_filters.png)
   
   *Figure 2.13 : Options de filtrage d'un widget*

2. Cliquez sur l'icône pour ouvrir le panneau de filtres

3. Configurez les filtres selon vos besoins :
   - Sélectionnez le champ à filtrer (ex : sévérité, type, statut)
   - Choisissez l'opérateur (égal à, contient, supérieur à, etc.)
   - Spécifiez la valeur du filtre

4. Pour ajouter des conditions supplémentaires :
   - Cliquez sur "+ Ajouter une condition"
   - Choisissez l'opérateur logique (ET/OU)
   - Configurez la nouvelle condition

5. Cliquez sur "Appliquer" pour mettre à jour l'affichage du widget

### Exploration des données (Drill-down)

Pour explorer plus en détail les données d'un widget :

1. Cliquez sur un élément spécifique du widget (barre de graphique, segment de camembert, ligne de tableau)
   
   ![Exploration de données](/home/ubuntu/cortex_xdr_manuel/images/drill_down.png)
   
   *Figure 2.14 : Exploration détaillée des données*

2. Un menu contextuel apparaît avec les options disponibles :
   - "Afficher les détails" : ouvre une vue détaillée
   - "Filtrer par cette valeur" : ajoute un filtre basé sur la sélection
   - "Exclure cette valeur" : ajoute un filtre négatif
   - "Créer une alerte" : configure une alerte basée sur ce critère

3. Selon le type de données, vous pouvez accéder à des vues spécialisées :
   - Timeline pour les événements chronologiques
   - Graphe de processus pour les chaînes d'exécution
   - Vue géographique pour les données de localisation

### Exportation des données

Pour exporter les données d'un widget :

1. Cliquez sur l'icône d'exportation (↓) en haut du widget
   
   ![Options d'exportation](/home/ubuntu/cortex_xdr_manuel/images/export_options.png)
   
   *Figure 2.15 : Options d'exportation des données*

2. Choisissez le format d'exportation souhaité :
   - CSV : pour l'analyse dans des tableurs
   - PDF : pour le partage et l'impression
   - PNG : pour l'inclusion dans des rapports

3. Configurez les options d'exportation si nécessaire :
   - Inclure tous les champs ou seulement ceux affichés
   - Appliquer les filtres actuels ou exporter toutes les données
   - Définir le nombre maximal d'enregistrements

4. Cliquez sur "Exporter" pour générer et télécharger le fichier

### Actualisation des données

Pour actualiser manuellement les données d'un widget :

1. Localisez l'icône d'actualisation (↻) en haut du widget
   
   ![Actualisation des données](/home/ubuntu/cortex_xdr_manuel/images/refresh_widget.png)
   
   *Figure 2.16 : Options d'actualisation des données*

2. Cliquez sur l'icône pour actualiser immédiatement les données du widget

3. Pour configurer l'actualisation automatique :
   - Cliquez sur la flèche à côté de l'icône d'actualisation
   - Sélectionnez l'intervalle souhaité (30s, 1m, 5m, 15m, 30m)
   - L'icône affichera une petite horloge indiquant que l'actualisation automatique est activée

4. Pour désactiver l'actualisation automatique :
   - Cliquez à nouveau sur la flèche
   - Sélectionnez "Désactiver l'actualisation automatique"
# 3. Dashboards Prédéfinis - Guide Visuel

## 3.1 Vue d'ensemble des dashboards prédéfinis

Cortex XDR propose une série de dashboards prédéfinis, chacun conçu pour répondre à des besoins spécifiques de surveillance et d'analyse. Cette section présente en détail chaque dashboard prédéfini avec ses fonctionnalités et cas d'usage.

![Liste des dashboards prédéfinis](/home/ubuntu/cortex_xdr_manuel/images/predefined_dashboards_list.png)

*Figure 3.1 : Liste complète des dashboards prédéfinis disponibles*

### Accès aux dashboards prédéfinis

Pour accéder aux dashboards prédéfinis :

1. Dans le menu principal, cliquez sur **Dashboards & Reports**
2. Sélectionnez **Dashboard** dans le menu déroulant
3. Dans l'en-tête du dashboard, cliquez sur le nom du dashboard actuel pour afficher la liste des dashboards disponibles
4. Sélectionnez le dashboard prédéfini que vous souhaitez consulter

## 3.2 Dashboard de gestion des agents

Le dashboard de gestion des agents (Agent Management) offre une vue complète sur l'état et la santé de tous les agents Cortex XDR déployés dans votre environnement.

![Dashboard de gestion des agents](/home/ubuntu/cortex_xdr_manuel/images/agent_management_dashboard.png)

*Figure 3.2 : Dashboard de gestion des agents avec annotations*

### Éléments clés du dashboard

1. **Vue d'ensemble des agents**
   - Nombre total d'agents déployés
   - Répartition par statut de connexion (connectés/déconnectés)
   - Distribution par système d'exploitation
   - Versions des agents

2. **Statut de santé des agents**
   - Agents nécessitant une attention (problèmes de configuration, erreurs)
   - Agents avec des mises à jour en attente
   - Problèmes de communication

3. **Déploiement et couverture**
   - Répartition géographique des agents
   - Couverture par unité organisationnelle
   - Évolution du déploiement dans le temps

### Utilisation pratique

Ce dashboard est particulièrement utile pour :

- **Surveillance quotidienne** : Vérifier rapidement l'état global de votre déploiement
- **Planification des mises à jour** : Identifier les agents nécessitant des mises à jour
- **Résolution de problèmes** : Repérer les agents déconnectés ou en erreur
- **Reporting de couverture** : Générer des rapports sur la couverture de protection

### Widgets spécifiques et leur utilisation

#### Widget "Agent Version Distribution"

![Widget de distribution des versions](/home/ubuntu/cortex_xdr_manuel/images/agent_version_widget.png)

*Figure 3.3 : Widget de distribution des versions d'agents*

Ce widget présente la répartition des agents par version sous forme de graphique circulaire.

**Comment l'utiliser :**
1. Identifiez les versions obsolètes nécessitant une mise à jour
2. Cliquez sur un segment pour voir la liste des endpoints concernés
3. Utilisez le menu contextuel pour planifier des mises à jour

#### Widget "Agent Health Status"

![Widget de statut de santé](/home/ubuntu/cortex_xdr_manuel/images/agent_health_widget.png)

*Figure 3.4 : Widget de statut de santé des agents*

Ce widget affiche les problèmes de santé détectés sur les agents.

**Comment l'utiliser :**
1. Consultez la liste des problèmes par ordre de priorité
2. Cliquez sur un problème spécifique pour voir les détails
3. Utilisez les filtres pour affiner l'affichage par type de problème
4. Exportez la liste pour un suivi hors ligne

## 3.3 Dashboard d'inventaire cloud

Le dashboard d'inventaire cloud (Cloud Inventory) offre une visibilité complète sur vos ressources cloud et leur sécurité.

![Dashboard d'inventaire cloud](/home/ubuntu/cortex_xdr_manuel/images/cloud_inventory_dashboard.png)

*Figure 3.5 : Dashboard d'inventaire cloud avec annotations*

### Éléments clés du dashboard

1. **Vue d'ensemble des ressources cloud**
   - Nombre total de ressources surveillées
   - Répartition par fournisseur cloud (AWS, Azure, GCP)
   - Distribution par type de ressource (VM, conteneurs, fonctions serverless)
   - Statut de sécurité global

2. **Alertes et vulnérabilités**
   - Ressources avec des alertes actives
   - Vulnérabilités détectées par niveau de criticité
   - Tendances des alertes dans le temps

3. **Conformité et configuration**
   - Score de conformité par standard (CIS, NIST, etc.)
   - Problèmes de mauvaise configuration
   - Recommandations de sécurité

### Utilisation pratique

Ce dashboard est particulièrement utile pour :

- **Inventaire cloud** : Maintenir une vue à jour de toutes vos ressources cloud
- **Gestion des risques** : Identifier rapidement les ressources vulnérables
- **Conformité** : Suivre le niveau de conformité de vos environnements cloud
- **Optimisation** : Repérer les ressources mal configurées ou sous-utilisées

### Widgets spécifiques et leur utilisation

#### Widget "Cloud Resources by Provider"

![Widget de ressources par fournisseur](/home/ubuntu/cortex_xdr_manuel/images/cloud_resources_widget.png)

*Figure 3.6 : Widget de ressources par fournisseur cloud*

Ce widget présente la répartition des ressources cloud par fournisseur.

**Comment l'utiliser :**
1. Visualisez la distribution de vos ressources entre différents fournisseurs
2. Cliquez sur un segment pour filtrer les autres widgets par ce fournisseur
3. Utilisez le menu contextuel pour accéder à des vues détaillées

#### Widget "Cloud Security Posture"

![Widget de posture de sécurité cloud](/home/ubuntu/cortex_xdr_manuel/images/cloud_security_posture_widget.png)

*Figure 3.7 : Widget de posture de sécurité cloud*

Ce widget affiche un score de sécurité global et par service.

**Comment l'utiliser :**
1. Identifiez les services présentant les scores les plus bas
2. Cliquez sur un service pour voir les problèmes spécifiques
3. Suivez l'évolution du score dans le temps grâce au graphique de tendance
4. Exportez les données pour les intégrer dans vos rapports de conformité

## 3.4 Dashboard d'ingestion de données

Le dashboard d'ingestion de données (Data Ingestion) permet de surveiller et d'analyser les flux de données entrant dans Cortex XDR.

![Dashboard d'ingestion de données](/home/ubuntu/cortex_xdr_manuel/images/data_ingestion_dashboard.png)

*Figure 3.8 : Dashboard d'ingestion de données avec annotations*

### Éléments clés du dashboard

1. **Vue d'ensemble de l'ingestion**
   - Volume total de données ingérées
   - Répartition par source de données
   - Tendances d'ingestion dans le temps
   - Quotas et limites d'utilisation

2. **Santé de l'ingestion**
   - Statut des connecteurs de données
   - Erreurs et avertissements
   - Latence d'ingestion

3. **Analyse des données**
   - Types de données les plus fréquents
   - Sources les plus actives
   - Anomalies dans les flux de données

### Utilisation pratique

Ce dashboard est particulièrement utile pour :

- **Surveillance des flux de données** : Vérifier que toutes les sources envoient correctement leurs données
- **Gestion des quotas** : Suivre la consommation par rapport aux limites définies
- **Résolution de problèmes** : Identifier rapidement les interruptions ou anomalies d'ingestion
- **Planification de capacité** : Anticiper les besoins futurs en analysant les tendances

### Widgets spécifiques et leur utilisation

#### Widget "Data Ingestion by Source"

![Widget d'ingestion par source](/home/ubuntu/cortex_xdr_manuel/images/data_ingestion_source_widget.png)

*Figure 3.9 : Widget d'ingestion de données par source*

Ce widget présente la répartition du volume de données par source.

**Comment l'utiliser :**
1. Identifiez les sources générant le plus de données
2. Repérez les sources inactives ou anormalement silencieuses
3. Cliquez sur une source pour voir son évolution dans le temps
4. Utilisez les filtres pour affiner l'analyse par période

#### Widget "Ingestion Health Status"

![Widget de santé d'ingestion](/home/ubuntu/cortex_xdr_manuel/images/ingestion_health_widget.png)

*Figure 3.10 : Widget de santé de l'ingestion de données*

Ce widget affiche l'état de santé des différents connecteurs d'ingestion.

**Comment l'utiliser :**
1. Vérifiez rapidement le statut de tous les connecteurs
2. Identifiez les connecteurs en erreur ou dégradés
3. Cliquez sur un connecteur problématique pour voir les détails de l'erreur
4. Utilisez le menu contextuel pour accéder aux options de dépannage

## 3.5 Dashboard d'incidents

Le dashboard d'incidents (Incidents Overview) offre une vue complète sur tous les incidents de sécurité détectés dans votre environnement.

![Dashboard d'incidents](/home/ubuntu/cortex_xdr_manuel/images/incidents_dashboard.png)

*Figure 3.11 : Dashboard d'incidents avec annotations*

### Éléments clés du dashboard

1. **Vue d'ensemble des incidents**
   - Nombre total d'incidents actifs
   - Répartition par sévérité et statut
   - Tendances des incidents dans le temps
   - Temps moyen de résolution

2. **Analyse des incidents**
   - Types d'incidents les plus fréquents
   - Endpoints les plus touchés
   - Utilisateurs les plus ciblés
   - Techniques d'attaque détectées (MITRE ATT&CK)

3. **Métriques de performance**
   - Temps moyen de détection (MTTD)
   - Temps moyen de réponse (MTTR)
   - Efficacité des actions de remédiation
   - Taux de faux positifs

### Utilisation pratique

Ce dashboard est particulièrement utile pour :

- **Triage quotidien** : Prioriser les incidents nécessitant une attention immédiate
- **Analyse de tendances** : Identifier les modèles d'attaque récurrents
- **Reporting** : Générer des rapports sur l'activité des menaces
- **Mesure de performance** : Évaluer l'efficacité de votre équipe de sécurité

### Widgets spécifiques et leur utilisation

#### Widget "Incidents by Severity"

![Widget d'incidents par sévérité](/home/ubuntu/cortex_xdr_manuel/images/incidents_severity_widget.png)

*Figure 3.12 : Widget d'incidents par niveau de sévérité*

Ce widget présente la répartition des incidents par niveau de sévérité.

**Comment l'utiliser :**
1. Identifiez rapidement le nombre d'incidents critiques nécessitant une attention immédiate
2. Suivez l'évolution des différentes sévérités dans le temps
3. Cliquez sur une catégorie pour filtrer la liste des incidents
4. Utilisez le menu contextuel pour accéder à des vues détaillées

#### Widget "MITRE ATT&CK Coverage"

![Widget de couverture MITRE ATT&CK](/home/ubuntu/cortex_xdr_manuel/images/mitre_coverage_widget.png)

*Figure 3.13 : Widget de couverture MITRE ATT&CK*

Ce widget affiche les techniques MITRE ATT&CK détectées dans les incidents.

**Comment l'utiliser :**
1. Identifiez les techniques d'attaque les plus fréquemment utilisées
2. Visualisez la couverture par tactique (persistance, exfiltration, etc.)
3. Cliquez sur une technique pour voir les incidents associés
4. Utilisez ces informations pour orienter vos efforts de durcissement

## 3.6 Dashboard de chasse aux menaces

Le dashboard de chasse aux menaces (Threat Hunting) est conçu pour faciliter la recherche proactive de menaces dans votre environnement.

![Dashboard de chasse aux menaces](/home/ubuntu/cortex_xdr_manuel/images/threat_hunting_dashboard.png)

*Figure 3.14 : Dashboard de chasse aux menaces avec annotations*

### Éléments clés du dashboard

1. **Indicateurs de compromission (IOC)**
   - IOCs détectés récemment
   - Distribution par type (hash, IP, domaine, etc.)
   - Correspondances dans l'environnement
   - Sources de threat intelligence

2. **Activités suspectes**
   - Comportements anormaux détectés
   - Connexions réseau inhabituelles
   - Exécutions de processus suspects
   - Anomalies d'authentification

3. **Outils de chasse**
   - Requêtes XQL prédéfinies
   - Modèles de chasse courants
   - Résultats des dernières chasses
   - Indicateurs de risque

### Utilisation pratique

Ce dashboard est particulièrement utile pour :

- **Chasse proactive** : Rechercher des menaces avant qu'elles ne déclenchent des alertes
- **Investigation approfondie** : Explorer des comportements suspects
- **Validation d'hypothèses** : Tester des théories sur des activités potentiellement malveillantes
- **Threat intelligence** : Vérifier la présence d'IOCs connus dans votre environnement

### Widgets spécifiques et leur utilisation

#### Widget "IOC Matches"

![Widget de correspondances IOC](/home/ubuntu/cortex_xdr_manuel/images/ioc_matches_widget.png)

*Figure 3.15 : Widget de correspondances d'indicateurs de compromission*

Ce widget présente les correspondances récentes avec des indicateurs de compromission connus.

**Comment l'utiliser :**
1. Consultez la liste des IOCs détectés dans votre environnement
2. Filtrez par type d'IOC ou par source de threat intelligence
3. Cliquez sur un IOC pour voir les détails des correspondances
4. Utilisez le menu contextuel pour lancer une investigation approfondie

#### Widget "Suspicious Process Executions"

![Widget d'exécutions suspectes](/home/ubuntu/cortex_xdr_manuel/images/suspicious_executions_widget.png)

*Figure 3.16 : Widget d'exécutions de processus suspects*

Ce widget affiche les exécutions de processus considérées comme suspectes.

**Comment l'utiliser :**
1. Examinez la liste des processus suspects par ordre de risque
2. Identifiez les modèles récurrents ou les endpoints particulièrement actifs
3. Cliquez sur un processus pour voir sa chaîne d'exécution complète
4. Utilisez les filtres pour affiner l'analyse par utilisateur, endpoint ou période

## 3.7 Autres dashboards spécialisés

Cortex XDR propose d'autres dashboards spécialisés pour des cas d'usage spécifiques. Voici les principaux :

### Dashboard de sécurité des endpoints

![Dashboard de sécurité des endpoints](/home/ubuntu/cortex_xdr_manuel/images/endpoint_security_dashboard.png)

*Figure 3.17 : Dashboard de sécurité des endpoints*

Ce dashboard se concentre sur la sécurité des endpoints, avec des widgets dédiés à :
- L'état des protections (antivirus, anti-exploit, etc.)
- Les vulnérabilités détectées
- Les tentatives de violation bloquées
- L'état des correctifs de sécurité

### Dashboard de sécurité réseau

![Dashboard de sécurité réseau](/home/ubuntu/cortex_xdr_manuel/images/network_security_dashboard.png)

*Figure 3.18 : Dashboard de sécurité réseau*

Ce dashboard présente des informations sur la sécurité réseau, notamment :
- Le trafic suspect ou malveillant
- Les connexions à des domaines malveillants
- Les tentatives d'exfiltration de données
- Les anomalies de communication

### Dashboard de conformité

![Dashboard de conformité](/home/ubuntu/cortex_xdr_manuel/images/compliance_dashboard.png)

*Figure 3.19 : Dashboard de conformité*

Ce dashboard aide à suivre la conformité aux différentes normes et réglementations :
- Scores de conformité par standard (PCI DSS, HIPAA, GDPR, etc.)
- Problèmes de non-conformité détectés
- Évolution de la conformité dans le temps
- Recommandations d'amélioration

### Dashboard exécutif

![Dashboard exécutif](/home/ubuntu/cortex_xdr_manuel/images/executive_dashboard.png)

*Figure 3.20 : Dashboard exécutif*

Ce dashboard présente une vue synthétique destinée aux responsables de sécurité :
- Indicateurs clés de performance (KPIs)
- Tendances des menaces
- Résumé des incidents majeurs
- Métriques d'efficacité de la sécurité
# 4. Création et Personnalisation de Dashboards - Guide Visuel

## 4.1 Création d'un nouveau dashboard personnalisé

Cortex XDR vous permet de créer des dashboards entièrement personnalisés pour répondre à vos besoins spécifiques. Voici un guide étape par étape pour créer votre propre dashboard.

### Accès au Dashboard Manager

1. Dans le menu principal, cliquez sur **Dashboards & Reports**
   
   ![Menu Dashboards & Reports](/home/ubuntu/cortex_xdr_manuel/images/dashboards_reports_menu.png)
   
   *Figure 4.1 : Accès au menu Dashboards & Reports*

2. Sélectionnez **Dashboard Manager** dans le menu déroulant
   
   ![Dashboard Manager](/home/ubuntu/cortex_xdr_manuel/images/dashboard_manager_menu.png)
   
   *Figure 4.2 : Sélection du Dashboard Manager*

3. La page du Dashboard Manager s'ouvre, affichant tous les dashboards disponibles

### Création d'un nouveau dashboard

1. Cliquez sur le bouton **+ Créer un dashboard** en haut à droite
   
   ![Bouton Créer un dashboard](/home/ubuntu/cortex_xdr_manuel/images/create_dashboard_button.png)
   
   *Figure 4.3 : Bouton de création d'un nouveau dashboard*

2. Dans la fenêtre qui s'ouvre, renseignez les informations de base :
   
   ![Formulaire de création](/home/ubuntu/cortex_xdr_manuel/images/dashboard_creation_form.png)
   
   *Figure 4.4 : Formulaire de création d'un nouveau dashboard*
   
   - **Nom** : Donnez un nom descriptif à votre dashboard
   - **Description** (optionnel) : Ajoutez une brève description de l'objectif du dashboard
   - **Partage** : Choisissez si le dashboard sera privé ou partagé avec d'autres utilisateurs

3. Sélectionnez une méthode de création :
   - **Dashboard vide** : Commencer avec un dashboard entièrement vide
   - **À partir d'un modèle** : Utiliser un modèle prédéfini comme point de départ
   - **Dupliquer un dashboard existant** : Copier un dashboard existant pour le personnaliser

4. Cliquez sur **Créer** pour générer votre nouveau dashboard

### Configuration de la mise en page

Une fois le dashboard créé, vous accédez à l'interface d'édition :

![Interface d'édition de dashboard](/home/ubuntu/cortex_xdr_manuel/images/dashboard_edit_interface.png)

*Figure 4.5 : Interface d'édition d'un nouveau dashboard*

1. **Définir la disposition** :
   - Cliquez sur **Modifier la disposition** dans le menu en haut à droite
   - Choisissez le nombre de colonnes (1 à 4)
   - Sélectionnez l'espacement entre les widgets
   - Définissez les marges globales

2. **Ajouter un titre et une description** :
   - Cliquez sur l'en-tête du dashboard pour le modifier
   - Ajoutez un titre principal
   - Incluez une description détaillée si nécessaire
   - Personnalisez la police et les couleurs si disponible

## 4.2 Ajout et configuration de widgets

Les widgets sont les éléments de base qui composent votre dashboard. Voici comment les ajouter et les configurer.

### Ajout d'un widget

1. Dans votre dashboard en mode édition, cliquez sur le bouton **+ Ajouter un widget**
   
   ![Bouton Ajouter un widget](/home/ubuntu/cortex_xdr_manuel/images/add_widget_button.png)
   
   *Figure 4.6 : Bouton d'ajout de widget*

2. La bibliothèque de widgets s'ouvre, présentant les différentes catégories disponibles :
   
   ![Bibliothèque de widgets](/home/ubuntu/cortex_xdr_manuel/images/widget_library.png)
   
   *Figure 4.7 : Bibliothèque de widgets*

3. Parcourez les catégories ou utilisez la barre de recherche pour trouver un widget spécifique :
   - **Widgets standards** : Widgets prédéfinis pour les cas d'usage courants
   - **Widgets XQL** : Widgets basés sur des requêtes XQL personnalisées
   - **Widgets texte** : Widgets pour ajouter du texte explicatif ou des instructions
   - **Widgets favoris** : Widgets que vous avez marqués comme favoris

4. Survolez un widget pour voir un aperçu et une description

5. Cliquez sur le widget souhaité pour l'ajouter à votre dashboard

### Configuration d'un widget standard

Une fois le widget ajouté, vous devez le configurer :

![Configuration de widget](/home/ubuntu/cortex_xdr_manuel/images/widget_configuration.png)

*Figure 4.8 : Interface de configuration d'un widget*

1. **Paramètres généraux** :
   - **Titre** : Personnalisez le titre du widget
   - **Description** : Ajoutez une description explicative (optionnel)
   - **Actualisation** : Définissez la fréquence d'actualisation des données

2. **Filtres de données** :
   - Sélectionnez la période de temps à analyser
   - Appliquez des filtres spécifiques (par groupe d'endpoints, par type d'événement, etc.)
   - Définissez des conditions pour affiner les données affichées

3. **Options d'affichage** :
   - Choisissez le type de visualisation (graphique, tableau, métrique, etc.)
   - Configurez les couleurs et les étiquettes
   - Définissez les seuils pour le codage couleur (si applicable)
   - Ajustez les options spécifiques au type de visualisation

4. **Taille et position** :
   - Définissez la largeur du widget (nombre de colonnes)
   - Définissez la hauteur du widget
   - Positionnez le widget dans la grille du dashboard

5. Cliquez sur **Enregistrer** pour appliquer la configuration

### Création d'un widget XQL personnalisé

Les widgets XQL vous permettent de créer des visualisations basées sur vos propres requêtes XQL :

![Création de widget XQL](/home/ubuntu/cortex_xdr_manuel/images/xql_widget_creation.png)

*Figure 4.9 : Création d'un widget XQL personnalisé*

1. Dans la bibliothèque de widgets, sélectionnez **Widget XQL personnalisé**

2. Dans l'éditeur de requête, saisissez votre requête XQL :
   ```
   dataset = xdr_data | filter event_type = PROCESS_EXECUTION | 
   stats count() by hostname | sort by count() desc | limit 10
   ```

3. Cliquez sur **Exécuter** pour tester votre requête et voir un aperçu des résultats

4. Configurez la visualisation :
   - Sélectionnez le type de graphique approprié pour vos données
   - Définissez les champs à utiliser pour les axes X et Y
   - Configurez les options de formatage et d'affichage

5. Ajoutez un titre et une description explicative

6. Cliquez sur **Ajouter au dashboard** pour intégrer le widget

### Ajout d'un widget texte

Les widgets texte sont utiles pour ajouter des explications, des instructions ou des séparateurs :

![Widget texte](/home/ubuntu/cortex_xdr_manuel/images/text_widget.png)

*Figure 4.10 : Configuration d'un widget texte*

1. Dans la bibliothèque de widgets, sélectionnez **Widget texte**

2. Dans l'éditeur de texte, saisissez votre contenu :
   - Utilisez les outils de mise en forme pour styliser le texte
   - Ajoutez des liens hypertexte si nécessaire
   - Insérez des listes à puces ou numérotées

3. Définissez la taille et la position du widget

4. Cliquez sur **Ajouter au dashboard** pour intégrer le widget

## 4.3 Configuration des filtres et drilldowns

Les filtres et drilldowns permettent d'explorer les données de manière interactive et d'approfondir l'analyse.

### Configuration des filtres globaux

Les filtres globaux s'appliquent à l'ensemble du dashboard :

![Filtres globaux](/home/ubuntu/cortex_xdr_manuel/images/global_filters.png)

*Figure 4.11 : Configuration des filtres globaux*

1. Dans le mode édition du dashboard, cliquez sur **Configurer les filtres** en haut à droite

2. Dans la fenêtre qui s'ouvre, cliquez sur **+ Ajouter un filtre**

3. Configurez le nouveau filtre :
   - **Nom** : Donnez un nom descriptif au filtre
   - **Champ** : Sélectionnez le champ de données à filtrer
   - **Type** : Choisissez le type de filtre (liste déroulante, case à cocher, texte libre, etc.)
   - **Valeurs par défaut** : Définissez les valeurs initiales (optionnel)
   - **Obligatoire** : Indiquez si le filtre doit être obligatoirement renseigné

4. Pour ajouter d'autres filtres, répétez les étapes 2 et 3

5. Réorganisez les filtres par glisser-déposer si nécessaire

6. Cliquez sur **Enregistrer** pour appliquer les filtres

### Utilisation des filtres dans les widgets

Vous pouvez configurer chaque widget pour qu'il utilise les filtres globaux :

![Filtres de widget](/home/ubuntu/cortex_xdr_manuel/images/widget_filters.png)

*Figure 4.12 : Configuration des filtres au niveau du widget*

1. En mode édition du widget, accédez à la section **Filtres**

2. Activez l'option **Utiliser les filtres globaux** pour que le widget réponde aux filtres du dashboard

3. Vous pouvez également ajouter des filtres spécifiques au widget :
   - Cliquez sur **+ Ajouter un filtre**
   - Configurez le filtre comme pour les filtres globaux
   - Ces filtres ne s'appliqueront qu'au widget en cours

4. Cliquez sur **Appliquer** pour enregistrer les modifications

### Configuration des drilldowns

Les drilldowns permettent aux utilisateurs d'explorer les données en profondeur en cliquant sur des éléments du widget :

![Configuration de drilldown](/home/ubuntu/cortex_xdr_manuel/images/drilldown_configuration.png)

*Figure 4.13 : Configuration des options de drilldown*

1. En mode édition du widget, accédez à la section **Drilldowns**

2. Cliquez sur **+ Ajouter un drilldown**

3. Configurez le drilldown :
   - **Type d'action** : Choisissez l'action à déclencher (filtrer le dashboard, ouvrir un autre dashboard, afficher les détails, etc.)
   - **Destination** : Sélectionnez la destination de l'action (si applicable)
   - **Mappage des champs** : Définissez comment les valeurs sélectionnées seront transmises

4. Vous pouvez ajouter plusieurs drilldowns pour différents types d'interactions

5. Cliquez sur **Appliquer** pour enregistrer les configurations

### Exemple pratique de drilldown

Voici un exemple concret de configuration de drilldown :

![Exemple de drilldown](/home/ubuntu/cortex_xdr_manuel/images/drilldown_example.png)

*Figure 4.14 : Exemple de drilldown en action*

1. **Scénario** : Widget affichant le nombre d'alertes par type

2. **Configuration du drilldown** :
   - Type d'action : Ouvrir un dashboard filtré
   - Destination : Dashboard "Analyse détaillée des alertes"
   - Mappage : La valeur du type d'alerte cliqué est transmise comme filtre

3. **Utilisation** :
   - L'utilisateur clique sur un type d'alerte spécifique dans le graphique
   - Le dashboard "Analyse détaillée des alertes" s'ouvre automatiquement
   - Les données sont filtrées pour n'afficher que le type d'alerte sélectionné

## 4.4 Partage et export de dashboards

Une fois votre dashboard personnalisé créé, vous pouvez le partager avec d'autres utilisateurs ou l'exporter pour une utilisation externe.

### Partage d'un dashboard

Pour partager votre dashboard avec d'autres utilisateurs :

![Options de partage](/home/ubuntu/cortex_xdr_manuel/images/dashboard_sharing.png)

*Figure 4.15 : Options de partage de dashboard*

1. Dans le Dashboard Manager, localisez votre dashboard dans la liste

2. Cliquez sur l'icône ⋮ (menu contextuel) à droite du dashboard

3. Sélectionnez **Partager**

4. Dans la fenêtre de partage qui s'ouvre :
   - **Visibilité** : Choisissez entre "Privé", "Partagé avec des utilisateurs spécifiques" ou "Public"
   - **Utilisateurs** : Si vous choisissez le partage limité, sélectionnez les utilisateurs ou groupes
   - **Permissions** : Définissez les droits accordés (lecture seule, modification, etc.)

5. Activez l'option **Notifier les utilisateurs** si vous souhaitez qu'ils reçoivent une notification

6. Cliquez sur **Partager** pour confirmer

### Génération d'un lien partageable

Pour créer un lien direct vers votre dashboard :

![Génération de lien](/home/ubuntu/cortex_xdr_manuel/images/dashboard_link.png)

*Figure 4.16 : Génération d'un lien partageable*

1. Ouvrez le dashboard que vous souhaitez partager

2. Cliquez sur l'icône de partage en haut à droite

3. Dans le menu qui s'affiche, sélectionnez **Copier le lien**

4. Le lien est copié dans votre presse-papiers et peut être partagé par email ou messagerie

5. Options avancées :
   - **Inclure les filtres actuels** : Le lien conservera les filtres que vous avez appliqués
   - **Générer un lien temporaire** : Créez un lien qui expire après une période définie

### Export au format PDF

Pour exporter votre dashboard au format PDF :

![Export PDF](/home/ubuntu/cortex_xdr_manuel/images/dashboard_pdf_export.png)

*Figure 4.17 : Options d'export PDF*

1. Ouvrez le dashboard que vous souhaitez exporter

2. Cliquez sur l'icône d'export en haut à droite

3. Sélectionnez **Exporter en PDF**

4. Dans la fenêtre de configuration qui s'ouvre :
   - **Format de page** : Choisissez entre A4, Letter ou autre
   - **Orientation** : Portrait ou Paysage
   - **Inclure les filtres** : Option pour afficher les filtres appliqués
   - **En-tête et pied de page** : Personnalisez le contenu

5. Cliquez sur **Aperçu** pour voir le résultat avant l'export final

6. Cliquez sur **Exporter** pour générer et télécharger le fichier PDF

### Planification de rapports automatiques

Vous pouvez configurer l'envoi automatique de votre dashboard sous forme de rapport :

![Planification de rapports](/home/ubuntu/cortex_xdr_manuel/images/report_scheduling.png)

*Figure 4.18 : Configuration de rapports automatiques*

1. Dans le Dashboard Manager, cliquez sur l'icône ⋮ à côté de votre dashboard

2. Sélectionnez **Planifier un rapport**

3. Dans la fenêtre de configuration :
   - **Nom du rapport** : Donnez un nom au rapport planifié
   - **Format** : Choisissez PDF, CSV ou les deux
   - **Fréquence** : Définissez la périodicité (quotidien, hebdomadaire, mensuel)
   - **Heure d'envoi** : Spécifiez l'heure d'envoi
   - **Destinataires** : Ajoutez les adresses email des destinataires
   - **Contenu du message** : Personnalisez le texte de l'email

4. Options avancées :
   - **Période de données** : Fixe ou relative à la date d'envoi
   - **Filtres** : Appliquer des filtres spécifiques
   - **Pièces jointes** : Inclure des fichiers supplémentaires

5. Cliquez sur **Enregistrer** pour activer la planification

## 4.5 Bonnes pratiques pour la création de dashboards

Voici quelques recommandations pour créer des dashboards efficaces et utiles.

### Organisation logique des widgets

![Organisation logique](/home/ubuntu/cortex_xdr_manuel/images/dashboard_organization.png)

*Figure 4.19 : Exemple d'organisation logique de dashboard*

- **Regroupez les widgets par thème** : Placez les widgets liés au même sujet à proximité
- **Suivez un flux de lecture naturel** : Organisez les widgets de gauche à droite et de haut en bas
- **Placez les informations critiques en haut** : Les métriques les plus importantes doivent être immédiatement visibles
- **Utilisez des widgets texte comme séparateurs** : Ajoutez des titres de section pour structurer le dashboard
- **Équilibrez la disposition** : Évitez de surcharger certaines zones du dashboard

### Choix des visualisations appropriées

![Types de visualisations](/home/ubuntu/cortex_xdr_manuel/images/visualization_types.png)

*Figure 4.20 : Guide de sélection des types de visualisation*

- **Graphiques linéaires** : Pour les tendances et évolutions dans le temps
- **Histogrammes** : Pour comparer des valeurs entre différentes catégories
- **Camemberts** : Pour montrer des proportions d'un tout (limiter à 7 segments maximum)
- **Jauges** : Pour afficher une métrique par rapport à un objectif ou seuil
- **Tableaux** : Pour présenter des données détaillées avec plusieurs colonnes
- **Cartes de chaleur** : Pour visualiser des matrices de données avec codage couleur
- **Métriques simples** : Pour mettre en évidence un chiffre clé

### Optimisation des performances

Pour garantir que vos dashboards se chargent rapidement :

- **Limitez le nombre de widgets** : Visez 10-15 widgets maximum par dashboard
- **Optimisez les requêtes XQL** : Utilisez des filtres efficaces et limitez les volumes de données
- **Échelonnez les actualisations** : Configurez des intervalles différents pour éviter les pics de charge
- **Utilisez des périodes de temps raisonnables** : Évitez d'analyser des mois de données si quelques jours suffisent
- **Préférez les agrégations** : Utilisez des données pré-agrégées plutôt que des données brutes quand c'est possible

### Dashboards par profil utilisateur

Adaptez vos dashboards aux besoins spécifiques de chaque profil d'utilisateur :

![Dashboards par profil](/home/ubuntu/cortex_xdr_manuel/images/dashboard_by_role.png)

*Figure 4.21 : Exemples de dashboards adaptés par profil*

**Pour les analystes SOC** :
- Incidents en cours nécessitant une attention
- Alertes récentes par sévérité
- File d'attente de triage
- Métriques de performance (MTTD, MTTR)

**Pour les administrateurs de sécurité** :
- État global du déploiement
- Couverture des agents
- Problèmes de configuration
- Statut des mises à jour

**Pour les responsables de sécurité** :
- KPIs de sécurité
- Tendances des incidents sur le long terme
- Comparaisons avec les périodes précédentes
- Métriques de conformité
# 5. Gestion des Incidents - Guide Visuel

## 5.1 Vue d'ensemble du tableau des incidents

Le module de gestion des incidents est l'un des composants les plus importants de Cortex XDR, permettant d'identifier, d'analyser et de résoudre efficacement les menaces de sécurité. Cette section présente en détail l'interface de gestion des incidents et son utilisation.

![Tableau des incidents](/home/ubuntu/cortex_xdr_manuel/images/incident_management_dashboard.png)

*Figure 5.1 : Vue d'ensemble du tableau des incidents avec annotations*

### Éléments clés de l'interface

1. **Barre de filtres supérieure**
   - Filtres de période temporelle
   - Filtres de sévérité (Critique, Élevée, Moyenne, Faible)
   - Filtres de statut (Nouveau, En cours, Résolu, Fermé)
   - Filtres d'assignation (À moi, Non assigné, Tous)

2. **Liste des incidents**
   - ID unique de l'incident
   - Description concise
   - Indicateur de sévérité (code couleur)
   - Horodatage de détection
   - Statut actuel
   - Utilisateur assigné
   - Nombre d'alertes associées
   - Endpoints concernés

3. **Panneau de prévisualisation**
   - Aperçu rapide de l'incident sélectionné
   - Chronologie des événements clés
   - Actions disponibles
   - Informations contextuelles

4. **Barre d'actions**
   - Boutons d'action rapide (Assigner, Modifier le statut, Ajouter des notes)
   - Options d'exportation et de partage
   - Paramètres d'affichage

### Navigation dans la liste des incidents

![Navigation des incidents](/home/ubuntu/cortex_xdr_manuel/images/incident_navigation.png)

*Figure 5.2 : Options de navigation dans la liste des incidents*

1. **Tri des incidents**
   - Cliquez sur l'en-tête de colonne pour trier par ce critère
   - Cliquez à nouveau pour inverser l'ordre (ascendant/descendant)
   - Utilisez le menu déroulant "Trier par" pour des options supplémentaires

2. **Filtrage avancé**
   - Cliquez sur "Filtres avancés" pour ouvrir le panneau de filtrage
   - Combinez plusieurs critères avec des opérateurs logiques (ET/OU)
   - Enregistrez vos filtres personnalisés pour une utilisation future

3. **Recherche rapide**
   - Utilisez la barre de recherche pour trouver des incidents spécifiques
   - Recherchez par ID, description, nom d'hôte, utilisateur, etc.
   - Utilisez des opérateurs spéciaux pour affiner la recherche (ex: "severity:high")

4. **Vues personnalisées**
   - Créez des vues personnalisées avec des filtres prédéfinis
   - Accédez rapidement à vos vues via le menu déroulant
   - Partagez vos vues avec d'autres membres de l'équipe

## 5.2 Analyse d'un incident étape par étape

Lorsqu'un incident est détecté, une analyse approfondie est nécessaire pour comprendre sa portée et y répondre efficacement. Voici un guide étape par étape pour analyser un incident dans Cortex XDR.

### Accès aux détails de l'incident

1. Dans la liste des incidents, cliquez sur l'incident que vous souhaitez analyser
   
   ![Sélection d'incident](/home/ubuntu/cortex_xdr_manuel/images/incident_selection.png)
   
   *Figure 5.3 : Sélection d'un incident dans la liste*

2. La page de détails de l'incident s'ouvre, présentant toutes les informations pertinentes
   
   ![Page de détails d'incident](/home/ubuntu/cortex_xdr_manuel/images/incident_details.png)
   
   *Figure 5.4 : Page de détails d'un incident*

### Compréhension du résumé de l'incident

La section de résumé fournit un aperçu rapide de l'incident :

![Résumé d'incident](/home/ubuntu/cortex_xdr_manuel/images/incident_summary.png)

*Figure 5.5 : Section de résumé d'incident*

1. **Informations générales**
   - ID et nom de l'incident
   - Sévérité et score de risque
   - Date et heure de détection
   - Statut actuel et assignation

2. **Indicateurs clés**
   - Type d'incident (malware, ransomware, exfiltration de données, etc.)
   - Techniques MITRE ATT&CK identifiées
   - Nombre d'alertes corrélées
   - Endpoints et utilisateurs affectés

3. **Chronologie condensée**
   - Visualisation des événements clés sur une ligne temporelle
   - Points d'intérêt marqués par des icônes spécifiques
   - Possibilité de zoomer sur certaines périodes

### Analyse de la chronologie détaillée

La chronologie est essentielle pour comprendre la séquence des événements :

![Chronologie d'incident](/home/ubuntu/cortex_xdr_manuel/images/incident_timeline.png)

*Figure 5.6 : Chronologie détaillée d'un incident*

1. **Navigation dans la chronologie**
   - Utilisez les contrôles de zoom pour ajuster la période affichée
   - Filtrez les événements par type ou sévérité
   - Cliquez sur un événement pour voir ses détails complets

2. **Analyse des événements clés**
   - Point d'entrée initial (patient zéro)
   - Actions de l'attaquant (exécution de code, mouvement latéral, etc.)
   - Activités de persistance
   - Tentatives d'exfiltration de données

3. **Corrélation des événements**
   - Identifiez les relations entre différents événements
   - Comprenez la progression de l'attaque
   - Repérez les modèles ou techniques utilisés

### Examen des alertes associées

Les incidents sont généralement composés de plusieurs alertes corrélées :

![Alertes associées](/home/ubuntu/cortex_xdr_manuel/images/incident_alerts.png)

*Figure 5.7 : Section des alertes associées à un incident*

1. **Liste des alertes**
   - Parcourez toutes les alertes qui composent l'incident
   - Triez par sévérité, type ou chronologie
   - Filtrez pour vous concentrer sur certains types d'alertes

2. **Analyse d'une alerte spécifique**
   - Cliquez sur une alerte pour voir ses détails
   - Examinez les preuves et artefacts associés
   - Vérifiez les règles de détection déclenchées

3. **Validation des alertes**
   - Marquez les alertes comme vrais ou faux positifs
   - Ajoutez des commentaires pour justifier votre évaluation
   - Utilisez ces informations pour affiner les règles de détection

### Analyse des endpoints affectés

Examinez les endpoints impliqués dans l'incident :

![Endpoints affectés](/home/ubuntu/cortex_xdr_manuel/images/incident_endpoints.png)

*Figure 5.8 : Section des endpoints affectés*

1. **Liste des endpoints**
   - Consultez tous les endpoints touchés par l'incident
   - Identifiez le patient zéro (premier endpoint compromis)
   - Visualisez la propagation entre les endpoints

2. **Détails d'un endpoint**
   - Cliquez sur un endpoint pour voir ses informations détaillées
   - Consultez la configuration et les vulnérabilités
   - Examinez l'historique des événements sur cet endpoint

3. **État de l'endpoint**
   - Vérifiez si l'endpoint est toujours connecté
   - Contrôlez si des actions de remédiation ont déjà été appliquées
   - Évaluez le niveau de compromission

### Analyse des utilisateurs impliqués

Identifiez et analysez les utilisateurs concernés par l'incident :

![Utilisateurs impliqués](/home/ubuntu/cortex_xdr_manuel/images/incident_users.png)

*Figure 5.9 : Section des utilisateurs impliqués*

1. **Liste des utilisateurs**
   - Consultez tous les utilisateurs liés à l'incident
   - Identifiez les comptes potentiellement compromis
   - Repérez les utilisateurs à privilèges élevés

2. **Activité des utilisateurs**
   - Examinez les actions effectuées par chaque utilisateur
   - Identifiez les comportements anormaux ou suspects
   - Vérifiez les tentatives d'élévation de privilèges

3. **Contexte utilisateur**
   - Consultez le profil et les droits de l'utilisateur
   - Vérifiez l'historique des incidents précédents
   - Examinez les modèles d'activité habituels

## 5.3 Utilisation des filtres et recherches

Les outils de filtrage et de recherche sont essentiels pour gérer efficacement les incidents, particulièrement dans les environnements à fort volume.

### Filtres prédéfinis

Cortex XDR propose plusieurs filtres prédéfinis pour un accès rapide :

![Filtres prédéfinis](/home/ubuntu/cortex_xdr_manuel/images/predefined_filters.png)

*Figure 5.10 : Filtres prédéfinis pour les incidents*

1. **Filtres de sévérité**
   - Critique : Incidents nécessitant une attention immédiate
   - Élevée : Incidents à traiter en priorité
   - Moyenne : Incidents à examiner après les priorités plus élevées
   - Faible : Incidents à faible risque

2. **Filtres de statut**
   - Nouveaux : Incidents récemment détectés, non traités
   - En cours : Incidents en cours d'investigation
   - En attente : Incidents nécessitant des informations supplémentaires
   - Résolus : Incidents traités mais non fermés
   - Fermés : Incidents complètement traités et archivés

3. **Filtres d'assignation**
   - À moi : Incidents qui vous sont assignés
   - Non assignés : Incidents sans propriétaire désigné
   - À mon équipe : Incidents assignés à votre équipe

### Création de filtres personnalisés

Pour des besoins de filtrage plus spécifiques :

![Filtres personnalisés](/home/ubuntu/cortex_xdr_manuel/images/custom_filters.png)

*Figure 5.11 : Création de filtres personnalisés*

1. Cliquez sur **Filtres avancés** pour ouvrir le panneau de filtrage

2. Ajoutez des conditions de filtre :
   - Sélectionnez un champ (ex : type d'incident, endpoint, utilisateur)
   - Choisissez un opérateur (égal à, contient, supérieur à, etc.)
   - Spécifiez la valeur recherchée

3. Combinez plusieurs conditions :
   - Utilisez "ET" pour des conditions qui doivent toutes être remplies
   - Utilisez "OU" pour des conditions alternatives

4. Enregistrez votre filtre personnalisé :
   - Cliquez sur "Enregistrer comme vue"
   - Donnez un nom descriptif à votre filtre
   - Choisissez s'il sera privé ou partagé avec l'équipe

### Recherche avancée

La fonction de recherche avancée permet de trouver rapidement des incidents spécifiques :

![Recherche avancée](/home/ubuntu/cortex_xdr_manuel/images/advanced_search.png)

*Figure 5.12 : Utilisation de la recherche avancée*

1. **Syntaxe de base**
   - Recherche simple : saisissez des mots-clés (ex : "ransomware")
   - Recherche exacte : utilisez des guillemets (ex : "Emotet infection")
   - Opérateurs booléens : AND, OR, NOT (ex : "ransomware NOT test")

2. **Recherche par champ**
   - Utilisez la syntaxe champ:valeur (ex : "severity:high")
   - Combinez plusieurs champs (ex : "severity:high AND host:server01")
   - Utilisez des caractères génériques (ex : "user:admin*")

3. **Exemples pratiques**
   - Incidents critiques non résolus : "severity:critical AND NOT status:closed"
   - Incidents de ransomware récents : "type:ransomware AND detection_time:[now-7d TO now]"
   - Incidents affectant des serveurs : "host:*server* OR host:*srv*"

## 5.4 Actions de réponse disponibles

Cortex XDR offre de nombreuses options pour répondre aux incidents et remédier aux menaces détectées.

### Actions de base

![Actions de base](/home/ubuntu/cortex_xdr_manuel/images/basic_actions.png)

*Figure 5.13 : Actions de base pour la gestion des incidents*

1. **Gestion du statut**
   - Marquer comme "En cours" lorsque vous commencez l'investigation
   - Passer à "En attente" si des informations supplémentaires sont nécessaires
   - Marquer comme "Résolu" une fois la remédiation effectuée
   - Fermer l'incident lorsque toutes les actions sont terminées

2. **Assignation**
   - Assigner l'incident à vous-même ou à un collègue
   - Transférer à une équipe spécialisée si nécessaire
   - Définir une priorité d'intervention

3. **Documentation**
   - Ajouter des notes et commentaires
   - Joindre des fichiers ou captures d'écran pertinents
   - Documenter les actions entreprises et leurs résultats

### Actions de remédiation sur les endpoints

Pour répondre directement aux menaces sur les endpoints affectés :

![Actions de remédiation](/home/ubuntu/cortex_xdr_manuel/images/remediation_actions.png)

*Figure 5.14 : Actions de remédiation disponibles*

1. **Isolation réseau**
   - Isoler un endpoint du réseau tout en maintenant la connexion à Cortex XDR
   - Empêcher la propagation latérale des menaces
   - Permettre l'investigation à distance sans risque de contamination

2. **Actions sur les fichiers**
   - Mettre en quarantaine les fichiers malveillants
   - Supprimer définitivement les fichiers dangereux
   - Restaurer des fichiers mis en quarantaine par erreur

3. **Actions sur les processus**
   - Terminer les processus malveillants en cours d'exécution
   - Bloquer l'exécution future de processus spécifiques
   - Analyser la chaîne de processus pour identifier la source

4. **Actions sur le registre (Windows)**
   - Supprimer les clés de registre malveillantes
   - Restaurer des clés modifiées
   - Bloquer les modifications futures de clés sensibles

### Exécution d'actions à distance

Pour effectuer des actions plus avancées sur les endpoints :

![Actions à distance](/home/ubuntu/cortex_xdr_manuel/images/remote_actions.png)

*Figure 5.15 : Exécution d'actions à distance*

1. **Collecte de preuves**
   - Récupérer des fichiers spécifiques pour analyse
   - Capturer la mémoire vive pour analyse forensique
   - Collecter les journaux système et d'application

2. **Exécution de scripts**
   - Lancer des scripts de diagnostic personnalisés
   - Exécuter des outils d'analyse spécifiques
   - Déployer des correctifs ou configurations

3. **Actions de récupération**
   - Restaurer des fichiers depuis des sauvegardes
   - Réinitialiser des paramètres système
   - Déployer des correctifs de sécurité

### Intégration avec les workflows de réponse

Cortex XDR s'intègre avec des workflows de réponse automatisés :

![Workflows de réponse](/home/ubuntu/cortex_xdr_manuel/images/response_workflows.png)

*Figure 5.16 : Intégration avec les workflows de réponse*

1. **Playbooks automatisés**
   - Déclencher des playbooks prédéfinis pour des types d'incidents spécifiques
   - Suivre la progression des actions automatisées
   - Intervenir manuellement si nécessaire

2. **Intégration SOAR**
   - Connecter l'incident à une plateforme SOAR
   - Orchestrer des actions complexes multi-systèmes
   - Suivre le workflow de bout en bout

3. **Escalade et notification**
   - Configurer des règles d'escalade basées sur la sévérité ou le temps écoulé
   - Notifier automatiquement les parties prenantes
   - Générer des tickets dans les systèmes de gestion des services

## 5.5 Documentation et clôture d'incidents

Une documentation appropriée et un processus de clôture structuré sont essentiels pour une gestion efficace des incidents.

### Documentation continue

![Documentation d'incident](/home/ubuntu/cortex_xdr_manuel/images/incident_documentation.png)

*Figure 5.17 : Interface de documentation des incidents*

1. **Ajout de notes**
   - Documentez chaque étape de l'investigation
   - Enregistrez les observations importantes
   - Notez les décisions prises et leur justification

2. **Chronologie des actions**
   - Consignez toutes les actions entreprises avec horodatage
   - Documentez les résultats de chaque action
   - Créez une trace d'audit complète

3. **Pièces jointes**
   - Ajoutez des captures d'écran pertinentes
   - Joignez des rapports d'analyse
   - Incluez des références à des menaces similaires

### Rapport d'incident

Pour une documentation formelle de l'incident :

![Rapport d'incident](/home/ubuntu/cortex_xdr_manuel/images/incident_report.png)

*Figure 5.18 : Génération d'un rapport d'incident*

1. **Génération du rapport**
   - Cliquez sur "Générer un rapport" dans la page de l'incident
   - Sélectionnez le modèle de rapport approprié
   - Choisissez les sections à inclure

2. **Contenu du rapport**
   - Résumé exécutif
   - Chronologie détaillée
   - Indicateurs de compromission (IOCs)
   - Actions de remédiation entreprises
   - Recommandations pour éviter des incidents similaires

3. **Distribution du rapport**
   - Exportez au format PDF ou HTML
   - Partagez avec les parties prenantes concernées
   - Archivez pour référence future

### Processus de clôture

Une procédure structurée pour clôturer correctement un incident :

![Clôture d'incident](/home/ubuntu/cortex_xdr_manuel/images/incident_closure.png)

*Figure 5.19 : Processus de clôture d'incident*

1. **Vérification pré-clôture**
   - Confirmez que toutes les actions de remédiation sont terminées
   - Vérifiez qu'aucune trace de la menace ne persiste
   - Assurez-vous que tous les systèmes affectés sont sécurisés

2. **Formulaire de clôture**
   - Remplissez le formulaire de clôture d'incident
   - Catégorisez l'incident final (peut différer de la classification initiale)
   - Évaluez l'impact réel sur l'organisation
   - Documentez les leçons apprises

3. **Approbation de clôture**
   - Soumettez l'incident pour approbation si nécessaire
   - Obtenez la validation du responsable de sécurité
   - Enregistrez la décision finale

### Analyse post-incident

Pour tirer des enseignements et améliorer les processus :

![Analyse post-incident](/home/ubuntu/cortex_xdr_manuel/images/post_incident_analysis.png)

*Figure 5.20 : Interface d'analyse post-incident*

1. **Réunion de débriefing**
   - Organisez une réunion avec toutes les parties impliquées
   - Passez en revue la chronologie et les actions entreprises
   - Discutez de ce qui a bien fonctionné et des points à améliorer

2. **Mise à jour des défenses**
   - Créez de nouvelles règles de détection basées sur l'incident
   - Mettez à jour les politiques de sécurité si nécessaire
   - Renforcez les contrôles préventifs

3. **Métriques et KPIs**
   - Enregistrez les métriques clés (temps de détection, temps de réponse, etc.)
   - Comparez avec les incidents précédents pour mesurer l'amélioration
   - Utilisez ces données pour optimiser les processus futurs
# 6. Investigation des Alertes - Guide Visuel

## 6.1 Interface d'investigation des alertes

L'investigation des alertes est une fonction essentielle de Cortex XDR, permettant d'analyser en détail les alertes de sécurité avant qu'elles ne soient corrélées en incidents. Cette section présente l'interface d'investigation des alertes et son utilisation efficace.

![Interface d'investigation des alertes](/home/ubuntu/cortex_xdr_manuel/images/alerts_investigation_interface.png)

*Figure 6.1 : Vue d'ensemble de l'interface d'investigation des alertes avec annotations*

### Éléments clés de l'interface

1. **Barre de filtres supérieure**
   - Filtres de période temporelle
   - Filtres de sévérité (Critique, Élevée, Moyenne, Faible)
   - Filtres de statut (Nouvelle, En cours, Résolue, Faux positif)
   - Filtres de type d'alerte

2. **Liste des alertes**
   - ID unique de l'alerte
   - Description concise
   - Indicateur de sévérité (code couleur)
   - Horodatage de détection
   - Source de l'alerte (endpoint, réseau, cloud, etc.)
   - Endpoint ou utilisateur concerné
   - Statut de l'alerte

3. **Panneau de prévisualisation**
   - Aperçu rapide de l'alerte sélectionnée
   - Détails techniques
   - Actions disponibles
   - Lien vers l'incident parent (si applicable)

4. **Barre d'actions**
   - Boutons d'action rapide (Investiguer, Marquer comme faux positif, etc.)
   - Options d'exportation et de partage
   - Paramètres d'affichage

### Navigation dans la liste des alertes

![Navigation des alertes](/home/ubuntu/cortex_xdr_manuel/images/alerts_navigation.png)

*Figure 6.2 : Options de navigation dans la liste des alertes*

1. **Tri des alertes**
   - Cliquez sur l'en-tête de colonne pour trier par ce critère
   - Cliquez à nouveau pour inverser l'ordre (ascendant/descendant)
   - Utilisez le menu déroulant "Trier par" pour des options supplémentaires

2. **Filtrage avancé**
   - Cliquez sur "Filtres avancés" pour ouvrir le panneau de filtrage
   - Combinez plusieurs critères avec des opérateurs logiques (ET/OU)
   - Enregistrez vos filtres personnalisés pour une utilisation future

3. **Recherche rapide**
   - Utilisez la barre de recherche pour trouver des alertes spécifiques
   - Recherchez par ID, description, nom d'hôte, utilisateur, etc.
   - Utilisez des opérateurs spéciaux pour affiner la recherche

4. **Vues personnalisées**
   - Créez des vues personnalisées avec des filtres prédéfinis
   - Accédez rapidement à vos vues via le menu déroulant
   - Partagez vos vues avec d'autres membres de l'équipe

## 6.2 Processus de triage des alertes

Le triage efficace des alertes est essentiel pour identifier rapidement celles qui nécessitent une attention immédiate. Voici un guide étape par étape pour trier efficacement les alertes dans Cortex XDR.

### Évaluation initiale des alertes

![Triage des alertes](/home/ubuntu/cortex_xdr_manuel/images/alert_triage.png)

*Figure 6.3 : Interface de triage des alertes*

1. **Priorisation par sévérité**
   - Commencez par les alertes critiques (rouge)
   - Passez ensuite aux alertes de sévérité élevée (orange)
   - Traitez les alertes moyennes et faibles selon le temps disponible

2. **Évaluation du contexte**
   - Identifiez l'endpoint ou l'utilisateur concerné
   - Vérifiez si l'alerte fait partie d'un incident plus large
   - Tenez compte de la criticité de l'asset affecté

3. **Vérification rapide**
   - Consultez la description et le type d'alerte
   - Examinez les indicateurs de compromission (IOCs)
   - Vérifiez si des alertes similaires ont déjà été traitées

### Workflow de triage recommandé

Pour un triage efficace et cohérent des alertes :

![Workflow de triage](/home/ubuntu/cortex_xdr_manuel/images/triage_workflow.png)

*Figure 6.4 : Workflow recommandé pour le triage des alertes*

1. **Étape 1 : Évaluation initiale**
   - Examinez la sévérité et la description
   - Vérifiez la source de l'alerte
   - Identifiez les systèmes et utilisateurs affectés

2. **Étape 2 : Catégorisation**
   - Classez l'alerte par type de menace
   - Déterminez s'il s'agit d'une menace connue ou nouvelle
   - Évaluez le potentiel impact sur l'organisation

3. **Étape 3 : Assignation**
   - Prenez en charge l'alerte ou assignez-la à un collègue
   - Définissez une priorité d'investigation
   - Ajoutez des notes initiales si nécessaire

4. **Étape 4 : Action immédiate ou mise en file d'attente**
   - Décidez si une action immédiate est nécessaire
   - Pour les alertes critiques, commencez l'investigation immédiatement
   - Pour les alertes moins urgentes, placez-les dans la file d'attente appropriée

### Gestion des files d'attente d'alertes

Pour gérer efficacement un grand volume d'alertes :

![Files d'attente d'alertes](/home/ubuntu/cortex_xdr_manuel/images/alert_queues.png)

*Figure 6.5 : Gestion des files d'attente d'alertes*

1. **Configuration des files d'attente**
   - Créez des files d'attente basées sur la sévérité, le type ou l'équipe
   - Définissez des règles d'assignation automatique
   - Configurez des SLAs pour chaque file d'attente

2. **Surveillance des files d'attente**
   - Vérifiez régulièrement l'état des files d'attente
   - Identifiez les goulots d'étranglement
   - Réassignez les alertes si nécessaire

3. **Métriques de performance**
   - Suivez le temps moyen de traitement par alerte
   - Mesurez le taux de faux positifs
   - Évaluez l'efficacité du processus de triage

## 6.3 Analyse des détails d'une alerte

Une fois qu'une alerte a été identifiée comme nécessitant une investigation, une analyse approfondie est requise. Voici comment explorer en détail une alerte dans Cortex XDR.

### Accès aux détails de l'alerte

1. Dans la liste des alertes, cliquez sur l'alerte que vous souhaitez analyser
   
   ![Sélection d'alerte](/home/ubuntu/cortex_xdr_manuel/images/alert_selection.png)
   
   *Figure 6.6 : Sélection d'une alerte dans la liste*

2. La page de détails de l'alerte s'ouvre, présentant toutes les informations pertinentes
   
   ![Page de détails d'alerte](/home/ubuntu/cortex_xdr_manuel/images/alert_details.png)
   
   *Figure 6.7 : Page de détails d'une alerte*

### Compréhension du résumé de l'alerte

La section de résumé fournit un aperçu rapide de l'alerte :

![Résumé d'alerte](/home/ubuntu/cortex_xdr_manuel/images/alert_summary.png)

*Figure 6.8 : Section de résumé d'alerte*

1. **Informations générales**
   - ID et nom de l'alerte
   - Sévérité et score de risque
   - Date et heure de détection
   - Statut actuel

2. **Détails techniques**
   - Type d'alerte (malware, exploit, comportement suspect, etc.)
   - Règle ou moteur de détection déclenché
   - Techniques MITRE ATT&CK identifiées
   - Indicateurs de compromission (IOCs)

3. **Contexte**
   - Endpoint ou ressource affectée
   - Utilisateur concerné
   - Application ou processus impliqué
   - Incident parent (si l'alerte a été corrélée)

### Analyse des preuves et artefacts

Examinez en détail les preuves associées à l'alerte :

![Preuves et artefacts](/home/ubuntu/cortex_xdr_manuel/images/alert_artifacts.png)

*Figure 6.9 : Section des preuves et artefacts*

1. **Fichiers impliqués**
   - Nom et chemin du fichier
   - Hash (MD5, SHA1, SHA256)
   - Taille et type de fichier
   - Réputation et prévalence

2. **Processus**
   - Ligne de commande complète
   - Processus parent
   - Processus enfants
   - Durée d'exécution

3. **Connexions réseau**
   - Adresses IP source et destination
   - Ports utilisés
   - Protocole
   - Volume de données transférées

4. **Registre (Windows)**
   - Clés de registre modifiées
   - Valeurs avant/après modification
   - Persistance établie

### Analyse du contexte de l'alerte

Pour comprendre le contexte complet de l'alerte :

![Contexte d'alerte](/home/ubuntu/cortex_xdr_manuel/images/alert_context.png)

*Figure 6.10 : Analyse du contexte de l'alerte*

1. **Chronologie des événements**
   - Événements précédant l'alerte
   - Action déclenchant l'alerte
   - Événements suivant l'alerte
   - Corrélation temporelle avec d'autres activités

2. **Contexte de l'endpoint**
   - État de l'endpoint au moment de l'alerte
   - Autres processus en cours d'exécution
   - Utilisateurs connectés
   - Vulnérabilités connues

3. **Contexte utilisateur**
   - Comportement habituel de l'utilisateur
   - Autorisations et accès
   - Activités récentes
   - Alertes précédentes impliquant cet utilisateur

### Visualisation avancée

Cortex XDR offre des outils de visualisation avancés pour mieux comprendre les alertes :

![Visualisations avancées](/home/ubuntu/cortex_xdr_manuel/images/alert_visualizations.png)

*Figure 6.11 : Outils de visualisation avancée*

1. **Graphe de processus**
   - Visualisation de la chaîne d'exécution des processus
   - Relations parent-enfant
   - Points d'injection ou de pivot
   - Activités suspectes mises en évidence

2. **Chronologie interactive**
   - Visualisation temporelle des événements
   - Zoom sur des périodes spécifiques
   - Filtrage par type d'événement
   - Marqueurs pour les actions critiques

3. **Carte réseau**
   - Visualisation des connexions réseau
   - Flux de données entre endpoints
   - Communications externes suspectes
   - Mouvements latéraux potentiels

## 6.4 Corrélation entre alertes

La corrélation entre alertes est essentielle pour identifier les campagnes d'attaque plus larges et comprendre la portée complète d'une menace.

### Identification des alertes liées

Pour découvrir les relations entre différentes alertes :

![Alertes liées](/home/ubuntu/cortex_xdr_manuel/images/related_alerts.png)

*Figure 6.12 : Identification des alertes liées*

1. **Alertes sur le même endpoint**
   - Consultez toutes les alertes récentes sur l'endpoint concerné
   - Identifiez les modèles ou séquences d'attaque
   - Vérifiez si des alertes similaires ont été déclenchées précédemment

2. **Alertes impliquant les mêmes IOCs**
   - Recherchez d'autres alertes avec les mêmes hashes de fichiers
   - Identifiez les alertes partageant les mêmes adresses IP ou domaines
   - Vérifiez les alertes avec des lignes de commande ou arguments similaires

3. **Alertes temporellement proches**
   - Examinez les alertes déclenchées dans une fenêtre temporelle proche
   - Identifiez les séquences d'événements suspects
   - Recherchez des modèles de propagation

### Utilisation de la vue d'incident

Si des alertes ont déjà été corrélées en incident :

![Vue d'incident](/home/ubuntu/cortex_xdr_manuel/images/incident_view_from_alert.png)

*Figure 6.13 : Accès à la vue d'incident depuis une alerte*

1. **Navigation vers l'incident parent**
   - Cliquez sur le lien "Incident associé" dans les détails de l'alerte
   - Visualisez toutes les alertes corrélées dans l'incident
   - Comprenez la portée complète de l'attaque

2. **Analyse de la corrélation**
   - Examinez les critères de corrélation utilisés
   - Vérifiez la chronologie complète de l'incident
   - Identifiez le point d'entrée initial et la propagation

3. **Alertes potentiellement manquantes**
   - Recherchez d'autres activités suspectes non corrélées
   - Vérifiez si des alertes de faible sévérité pourraient être liées
   - Suggérez des améliorations aux règles de corrélation si nécessaire

### Recherche proactive de corrélations

Pour identifier des corrélations que le système n'a pas automatiquement détectées :

![Recherche de corrélations](/home/ubuntu/cortex_xdr_manuel/images/correlation_search.png)

*Figure 6.14 : Recherche proactive de corrélations*

1. **Utilisation de la recherche avancée**
   - Recherchez des alertes partageant des caractéristiques communes
   - Utilisez des requêtes XQL pour identifier des modèles complexes
   - Créez des filtres personnalisés pour isoler des groupes d'alertes potentiellement liées

2. **Analyse temporelle**
   - Créez une chronologie personnalisée des alertes suspectes
   - Identifiez les pics d'activité anormale
   - Recherchez des séquences d'événements caractéristiques de certaines attaques

3. **Analyse par technique**
   - Groupez les alertes par technique MITRE ATT&CK
   - Identifiez les combinaisons de techniques typiques de certains acteurs malveillants
   - Recherchez la progression tactique (reconnaissance, accès initial, mouvement latéral, etc.)

## 6.5 Actions et remédiation

Une fois l'alerte analysée, diverses actions peuvent être entreprises pour y répondre efficacement.

### Actions rapides disponibles

Cortex XDR propose plusieurs actions rapides directement depuis l'interface d'alerte :

![Actions rapides](/home/ubuntu/cortex_xdr_manuel/images/alert_quick_actions.png)

*Figure 6.15 : Actions rapides disponibles pour les alertes*

1. **Changement de statut**
   - Marquer comme "En cours" lorsque vous commencez l'investigation
   - Marquer comme "Résolue" une fois traitée
   - Marquer comme "Faux positif" si l'alerte est incorrecte

2. **Actions sur les artefacts**
   - Ajouter un fichier à la liste noire
   - Mettre un fichier en quarantaine
   - Terminer un processus
   - Bloquer une adresse IP ou un domaine

3. **Escalade**
   - Créer un incident à partir de l'alerte
   - Ajouter l'alerte à un incident existant
   - Assigner l'alerte à un autre analyste

### Processus de validation

Pour valider correctement une alerte :

![Validation d'alerte](/home/ubuntu/cortex_xdr_manuel/images/alert_validation.png)

*Figure 6.16 : Processus de validation d'alerte*

1. **Confirmation de la menace**
   - Vérifiez que l'alerte correspond à une menace réelle
   - Confirmez que les indicateurs sont malveillants
   - Évaluez l'impact potentiel

2. **Identification des faux positifs**
   - Déterminez si l'activité est légitime
   - Documentez la raison du faux positif
   - Suggérez des ajustements aux règles de détection

3. **Documentation**
   - Ajoutez des notes détaillant votre analyse
   - Documentez les preuves examinées
   - Justifiez votre conclusion

### Actions de remédiation

Pour répondre aux alertes confirmées comme malveillantes :

![Actions de remédiation](/home/ubuntu/cortex_xdr_manuel/images/alert_remediation.png)

*Figure 6.17 : Actions de remédiation pour les alertes*

1. **Actions immédiates**
   - Isoler l'endpoint affecté
   - Bloquer les communications avec des domaines malveillants
   - Mettre en quarantaine ou supprimer les fichiers malveillants
   - Terminer les processus malveillants

2. **Actions de suivi**
   - Analyser d'autres systèmes pour détecter la même menace
   - Mettre à jour les signatures et règles de détection
   - Appliquer des correctifs si la menace exploite une vulnérabilité

3. **Documentation et rapport**
   - Documentez toutes les actions entreprises
   - Enregistrez les résultats de la remédiation
   - Créez un rapport pour les parties prenantes si nécessaire

### Amélioration continue

Utilisez les alertes pour améliorer vos défenses :

![Amélioration continue](/home/ubuntu/cortex_xdr_manuel/images/continuous_improvement.png)

*Figure 6.18 : Processus d'amélioration continue*

1. **Analyse des tendances**
   - Identifiez les types d'alertes les plus fréquents
   - Repérez les systèmes générant le plus d'alertes
   - Analysez les taux de faux positifs par type d'alerte

2. **Ajustement des règles**
   - Affinez les règles générant trop de faux positifs
   - Créez de nouvelles règles pour détecter des variantes de menaces
   - Ajustez les seuils de sévérité en fonction de l'expérience

3. **Formation et sensibilisation**
   - Utilisez les alertes réelles comme cas d'étude pour la formation
   - Partagez les connaissances sur les nouvelles menaces détectées
   - Documentez les procédures de réponse efficaces
# 7. Analyse des Endpoints - Guide Visuel

## 7.1 Vue d'ensemble des endpoints

Le module d'analyse des endpoints de Cortex XDR permet de surveiller, d'analyser et de gérer tous les endpoints protégés dans votre environnement. Cette section présente en détail l'interface de gestion des endpoints et son utilisation efficace.

![Vue d'ensemble des endpoints](/home/ubuntu/cortex_xdr_manuel/images/endpoints_overview.png)

*Figure 7.1 : Vue d'ensemble de l'interface de gestion des endpoints avec annotations*

### Éléments clés de l'interface

1. **Barre de filtres supérieure**
   - Filtres de groupe d'endpoints
   - Filtres de système d'exploitation
   - Filtres de statut de connexion
   - Filtres de version d'agent

2. **Liste des endpoints**
   - Nom de l'endpoint
   - Système d'exploitation et version
   - Adresse IP
   - Statut de connexion (connecté/déconnecté)
   - Version de l'agent
   - Groupe d'endpoints
   - Dernière connexion

3. **Panneau de prévisualisation**
   - Aperçu rapide de l'endpoint sélectionné
   - Informations système
   - Statut de protection
   - Alertes récentes
   - Actions disponibles

4. **Barre d'actions**
   - Boutons d'action rapide (Isoler, Scanner, Mettre à jour, etc.)
   - Options d'exportation et de filtrage
   - Paramètres d'affichage

### Navigation dans la liste des endpoints

![Navigation des endpoints](/home/ubuntu/cortex_xdr_manuel/images/endpoints_navigation.png)

*Figure 7.2 : Options de navigation dans la liste des endpoints*

1. **Tri des endpoints**
   - Cliquez sur l'en-tête de colonne pour trier par ce critère
   - Cliquez à nouveau pour inverser l'ordre (ascendant/descendant)
   - Utilisez le menu déroulant "Trier par" pour des options supplémentaires

2. **Filtrage avancé**
   - Cliquez sur "Filtres avancés" pour ouvrir le panneau de filtrage
   - Combinez plusieurs critères avec des opérateurs logiques (ET/OU)
   - Enregistrez vos filtres personnalisés pour une utilisation future

3. **Recherche rapide**
   - Utilisez la barre de recherche pour trouver des endpoints spécifiques
   - Recherchez par nom d'hôte, adresse IP, utilisateur, etc.
   - Utilisez des opérateurs spéciaux pour affiner la recherche

4. **Vues personnalisées**
   - Créez des vues personnalisées avec des filtres prédéfinis
   - Accédez rapidement à vos vues via le menu déroulant
   - Partagez vos vues avec d'autres membres de l'équipe

## 7.2 Analyse détaillée d'un endpoint

Pour examiner en profondeur un endpoint spécifique, Cortex XDR offre une vue détaillée complète.

### Accès aux détails de l'endpoint

1. Dans la liste des endpoints, cliquez sur l'endpoint que vous souhaitez analyser
   
   ![Sélection d'endpoint](/home/ubuntu/cortex_xdr_manuel/images/endpoint_selection.png)
   
   *Figure 7.3 : Sélection d'un endpoint dans la liste*

2. La page de détails de l'endpoint s'ouvre, présentant toutes les informations pertinentes
   
   ![Page de détails d'endpoint](/home/ubuntu/cortex_xdr_manuel/images/endpoint_details.png)
   
   *Figure 7.4 : Page de détails d'un endpoint*

### Informations système

La section d'informations système fournit des détails techniques sur l'endpoint :

![Informations système](/home/ubuntu/cortex_xdr_manuel/images/endpoint_system_info.png)

*Figure 7.5 : Section d'informations système*

1. **Informations générales**
   - Nom de l'endpoint
   - Système d'exploitation et version
   - Architecture matérielle
   - Date d'installation

2. **Réseau**
   - Adresse IP (interne et externe)
   - Adresse MAC
   - Nom de domaine
   - Interfaces réseau

3. **Matériel**
   - Fabricant et modèle
   - Processeur et mémoire
   - Espace disque
   - Périphériques connectés

4. **Utilisateurs**
   - Comptes utilisateurs locaux
   - Dernières connexions
   - Privilèges administratifs

### Statut de protection

Cette section présente l'état des différentes protections sur l'endpoint :

![Statut de protection](/home/ubuntu/cortex_xdr_manuel/images/endpoint_protection_status.png)

*Figure 7.6 : Section de statut de protection*

1. **Agent Cortex XDR**
   - Version de l'agent
   - Statut de connexion
   - Dernière mise à jour
   - Modules actifs

2. **Protections actives**
   - Anti-malware (statut et dernière mise à jour)
   - Anti-exploit (statut et mode)
   - Pare-feu local (statut et règles actives)
   - Contrôle des périphériques (statut et politique)

3. **Politiques appliquées**
   - Politique de sécurité active
   - Exceptions configurées
   - Dernière mise à jour de politique
   - Conformité aux politiques

4. **Statut de santé**
   - Problèmes détectés
   - Recommandations
   - Historique des problèmes

### Historique des alertes et incidents

Consultez l'historique des alertes et incidents liés à cet endpoint :

![Historique des alertes](/home/ubuntu/cortex_xdr_manuel/images/endpoint_alerts_history.png)

*Figure 7.7 : Historique des alertes et incidents*

1. **Alertes récentes**
   - Liste des alertes déclenchées sur cet endpoint
   - Sévérité et type
   - Horodatage
   - Statut de résolution

2. **Incidents associés**
   - Incidents incluant cet endpoint
   - Sévérité et impact
   - Chronologie
   - Actions entreprises

3. **Tendances**
   - Graphique d'activité des alertes dans le temps
   - Types d'alertes les plus fréquents
   - Comparaison avec la moyenne des autres endpoints

### Logiciels installés

Examinez les logiciels installés sur l'endpoint :

![Logiciels installés](/home/ubuntu/cortex_xdr_manuel/images/endpoint_installed_software.png)

*Figure 7.8 : Section des logiciels installés*

1. **Liste des applications**
   - Nom et version
   - Éditeur
   - Date d'installation
   - Taille

2. **Mises à jour et correctifs**
   - Mises à jour du système d'exploitation
   - Correctifs de sécurité
   - Mises à jour en attente
   - Historique des mises à jour

3. **Vulnérabilités**
   - Vulnérabilités détectées dans les logiciels
   - Niveau de risque
   - Disponibilité de correctifs
   - Recommandations

## 7.3 Recherche et filtrage des endpoints

La gestion efficace d'un grand nombre d'endpoints nécessite des outils de recherche et de filtrage puissants.

### Filtres prédéfinis

Cortex XDR propose plusieurs filtres prédéfinis pour un accès rapide :

![Filtres prédéfinis](/home/ubuntu/cortex_xdr_manuel/images/endpoint_predefined_filters.png)

*Figure 7.9 : Filtres prédéfinis pour les endpoints*

1. **Filtres de statut**
   - Connectés : Endpoints actuellement en ligne
   - Déconnectés : Endpoints hors ligne
   - Problématiques : Endpoints avec des problèmes de protection
   - Isolés : Endpoints en isolation réseau

2. **Filtres de système d'exploitation**
   - Windows (par version)
   - macOS (par version)
   - Linux (par distribution)
   - Mobile (iOS/Android)

3. **Filtres de groupe**
   - Par groupe d'endpoints configuré
   - Par unité organisationnelle
   - Par emplacement géographique
   - Par fonction (serveurs, postes de travail, etc.)

### Création de filtres personnalisés

Pour des besoins de filtrage plus spécifiques :

![Filtres personnalisés](/home/ubuntu/cortex_xdr_manuel/images/endpoint_custom_filters.png)

*Figure 7.10 : Création de filtres personnalisés*

1. Cliquez sur **Filtres avancés** pour ouvrir le panneau de filtrage

2. Ajoutez des conditions de filtre :
   - Sélectionnez un champ (ex : version d'agent, adresse IP, groupe)
   - Choisissez un opérateur (égal à, contient, supérieur à, etc.)
   - Spécifiez la valeur recherchée

3. Combinez plusieurs conditions :
   - Utilisez "ET" pour des conditions qui doivent toutes être remplies
   - Utilisez "OU" pour des conditions alternatives

4. Enregistrez votre filtre personnalisé :
   - Cliquez sur "Enregistrer comme vue"
   - Donnez un nom descriptif à votre filtre
   - Choisissez s'il sera privé ou partagé avec l'équipe

### Recherche avancée

La fonction de recherche avancée permet de trouver rapidement des endpoints spécifiques :

![Recherche avancée](/home/ubuntu/cortex_xdr_manuel/images/endpoint_advanced_search.png)

*Figure 7.11 : Utilisation de la recherche avancée*

1. **Syntaxe de base**
   - Recherche simple : saisissez des mots-clés (ex : "laptop")
   - Recherche exacte : utilisez des guillemets (ex : "finance-laptop-01")
   - Opérateurs booléens : AND, OR, NOT (ex : "windows AND server NOT test")

2. **Recherche par champ**
   - Utilisez la syntaxe champ:valeur (ex : "os:windows")
   - Combinez plusieurs champs (ex : "os:windows AND group:finance")
   - Utilisez des caractères génériques (ex : "hostname:srv*")

3. **Exemples pratiques**
   - Endpoints Windows sans mise à jour récente : "os:windows AND last_update:<30d"
   - Serveurs avec une version spécifique d'agent : "type:server AND agent_version:7.4.*"
   - Endpoints dans un sous-réseau particulier : "ip:192.168.1.*"

## 7.4 Actions disponibles sur les endpoints

Cortex XDR offre de nombreuses actions pour gérer et sécuriser les endpoints à distance.

### Actions de base

![Actions de base](/home/ubuntu/cortex_xdr_manuel/images/endpoint_basic_actions.png)

*Figure 7.12 : Actions de base sur les endpoints*

1. **Actualiser les informations**
   - Mettez à jour les informations de l'endpoint en temps réel
   - Vérifiez le statut de connexion actuel
   - Récupérez les dernières données de configuration

2. **Redémarrer l'agent**
   - Redémarrez le service de l'agent Cortex XDR
   - Résolvez les problèmes de fonctionnement de l'agent
   - Appliquez les changements de configuration

3. **Redémarrer l'endpoint**
   - Planifiez un redémarrage de l'endpoint
   - Définissez un délai avant redémarrage
   - Envoyez une notification à l'utilisateur

### Actions de sécurité

Pour répondre aux menaces ou renforcer la sécurité :

![Actions de sécurité](/home/ubuntu/cortex_xdr_manuel/images/endpoint_security_actions.png)

*Figure 7.13 : Actions de sécurité sur les endpoints*

1. **Isolation réseau**
   - Isolez l'endpoint du réseau tout en maintenant la connexion à Cortex XDR
   - Empêchez la propagation latérale des menaces
   - Permettez l'investigation à distance sans risque de contamination
   - Restaurez la connectivité normale une fois la menace neutralisée

2. **Analyse antivirus**
   - Lancez une analyse complète ou rapide
   - Planifiez l'analyse à un moment précis
   - Définissez les paramètres d'analyse (profondeur, exclusions, etc.)
   - Consultez les résultats de l'analyse

3. **Mise en quarantaine de fichiers**
   - Mettez en quarantaine les fichiers malveillants détectés
   - Restaurez des fichiers mis en quarantaine par erreur
   - Consultez l'historique des fichiers mis en quarantaine
   - Soumettez des fichiers suspects pour analyse

### Actions de maintenance

Pour la gestion et la maintenance des endpoints :

![Actions de maintenance](/home/ubuntu/cortex_xdr_manuel/images/endpoint_maintenance_actions.png)

*Figure 7.14 : Actions de maintenance sur les endpoints*

1. **Mise à jour de l'agent**
   - Vérifiez les mises à jour disponibles
   - Déployez la dernière version de l'agent
   - Planifiez la mise à jour à un moment opportun
   - Suivez la progression de la mise à jour

2. **Gestion des politiques**
   - Appliquez une politique de sécurité spécifique
   - Vérifiez la conformité aux politiques
   - Créez des exceptions temporaires
   - Synchronisez les politiques

3. **Collecte de journaux**
   - Récupérez les journaux de diagnostic de l'agent
   - Collectez les journaux système pertinents
   - Définissez la période de collecte
   - Téléchargez les journaux pour analyse

### Actions avancées

Pour les opérations plus complexes :

![Actions avancées](/home/ubuntu/cortex_xdr_manuel/images/endpoint_advanced_actions.png)

*Figure 7.15 : Actions avancées sur les endpoints*

1. **Exécution de scripts**
   - Exécutez des scripts personnalisés sur l'endpoint
   - Choisissez parmi une bibliothèque de scripts prédéfinis
   - Visualisez les résultats d'exécution
   - Planifiez l'exécution récurrente

2. **Collecte de preuves**
   - Récupérez des fichiers spécifiques pour analyse
   - Capturez la mémoire vive pour analyse forensique
   - Collectez les artefacts système pertinents
   - Préservez l'intégrité des preuves

3. **Déploiement de correctifs**
   - Vérifiez les correctifs manquants
   - Déployez des correctifs de sécurité critiques
   - Planifiez l'installation des correctifs
   - Vérifiez l'application réussie des correctifs

## 7.5 Gestion des groupes d'endpoints

La gestion par groupes permet d'organiser et d'administrer efficacement un grand nombre d'endpoints.

### Création et configuration de groupes

Pour organiser vos endpoints en groupes logiques :

![Création de groupes](/home/ubuntu/cortex_xdr_manuel/images/endpoint_group_creation.png)

*Figure 7.16 : Création et configuration de groupes d'endpoints*

1. **Accès à la gestion des groupes**
   - Naviguez vers "Paramètres" > "Gestion des endpoints"
   - Sélectionnez l'onglet "Groupes d'endpoints"
   - Cliquez sur "Créer un groupe"

2. **Configuration du groupe**
   - Nom du groupe : Donnez un nom descriptif
   - Description : Ajoutez des détails sur l'objectif du groupe
   - Groupe parent : Définissez une hiérarchie si nécessaire
   - Icône : Choisissez une icône distinctive (optionnel)

3. **Critères d'appartenance**
   - Manuelle : Ajoutez des endpoints spécifiques au groupe
   - Dynamique : Définissez des règles d'appartenance automatique
   - Synchronisée : Synchronisez avec des groupes AD/LDAP

### Affectation de politiques par groupe

Pour appliquer des politiques de sécurité spécifiques à chaque groupe :

![Politiques par groupe](/home/ubuntu/cortex_xdr_manuel/images/endpoint_group_policies.png)

*Figure 7.17 : Affectation de politiques par groupe*

1. **Sélection du groupe**
   - Dans la liste des groupes, sélectionnez le groupe cible
   - Cliquez sur "Modifier" ou accédez à l'onglet "Politiques"

2. **Affectation de politique**
   - Sélectionnez la politique de sécurité à appliquer
   - Définissez la priorité en cas de conflits
   - Configurez les exceptions spécifiques au groupe

3. **Héritage de politiques**
   - Configurez l'héritage des politiques du groupe parent
   - Définissez quels paramètres peuvent être remplacés
   - Visualisez la politique effective résultante

### Actions sur plusieurs endpoints

Pour effectuer des actions sur tous les endpoints d'un groupe :

![Actions de groupe](/home/ubuntu/cortex_xdr_manuel/images/endpoint_group_actions.png)

*Figure 7.18 : Actions sur plusieurs endpoints*

1. **Sélection multiple**
   - Filtrez la vue pour afficher le groupe souhaité
   - Utilisez la case à cocher en haut pour sélectionner tous les endpoints
   - Ou sélectionnez manuellement plusieurs endpoints

2. **Actions disponibles**
   - Mise à jour des agents
   - Application d'une politique
   - Analyse antivirus
   - Collecte de journaux
   - Redémarrage des agents

3. **Planification et déploiement**
   - Définissez un calendrier de déploiement
   - Configurez des fenêtres de maintenance
   - Limitez l'impact sur la bande passante
   - Suivez la progression du déploiement

### Rapports et tableaux de bord par groupe

Pour surveiller et analyser les endpoints par groupe :

![Rapports par groupe](/home/ubuntu/cortex_xdr_manuel/images/endpoint_group_reports.png)

*Figure 7.19 : Rapports et tableaux de bord par groupe*

1. **Tableaux de bord dédiés**
   - Accédez aux tableaux de bord filtrés par groupe
   - Visualisez les métriques spécifiques au groupe
   - Comparez les performances entre groupes

2. **Rapports de conformité**
   - Générez des rapports de conformité par groupe
   - Vérifiez l'application des politiques
   - Identifiez les endpoints non conformes

3. **Métriques de sécurité**
   - Analysez les tendances des alertes par groupe
   - Comparez les niveaux de risque
   - Identifiez les groupes nécessitant une attention particulière
# 8. Requêtes XQL - Guide Pratique

## 8.1 Interface de requête XQL

Le langage de requête XQL (XDR Query Language) est un outil puissant de Cortex XDR permettant d'explorer et d'analyser les données de sécurité de manière flexible et approfondie. Cette section présente l'interface de requête XQL et son utilisation.

![Interface de requête XQL](/home/ubuntu/cortex_xdr_manuel/images/xql_interface.png)

*Figure 8.1 : Vue d'ensemble de l'interface de requête XQL avec annotations*

### Éléments clés de l'interface

1. **Éditeur de requête**
   - Zone de saisie de la requête XQL
   - Coloration syntaxique
   - Autocomplétion
   - Vérification de syntaxe en temps réel

2. **Barre d'outils**
   - Bouton d'exécution de requête
   - Sélecteur de période temporelle
   - Options d'enregistrement
   - Boutons de partage et d'export
   - Historique des requêtes

3. **Zone de résultats**
   - Affichage tabulaire des résultats
   - Options de tri et de filtrage
   - Pagination
   - Statistiques d'exécution (temps, volume de données)

4. **Panneau d'aide**
   - Documentation de référence XQL
   - Exemples de requêtes
   - Description des datasets disponibles
   - Aide contextuelle

### Accès à l'interface XQL

Pour accéder à l'interface de requête XQL :

1. Dans le menu principal, cliquez sur **Query**
   
   ![Menu Query](/home/ubuntu/cortex_xdr_manuel/images/xql_menu_access.png)
   
   *Figure 8.2 : Accès au menu Query*

2. Sélectionnez **XQL Query** dans le menu déroulant

3. L'interface de requête XQL s'ouvre, prête à l'utilisation

4. Vous pouvez également y accéder depuis :
   - Un widget de dashboard (via l'option "Modifier la requête")
   - Un lien "Explorer en XQL" dans les détails d'une alerte ou d'un incident
   - La section "Chasse aux menaces" (via l'option "Nouvelle requête")

## 8.2 Construction d'une requête pas à pas

La construction d'une requête XQL efficace suit une approche structurée. Voici un guide étape par étape pour créer vos requêtes.

### Sélection du dataset

La première étape consiste à choisir le dataset approprié :

![Sélection du dataset](/home/ubuntu/cortex_xdr_manuel/images/xql_dataset_selection.png)

*Figure 8.3 : Sélection du dataset dans XQL*

1. **Datasets principaux disponibles**
   - `xdr_data` : Données générales de Cortex XDR (recommandé pour débuter)
   - `endpoint_data` : Données spécifiques aux endpoints
   - `network_data` : Données de trafic réseau
   - `cloud_data` : Données des environnements cloud
   - `audit_data` : Données d'audit et de conformité

2. **Comment sélectionner le dataset**
   - Commencez votre requête par `dataset = nom_du_dataset`
   - Exemple : `dataset = xdr_data`

3. **Explorer les datasets disponibles**
   - Cliquez sur "Datasets" dans le panneau d'aide
   - Consultez la description et les champs disponibles pour chaque dataset
   - Utilisez la recherche pour trouver un dataset spécifique

### Filtrage des données

Après avoir sélectionné le dataset, filtrez les données pour cibler votre analyse :

![Filtrage XQL](/home/ubuntu/cortex_xdr_manuel/images/xql_filtering.png)

*Figure 8.4 : Filtrage des données dans XQL*

1. **Syntaxe de base du filtre**
   - Utilisez le pipe `|` pour chaîner les commandes
   - Utilisez `filter` suivi de votre condition
   - Exemple : `dataset = xdr_data | filter event_type = "PROCESS_EXECUTION"`

2. **Opérateurs de comparaison**
   - `=` : égal à
   - `!=` : différent de
   - `>`, `>=`, `<`, `<=` : comparaisons numériques
   - `in` : appartient à une liste
   - `contains` : contient une sous-chaîne
   - `matches` : correspond à une expression régulière

3. **Opérateurs logiques**
   - `and` : les deux conditions doivent être vraies
   - `or` : au moins une condition doit être vraie
   - `not` : inverse la condition
   - Utilisez des parenthèses pour grouper les conditions

4. **Exemples de filtres**
   - Événements d'un endpoint spécifique :
     ```
     dataset = xdr_data | filter hostname = "DESKTOP-AB123"
     ```
   - Processus exécutés par un utilisateur spécifique :
     ```
     dataset = xdr_data | filter event_type = "PROCESS_EXECUTION" and username = "admin"
     ```
   - Connexions réseau vers des ports suspects :
     ```
     dataset = xdr_data | filter event_type = "NETWORK_CONNECTION" and (dst_port = 4444 or dst_port = 5555)
     ```

### Agrégation et statistiques

Pour analyser des tendances et des modèles dans les données :

![Agrégation XQL](/home/ubuntu/cortex_xdr_manuel/images/xql_aggregation.png)

*Figure 8.5 : Agrégation et statistiques dans XQL*

1. **Fonctions d'agrégation courantes**
   - `count()` : nombre d'enregistrements
   - `sum()` : somme des valeurs
   - `avg()` : moyenne des valeurs
   - `min()`, `max()` : valeur minimale ou maximale
   - `values()` : liste des valeurs distinctes

2. **Groupement avec `by`**
   - Utilisez `by` pour grouper les résultats par un ou plusieurs champs
   - Exemple : `stats count() by hostname`

3. **Exemples d'agrégation**
   - Nombre d'événements par type :
     ```
     dataset = xdr_data | stats count() by event_type
     ```
   - Top 10 des processus les plus exécutés :
     ```
     dataset = xdr_data | filter event_type = "PROCESS_EXECUTION" | stats count() by process_name | sort by count() desc | limit 10
     ```
   - Trafic réseau par destination :
     ```
     dataset = xdr_data | filter event_type = "NETWORK_CONNECTION" | stats sum(bytes_out) as outbound, sum(bytes_in) as inbound by dst_ip | sort by outbound desc
     ```

### Tri et limitation des résultats

Pour organiser et limiter les résultats de votre requête :

![Tri et limitation](/home/ubuntu/cortex_xdr_manuel/images/xql_sorting_limiting.png)

*Figure 8.6 : Tri et limitation des résultats dans XQL*

1. **Tri des résultats**
   - Utilisez `sort by` suivi du champ de tri
   - Ajoutez `desc` pour un tri descendant
   - Exemple : `sort by timestamp desc`

2. **Limitation du nombre de résultats**
   - Utilisez `limit` suivi du nombre maximum de résultats
   - Exemple : `limit 100`

3. **Exemples combinés**
   - Top 5 des utilisateurs avec le plus d'alertes :
     ```
     dataset = xdr_data | filter event_type = "ALERT" | stats count() by username | sort by count() desc | limit 5
     ```
   - Dernières connexions suspectes :
     ```
     dataset = xdr_data | filter event_type = "NETWORK_CONNECTION" and is_suspicious = true | sort by timestamp desc | limit 20
     ```

### Enrichissement des résultats

Pour enrichir vos résultats avec des informations supplémentaires :

![Enrichissement XQL](/home/ubuntu/cortex_xdr_manuel/images/xql_enrichment.png)

*Figure 8.7 : Enrichissement des résultats dans XQL*

1. **Création de champs calculés**
   - Utilisez `eval` pour créer de nouveaux champs
   - Exemple : `eval risk_score = severity * 10`

2. **Jointure de datasets**
   - Utilisez `join` pour combiner des données de différents datasets
   - Exemple : 
     ```
     dataset = xdr_data | filter event_type = "ALERT" | join (dataset = endpoint_data | filter event_type = "SYSTEM_INFO") on hostname
     ```

3. **Enrichissement avec des lookups**
   - Utilisez `lookup` pour enrichir avec des données de référence
   - Exemple : 
     ```
     dataset = xdr_data | lookup threat_intel on hash = file_hash
     ```

## 8.3 Exemples de requêtes courantes

Voici quelques exemples de requêtes XQL couramment utilisées pour différents cas d'usage.

### Détection de comportements suspects

![Requêtes de détection](/home/ubuntu/cortex_xdr_manuel/images/xql_detection_queries.png)

*Figure 8.8 : Exemples de requêtes de détection*

1. **Exécutions de PowerShell avec commandes encodées**
   ```
   dataset = xdr_data 
   | filter event_type = "PROCESS_EXECUTION" 
   | filter process_name = "powershell.exe" 
   | filter command_line contains "-enc" or command_line contains "-encodedcommand" 
   | fields hostname, username, timestamp, command_line
   ```

2. **Connexions réseau vers des ports non standard**
   ```
   dataset = xdr_data 
   | filter event_type = "NETWORK_CONNECTION" 
   | filter dst_port not in (80, 443, 53, 22, 21, 25, 110, 143, 993, 995) 
   | stats count() by dst_ip, dst_port, process_name 
   | sort by count() desc
   ```

3. **Création de services système suspects**
   ```
   dataset = xdr_data 
   | filter event_type = "SERVICE_CREATION" 
   | filter service_start_type = "AUTO_START" 
   | filter not (service_path contains "C:\\Windows\\System32" or service_path contains "C:\\Program Files") 
   | fields hostname, service_name, service_path, username
   ```

### Chasse aux menaces

![Requêtes de chasse](/home/ubuntu/cortex_xdr_manuel/images/xql_hunting_queries.png)

*Figure 8.9 : Exemples de requêtes de chasse aux menaces*

1. **Recherche de persistance via tâches planifiées**
   ```
   dataset = xdr_data 
   | filter event_type = "SCHEDULED_TASK_CREATION" 
   | filter task_path contains "\\AppData\\Roaming\\" or task_path contains "\\Temp\\" 
   | fields hostname, username, timestamp, task_name, task_path
   ```

2. **Détection de mouvement latéral**
   ```
   dataset = xdr_data 
   | filter event_type = "NETWORK_CONNECTION" 
   | filter dst_port in (445, 135, 139, 3389, 5985, 5986) 
   | stats count() by src_hostname, dst_ip, username, dst_port 
   | sort by count() desc
   ```

3. **Exécution de binaires depuis des emplacements inhabituels**
   ```
   dataset = xdr_data 
   | filter event_type = "PROCESS_EXECUTION" 
   | filter not (process_path contains "C:\\Windows" or process_path contains "C:\\Program Files" or process_path contains "C:\\ProgramData") 
   | stats count() by process_path, process_name, hostname 
   | sort by count() desc
   ```

### Analyse d'incidents

![Requêtes d'analyse](/home/ubuntu/cortex_xdr_manuel/images/xql_incident_analysis.png)

*Figure 8.10 : Exemples de requêtes d'analyse d'incidents*

1. **Chronologie des événements sur un endpoint compromis**
   ```
   dataset = xdr_data 
   | filter hostname = "COMPROMISED-HOST" 
   | filter timestamp >= "2023-06-01 00:00:00" and timestamp <= "2023-06-02 00:00:00" 
   | sort by timestamp 
   | fields timestamp, event_type, process_name, command_line, username
   ```

2. **Activité d'un utilisateur compromis**
   ```
   dataset = xdr_data 
   | filter username = "compromised.user" 
   | stats count() by event_type, hostname, process_name 
   | sort by count() desc
   ```

3. **Propagation d'un malware par hash**
   ```
   dataset = xdr_data 
   | filter file_hash = "a1b2c3d4e5f6..." 
   | stats earliest(timestamp) as first_seen by hostname 
   | sort by first_seen
   ```

## 8.4 Sauvegarde et partage des requêtes

Cortex XDR permet de sauvegarder et partager vos requêtes XQL pour une utilisation future.

### Sauvegarde d'une requête

Pour enregistrer une requête pour une utilisation ultérieure :

![Sauvegarde de requête](/home/ubuntu/cortex_xdr_manuel/images/xql_save_query.png)

*Figure 8.11 : Sauvegarde d'une requête XQL*

1. **Enregistrement initial**
   - Cliquez sur le bouton "Enregistrer" dans la barre d'outils
   - Dans la boîte de dialogue qui s'ouvre :
     - Donnez un nom descriptif à votre requête
     - Ajoutez une description détaillant son objectif
     - Choisissez un dossier de destination
     - Sélectionnez les options de partage

2. **Mise à jour d'une requête existante**
   - Modifiez la requête selon vos besoins
   - Cliquez sur "Enregistrer" pour mettre à jour la version existante
   - Ou utilisez "Enregistrer sous" pour créer une nouvelle version

3. **Organisation en dossiers**
   - Créez des dossiers thématiques pour organiser vos requêtes
   - Utilisez des conventions de nommage cohérentes
   - Ajoutez des tags pour faciliter la recherche

### Partage de requêtes

Pour partager vos requêtes avec d'autres utilisateurs :

![Partage de requête](/home/ubuntu/cortex_xdr_manuel/images/xql_share_query.png)

*Figure 8.12 : Options de partage de requêtes XQL*

1. **Partage lors de l'enregistrement**
   - Lors de la sauvegarde, sélectionnez l'option "Partagé"
   - Choisissez les utilisateurs ou groupes avec qui partager
   - Définissez les permissions (lecture seule ou modification)

2. **Partage d'une requête existante**
   - Dans le gestionnaire de requêtes, cliquez sur l'icône de partage
   - Configurez les options de partage
   - Envoyez une notification aux destinataires (optionnel)

3. **Export et import**
   - Exportez la requête au format JSON via le menu "Exporter"
   - Partagez le fichier JSON avec d'autres utilisateurs
   - Les destinataires peuvent importer la requête via "Importer"

### Bibliothèque de requêtes

Pour accéder à vos requêtes enregistrées et partagées :

![Bibliothèque de requêtes](/home/ubuntu/cortex_xdr_manuel/images/xql_query_library.png)

*Figure 8.13 : Bibliothèque de requêtes XQL*

1. **Accès à la bibliothèque**
   - Cliquez sur "Requêtes enregistrées" dans l'interface XQL
   - Parcourez la structure de dossiers
   - Utilisez la recherche pour trouver rapidement une requête

2. **Organisation de la bibliothèque**
   - Mes requêtes : requêtes que vous avez créées
   - Requêtes partagées : requêtes partagées par d'autres utilisateurs
   - Requêtes prédéfinies : requêtes fournies par Cortex XDR

3. **Actions disponibles**
   - Ouvrir : charger la requête dans l'éditeur
   - Dupliquer : créer une copie modifiable
   - Exporter : sauvegarder au format JSON
   - Supprimer : retirer de la bibliothèque

## 8.5 Intégration des requêtes XQL dans les workflows

Les requêtes XQL peuvent être intégrées dans divers workflows pour automatiser et enrichir vos processus de sécurité.

### Création de widgets de dashboard

Pour transformer une requête en widget de dashboard :

![XQL dans les dashboards](/home/ubuntu/cortex_xdr_manuel/images/xql_dashboard_widget.png)

*Figure 8.14 : Création d'un widget de dashboard à partir d'une requête XQL*

1. **Depuis l'interface XQL**
   - Exécutez et affinez votre requête
   - Cliquez sur "Ajouter au dashboard" dans la barre d'outils
   - Sélectionnez le dashboard cible ou créez-en un nouveau
   - Configurez les options de visualisation

2. **Configuration du widget**
   - Choisissez le type de visualisation approprié
   - Configurez les axes et les étiquettes
   - Définissez les options d'actualisation
   - Ajustez la taille et la position

3. **Paramètres dynamiques**
   - Liez le widget aux filtres globaux du dashboard
   - Configurez des drilldowns pour l'exploration interactive
   - Définissez des seuils d'alerte visuelle

### Création de règles de détection

Pour transformer une requête en règle de détection automatisée :

![XQL dans les règles](/home/ubuntu/cortex_xdr_manuel/images/xql_detection_rule.png)

*Figure 8.15 : Création d'une règle de détection basée sur XQL*

1. **Accès au module de règles**
   - Depuis l'interface XQL, cliquez sur "Créer une règle"
   - Ou accédez à "Paramètres" > "Règles de détection" > "Nouvelle règle"

2. **Configuration de la règle**
   - Nom et description de la règle
   - Sévérité et catégorie MITRE ATT&CK
   - Fréquence d'exécution
   - Période d'analyse

3. **Utilisation de la requête XQL**
   - Intégrez votre requête XQL comme base de la règle
   - Définissez les conditions qui déclenchent une alerte
   - Configurez les champs à inclure dans l'alerte

4. **Actions automatiques**
   - Définissez des actions à exécuter automatiquement
   - Options d'escalade et de notification
   - Intégration avec des playbooks de réponse

### Planification de rapports

Pour générer des rapports réguliers basés sur vos requêtes :

![XQL dans les rapports](/home/ubuntu/cortex_xdr_manuel/images/xql_scheduled_reports.png)

*Figure 8.16 : Configuration de rapports planifiés basés sur XQL*

1. **Création d'un rapport**
   - Depuis l'interface XQL, cliquez sur "Planifier un rapport"
   - Ou accédez à "Rapports" > "Nouveau rapport planifié"

2. **Configuration du rapport**
   - Nom et description du rapport
   - Format (PDF, CSV, HTML)
   - Mise en page et options de formatage
   - Contenu introductif et notes explicatives

3. **Planification**
   - Fréquence (quotidienne, hebdomadaire, mensuelle)
   - Heure d'exécution
   - Période de données à analyser (fixe ou relative)

4. **Distribution**
   - Liste des destinataires par email
   - Options d'archivage automatique
   - Intégration avec des systèmes de stockage externes
# 9. Configuration et Administration - Guide Visuel

## 9.1 Interface d'administration

L'interface d'administration de Cortex XDR permet de configurer et gérer tous les aspects de la plateforme. Cette section présente en détail cette interface et son utilisation efficace.

![Interface d'administration](/home/ubuntu/cortex_xdr_manuel/images/admin_interface.png)

*Figure 9.1 : Vue d'ensemble de l'interface d'administration avec annotations*

### Accès à l'interface d'administration

Pour accéder à l'interface d'administration :

1. Dans le menu principal, cliquez sur **Paramètres**
   
   ![Menu Paramètres](/home/ubuntu/cortex_xdr_manuel/images/settings_menu.png)
   
   *Figure 9.2 : Accès au menu Paramètres*

2. L'interface d'administration s'ouvre, présentant les différentes sections de configuration

3. Note : L'accès à certaines sections peut être limité selon vos droits d'utilisateur

### Structure de l'interface d'administration

L'interface d'administration est organisée en plusieurs sections principales :

![Structure d'administration](/home/ubuntu/cortex_xdr_manuel/images/admin_structure.png)

*Figure 9.3 : Structure de l'interface d'administration*

1. **Gestion des utilisateurs et rôles**
   - Utilisateurs et comptes
   - Rôles et permissions
   - Authentification et SSO
   - Audit des activités

2. **Configuration de la plateforme**
   - Paramètres généraux
   - Intégrations
   - Notifications
   - Maintenance et mises à jour

3. **Gestion des endpoints**
   - Déploiement des agents
   - Groupes d'endpoints
   - Politiques de sécurité
   - Exclusions

4. **Configuration de la détection**
   - Règles de détection
   - Listes de surveillance
   - Threat Intelligence
   - Paramètres d'analyse

5. **Paramètres de réponse**
   - Actions automatisées
   - Playbooks
   - Intégrations SOAR
   - Blocages automatiques

## 9.2 Configuration des politiques de sécurité

Les politiques de sécurité définissent le comportement des agents Cortex XDR sur les endpoints. Cette section explique comment les configurer efficacement.

### Accès aux politiques de sécurité

Pour accéder à la configuration des politiques :

1. Dans l'interface d'administration, naviguez vers **Gestion des endpoints > Politiques de sécurité**
   
   ![Menu des politiques](/home/ubuntu/cortex_xdr_manuel/images/security_policies_menu.png)
   
   *Figure 9.4 : Accès aux politiques de sécurité*

2. La liste des politiques existantes s'affiche

### Création d'une nouvelle politique

Pour créer une nouvelle politique de sécurité :

![Création de politique](/home/ubuntu/cortex_xdr_manuel/images/policy_creation.png)

*Figure 9.5 : Création d'une nouvelle politique de sécurité*

1. Cliquez sur le bouton **+ Créer une politique**

2. Dans la fenêtre qui s'ouvre :
   - **Nom** : Donnez un nom descriptif à la politique
   - **Description** : Ajoutez une description détaillée de l'objectif de la politique
   - **Basée sur** : Choisissez une politique existante comme point de départ (optionnel)
   - **Plateforme** : Sélectionnez les systèmes d'exploitation concernés

3. Cliquez sur **Créer** pour générer la nouvelle politique

### Configuration des modules de protection

Chaque politique comprend plusieurs modules de protection configurables :

![Modules de protection](/home/ubuntu/cortex_xdr_manuel/images/protection_modules.png)

*Figure 9.6 : Configuration des modules de protection*

1. **Protection anti-malware**
   - Mode de protection : Détection uniquement ou Protection active
   - Analyse à l'accès : Activée/Désactivée
   - Analyse planifiée : Fréquence et paramètres
   - Actions automatiques : Quarantaine, Suppression, Notification

2. **Protection anti-exploit**
   - Niveau de protection : Faible, Moyen, Élevé, Personnalisé
   - Techniques ciblées : Buffer overflow, Code injection, etc.
   - Actions : Bloquer, Alerter, Journaliser

3. **Protection comportementale**
   - Détection d'activités suspectes
   - Protection contre les ransomwares
   - Détection d'élévation de privilèges
   - Actions automatiques

4. **Contrôle des périphériques**
   - Types de périphériques autorisés/bloqués
   - Exceptions par ID de périphérique
   - Actions lors de la connexion d'un périphérique

### Gestion des exceptions

Pour configurer des exceptions aux règles de sécurité :

![Configuration des exceptions](/home/ubuntu/cortex_xdr_manuel/images/policy_exceptions.png)

*Figure 9.7 : Configuration des exceptions de politique*

1. Dans l'onglet **Exceptions** de la politique :
   - Cliquez sur **+ Ajouter une exception**

2. Configurez les détails de l'exception :
   - **Type** : Fichier, Dossier, Processus, Signature, etc.
   - **Valeur** : Chemin, hash ou autre identifiant
   - **Module** : Module de protection concerné par l'exception
   - **Raison** : Justification de l'exception
   - **Durée** : Permanente ou temporaire avec date d'expiration

3. Cliquez sur **Ajouter** pour créer l'exception

### Déploiement des politiques

Pour déployer une politique sur les endpoints :

![Déploiement de politique](/home/ubuntu/cortex_xdr_manuel/images/policy_deployment.png)

*Figure 9.8 : Déploiement d'une politique de sécurité*

1. Dans la liste des politiques, sélectionnez la politique à déployer

2. Cliquez sur **Assigner aux groupes**

3. Dans la fenêtre qui s'ouvre :
   - Sélectionnez les groupes d'endpoints cibles
   - Définissez la priorité en cas de conflit
   - Configurez les options de déploiement (immédiat ou planifié)

4. Cliquez sur **Assigner** pour lancer le déploiement

5. Suivez la progression du déploiement dans l'onglet **Statut du déploiement**

## 9.3 Gestion des utilisateurs et rôles

La gestion efficace des utilisateurs et des rôles est essentielle pour maintenir la sécurité et l'efficacité opérationnelle de Cortex XDR.

### Création d'un nouvel utilisateur

Pour ajouter un nouvel utilisateur à la plateforme :

![Création d'utilisateur](/home/ubuntu/cortex_xdr_manuel/images/user_creation.png)

*Figure 9.9 : Création d'un nouvel utilisateur*

1. Dans l'interface d'administration, naviguez vers **Gestion des utilisateurs > Utilisateurs**

2. Cliquez sur le bouton **+ Ajouter un utilisateur**

3. Dans le formulaire qui s'ouvre :
   - **Informations de base** : Nom, prénom, email, téléphone
   - **Identifiants** : Nom d'utilisateur et mot de passe initial
   - **Rôle** : Sélectionnez un ou plusieurs rôles
   - **Groupes** : Assignez l'utilisateur à des groupes (optionnel)
   - **Paramètres d'authentification** : MFA, changement de mot de passe à la connexion, etc.

4. Cliquez sur **Créer** pour ajouter l'utilisateur

### Configuration des rôles

Pour créer et configurer des rôles personnalisés :

![Configuration des rôles](/home/ubuntu/cortex_xdr_manuel/images/role_configuration.png)

*Figure 9.10 : Configuration des rôles utilisateur*

1. Naviguez vers **Gestion des utilisateurs > Rôles**

2. Cliquez sur **+ Créer un rôle**

3. Définissez les détails du rôle :
   - **Nom** : Nom descriptif du rôle
   - **Description** : Objectif et portée du rôle

4. Configurez les permissions par module :
   - **Dashboard** : Visualisation, création, modification
   - **Incidents** : Visualisation, investigation, résolution
   - **Alertes** : Visualisation, triage, suppression
   - **Endpoints** : Visualisation, actions, isolation
   - **Query** : Exécution, création, modification
   - **Administration** : Accès aux différentes sections d'administration

5. Définissez les restrictions de visibilité :
   - Limitation à certains groupes d'endpoints
   - Limitation à certains types d'incidents
   - Limitation à certaines données

6. Cliquez sur **Enregistrer** pour créer le rôle

### Configuration de l'authentification

Pour configurer les méthodes d'authentification :

![Configuration de l'authentification](/home/ubuntu/cortex_xdr_manuel/images/authentication_settings.png)

*Figure 9.11 : Configuration des paramètres d'authentification*

1. Naviguez vers **Gestion des utilisateurs > Authentification**

2. Configuration de l'authentification locale :
   - Politique de mots de passe (longueur, complexité, expiration)
   - Verrouillage de compte après échecs
   - Déconnexion automatique après inactivité

3. Configuration de l'authentification multifacteur (MFA) :
   - Activation/désactivation globale
   - Méthodes autorisées (application, SMS, email)
   - Exceptions pour certains utilisateurs ou réseaux

4. Intégration avec des fournisseurs d'identité externes :
   - Configuration SAML/SSO
   - Intégration LDAP/Active Directory
   - Mappage des attributs et des rôles

### Audit des activités utilisateur

Pour surveiller et auditer les activités des utilisateurs :

![Audit des activités](/home/ubuntu/cortex_xdr_manuel/images/user_activity_audit.png)

*Figure 9.12 : Interface d'audit des activités utilisateur*

1. Naviguez vers **Gestion des utilisateurs > Audit**

2. Utilisez les filtres disponibles :
   - Période temporelle
   - Utilisateur spécifique
   - Type d'action
   - Module concerné

3. Consultez les détails de chaque activité :
   - Horodatage
   - Utilisateur
   - Action effectuée
   - Objet de l'action
   - Adresse IP source

4. Exportez les journaux d'audit :
   - Format CSV ou PDF
   - Sélection de période personnalisée
   - Inclusion des détails complets

## 9.4 Paramètres de notification

La configuration des notifications permet de s'assurer que les bonnes personnes sont informées des événements importants au bon moment.

### Configuration des canaux de notification

Pour configurer les différents canaux de notification :

![Canaux de notification](/home/ubuntu/cortex_xdr_manuel/images/notification_channels.png)

*Figure 9.13 : Configuration des canaux de notification*

1. Dans l'interface d'administration, naviguez vers **Configuration de la plateforme > Notifications**

2. Configuration des notifications par email :
   - Serveur SMTP (adresse, port, authentification)
   - Email expéditeur
   - Modèles d'email personnalisables
   - Options de signature et de branding

3. Configuration des webhooks :
   - URL du webhook
   - Format de payload (JSON, XML)
   - Authentification
   - Certificats et chiffrement

4. Intégration avec les systèmes de messagerie :
   - Slack
   - Microsoft Teams
   - Google Chat
   - Autres plateformes via API

### Création de règles de notification

Pour définir quand et comment les notifications sont envoyées :

![Règles de notification](/home/ubuntu/cortex_xdr_manuel/images/notification_rules.png)

*Figure 9.14 : Création de règles de notification*

1. Cliquez sur **+ Créer une règle**

2. Définissez les déclencheurs :
   - **Type d'événement** : Nouvel incident, changement de statut, nouvelle alerte, etc.
   - **Conditions** : Sévérité, type, endpoint concerné, etc.
   - **Horaires** : Toujours ou pendant certaines plages horaires

3. Configurez les destinataires :
   - Utilisateurs individuels
   - Groupes d'utilisateurs
   - Canaux externes (webhooks, intégrations)

4. Personnalisez le contenu :
   - Informations à inclure
   - Format et mise en page
   - Liens vers les détails complets

5. Définissez les options avancées :
   - Agrégation (éviter les notifications multiples)
   - Délai avant notification
   - Escalade en cas d'absence de réponse

### Test des notifications

Pour vérifier le bon fonctionnement des notifications :

![Test de notification](/home/ubuntu/cortex_xdr_manuel/images/notification_testing.png)

*Figure 9.15 : Interface de test des notifications*

1. Dans la configuration d'une règle, cliquez sur **Tester**

2. Sélectionnez un événement de test :
   - Incident fictif
   - Alerte simulée
   - Événement système

3. Choisissez les destinataires de test

4. Lancez le test et vérifiez :
   - Réception des notifications
   - Format et contenu corrects
   - Délai de livraison acceptable

## 9.5 Intégrations et connecteurs

Cortex XDR peut s'intégrer avec de nombreux systèmes externes pour enrichir ses capacités et s'adapter à votre environnement.

### Vue d'ensemble des intégrations disponibles

Pour explorer les intégrations disponibles :

![Vue d'ensemble des intégrations](/home/ubuntu/cortex_xdr_manuel/images/integrations_overview.png)

*Figure 9.16 : Vue d'ensemble des intégrations disponibles*

1. Dans l'interface d'administration, naviguez vers **Configuration de la plateforme > Intégrations**

2. Parcourez les catégories d'intégrations :
   - SIEM/SOAR
   - Threat Intelligence
   - Ticketing et ITSM
   - Cloud et virtualisation
   - Authentification et identité
   - Communication et collaboration

3. Utilisez la recherche pour trouver une intégration spécifique

4. Consultez les détails de chaque intégration :
   - Description et cas d'usage
   - Prérequis
   - Fonctionnalités supportées
   - Limitations éventuelles

### Configuration d'une intégration SIEM

Pour configurer l'intégration avec un système SIEM :

![Intégration SIEM](/home/ubuntu/cortex_xdr_manuel/images/siem_integration.png)

*Figure 9.17 : Configuration d'une intégration SIEM*

1. Sélectionnez l'intégration SIEM souhaitée (Splunk, QRadar, ArcSight, etc.)

2. Cliquez sur **Configurer**

3. Renseignez les paramètres de connexion :
   - URL du serveur SIEM
   - Identifiants d'authentification
   - Certificats SSL/TLS
   - Ports et protocoles

4. Configurez les données à exporter :
   - Incidents
   - Alertes
   - Événements bruts
   - Journaux d'audit

5. Définissez les options de formatage :
   - Format des données (JSON, CEF, LEEF)
   - Champs à inclure
   - Enrichissement des données

6. Configurez les options avancées :
   - Fréquence de synchronisation
   - Gestion des erreurs
   - Limitation de bande passante

7. Cliquez sur **Tester la connexion** pour valider la configuration

8. Finalisez en cliquant sur **Enregistrer**

### Configuration d'une source de Threat Intelligence

Pour intégrer des sources de Threat Intelligence externes :

![Intégration Threat Intelligence](/home/ubuntu/cortex_xdr_manuel/images/threat_intel_integration.png)

*Figure 9.18 : Configuration d'une source de Threat Intelligence*

1. Naviguez vers **Configuration de la détection > Threat Intelligence**

2. Cliquez sur **+ Ajouter une source**

3. Sélectionnez le type de source :
   - Flux TAXII
   - API propriétaire
   - Import de fichiers (STIX, CSV, JSON)
   - Intégration prédéfinie (VirusTotal, AlienVault, etc.)

4. Configurez les paramètres de connexion :
   - URL ou endpoint
   - Clé API ou identifiants
   - Options d'authentification
   - Certificats

5. Définissez les types d'indicateurs à importer :
   - Hashes de fichiers
   - URLs et domaines
   - Adresses IP
   - Signatures YARA

6. Configurez la fréquence de mise à jour :
   - Temps réel (streaming)
   - Intervalle régulier (horaire, quotidien)
   - Manuel uniquement

7. Définissez les options de confiance et de priorité :
   - Score de confiance par défaut
   - Durée de validité des indicateurs
   - Priorité par rapport à d'autres sources

8. Cliquez sur **Valider** puis **Enregistrer**

### Intégration avec les systèmes de ticketing

Pour connecter Cortex XDR à votre système de gestion de tickets :

![Intégration ticketing](/home/ubuntu/cortex_xdr_manuel/images/ticketing_integration.png)

*Figure 9.19 : Configuration d'une intégration avec un système de ticketing*

1. Sélectionnez l'intégration de ticketing souhaitée (ServiceNow, Jira, Zendesk, etc.)

2. Cliquez sur **Configurer**

3. Renseignez les paramètres de connexion :
   - URL de l'instance
   - Identifiants d'API
   - Projet ou file d'attente par défaut

4. Configurez le mappage des champs :
   - Titre du ticket
   - Description
   - Priorité
   - Assignation
   - Champs personnalisés

5. Définissez les règles de création de tickets :
   - Création automatique pour certains types d'incidents
   - Mise à jour bidirectionnelle
   - Synchronisation des commentaires et pièces jointes

6. Configurez les options de workflow :
   - Statuts synchronisés
   - Actions automatiques lors de changements de statut
   - Fermeture automatique

7. Testez la configuration avec un incident de test

8. Finalisez en cliquant sur **Enregistrer**

### Vérification du statut des intégrations

Pour surveiller l'état de santé de vos intégrations :

![Statut des intégrations](/home/ubuntu/cortex_xdr_manuel/images/integration_status.png)

*Figure 9.20 : Vérification du statut des intégrations*

1. Naviguez vers **Configuration de la plateforme > Statut des intégrations**

2. Consultez le tableau de bord présentant :
   - Statut actuel de chaque intégration (Actif, Dégradé, En erreur)
   - Dernière synchronisation réussie
   - Erreurs récentes
   - Métriques de performance

3. Pour une intégration spécifique, cliquez sur **Détails** pour voir :
   - Journal des événements
   - Statistiques détaillées
   - Historique des erreurs
   - Options de dépannage

4. Actions disponibles :
   - Redémarrer une intégration
   - Forcer une synchronisation
   - Mettre en pause temporairement
   - Modifier la configuration
# 10. Intégrations et Connecteurs - Guide Visuel

## 10.1 Vue d'ensemble des intégrations disponibles

Cortex XDR offre un large éventail d'intégrations avec des systèmes et services tiers, permettant d'étendre ses capacités et de s'adapter parfaitement à votre environnement de sécurité existant. Cette section présente en détail les différentes intégrations disponibles et leur mise en œuvre.

![Vue d'ensemble des intégrations](/home/ubuntu/cortex_xdr_manuel/images/integrations_overview_complete.png)

*Figure 10.1 : Vue d'ensemble du centre d'intégrations de Cortex XDR*

### Catégories d'intégrations

Les intégrations de Cortex XDR sont organisées en plusieurs catégories principales :

![Catégories d'intégrations](/home/ubuntu/cortex_xdr_manuel/images/integration_categories.png)

*Figure 10.2 : Catégories d'intégrations disponibles*

1. **SIEM et SOAR**
   - Splunk, IBM QRadar, Microsoft Sentinel
   - Palo Alto Networks Cortex XSOAR
   - ServiceNow SecOps
   - Exabeam, LogRhythm, ArcSight

2. **Threat Intelligence**
   - VirusTotal, AlienVault OTX
   - ThreatConnect, Recorded Future
   - MISP, ThreatQ
   - Flux TAXII et STIX

3. **Cloud et Infrastructure**
   - AWS, Azure, Google Cloud
   - Kubernetes et conteneurs
   - VMware, Citrix
   - Okta, Azure AD

4. **Gestion des tickets et ITSM**
   - ServiceNow, Jira
   - Zendesk, Freshdesk
   - BMC Remedy, Cherwell
   - Microsoft Teams, Slack

5. **Analyse et Reporting**
   - Tableau, Power BI
   - Elastic Stack
   - Grafana, Looker
   - Systèmes de reporting personnalisés

### Accès au centre d'intégrations

Pour accéder au centre d'intégrations de Cortex XDR :

1. Dans le menu principal, cliquez sur **Paramètres**
   
   ![Menu Paramètres](/home/ubuntu/cortex_xdr_manuel/images/settings_menu_integrations.png)
   
   *Figure 10.3 : Accès au menu Paramètres*

2. Naviguez vers **Configuration de la plateforme > Intégrations**

3. Le centre d'intégrations s'ouvre, affichant toutes les intégrations disponibles

4. Utilisez la barre de recherche ou les filtres par catégorie pour trouver rapidement une intégration spécifique

## 10.2 Configuration d'intégrations SIEM/SOAR

Les intégrations SIEM (Security Information and Event Management) et SOAR (Security Orchestration, Automation and Response) sont parmi les plus importantes pour un SOC moderne.

### Intégration avec Splunk

Pour configurer l'intégration avec Splunk :

![Intégration Splunk](/home/ubuntu/cortex_xdr_manuel/images/splunk_integration.png)

*Figure 10.4 : Configuration de l'intégration Splunk*

1. Dans le centre d'intégrations, recherchez et sélectionnez **Splunk**

2. Cliquez sur **Configurer**

3. Renseignez les paramètres de connexion :
   - **URL Splunk** : Adresse de votre instance Splunk (ex: https://splunk.entreprise.com:8089)
   - **Token HEC** : Token HTTP Event Collector généré dans Splunk
   - **Index** : Nom de l'index Splunk où envoyer les données
   - **Source type** : Type de source pour les événements (ex: cortex_xdr)

4. Configurez les données à exporter :
   - Cochez les types d'événements à envoyer (Alertes, Incidents, Événements bruts, etc.)
   - Définissez la période de rétention pour la synchronisation historique

5. Options avancées :
   - **Batch Size** : Nombre d'événements par lot
   - **Intervalle** : Fréquence d'envoi des données
   - **Champs personnalisés** : Ajout de métadonnées spécifiques

6. Cliquez sur **Tester la connexion** pour valider la configuration

7. Finalisez en cliquant sur **Enregistrer**

### Intégration avec Microsoft Sentinel

Pour configurer l'intégration avec Microsoft Sentinel :

![Intégration Microsoft Sentinel](/home/ubuntu/cortex_xdr_manuel/images/sentinel_integration.png)

*Figure 10.5 : Configuration de l'intégration Microsoft Sentinel*

1. Dans le centre d'intégrations, recherchez et sélectionnez **Microsoft Sentinel**

2. Cliquez sur **Configurer**

3. Renseignez les paramètres Azure :
   - **Tenant ID** : ID de votre locataire Azure
   - **Client ID** : ID d'application de l'application enregistrée
   - **Client Secret** : Clé secrète de l'application
   - **Workspace ID** : ID de l'espace de travail Log Analytics
   - **Workspace Key** : Clé d'accès de l'espace de travail

4. Configurez les données à exporter :
   - Sélectionnez les tables de destination pour chaque type de données
   - Définissez les mappages de champs personnalisés

5. Options de synchronisation :
   - Synchronisation en temps réel ou par intervalle
   - Gestion des erreurs et nouvelles tentatives
   - Compression des données

6. Cliquez sur **Valider les paramètres** pour tester la connexion

7. Finalisez en cliquant sur **Enregistrer**

### Intégration avec Cortex XSOAR

Pour configurer l'intégration native avec Cortex XSOAR :

![Intégration Cortex XSOAR](/home/ubuntu/cortex_xdr_manuel/images/xsoar_integration.png)

*Figure 10.6 : Configuration de l'intégration Cortex XSOAR*

1. Dans le centre d'intégrations, sélectionnez **Cortex XSOAR**

2. Cliquez sur **Configurer**

3. Si vous utilisez Cortex XSOAR dans le même tenant :
   - Activez l'option **Intégration native**
   - L'authentification est automatiquement configurée

4. Si vous utilisez une instance XSOAR séparée :
   - Désactivez l'option **Intégration native**
   - Renseignez l'URL de l'instance XSOAR
   - Fournissez la clé API générée dans XSOAR

5. Configurez les règles d'escalade :
   - Définissez quels incidents sont automatiquement envoyés à XSOAR
   - Configurez les critères (sévérité, type, score)
   - Définissez le playbook à déclencher par défaut

6. Options de synchronisation bidirectionnelle :
   - Mise à jour du statut des incidents
   - Synchronisation des commentaires et notes
   - Partage des artefacts et preuves

7. Cliquez sur **Tester** puis **Enregistrer**

## 10.3 Intégrations Cloud

Les intégrations cloud permettent à Cortex XDR de surveiller et protéger vos ressources dans les environnements cloud publics.

### Intégration avec AWS

Pour configurer l'intégration avec Amazon Web Services :

![Intégration AWS](/home/ubuntu/cortex_xdr_manuel/images/aws_integration.png)

*Figure 10.7 : Configuration de l'intégration AWS*

1. Dans le centre d'intégrations, sélectionnez **Amazon Web Services**

2. Cliquez sur **Configurer**

3. Méthode d'authentification :
   - **Option 1 : Rôle IAM** (recommandée)
     - Créez un rôle IAM dans votre compte AWS avec les permissions requises
     - Fournissez l'ARN du rôle dans la configuration
   
   - **Option 2 : Clés d'accès**
     - Fournissez l'ID de clé d'accès et la clé secrète
     - Note : Cette méthode est moins sécurisée

4. Configuration des services à surveiller :
   - **CloudTrail** : Journaux d'activité et d'audit
   - **GuardDuty** : Alertes de sécurité natives
   - **VPC Flow Logs** : Trafic réseau
   - **S3** : Activité de stockage d'objets
   - **Lambda** : Exécution de fonctions serverless

5. Options avancées :
   - Filtres par région AWS
   - Filtres par compte (pour les organisations multi-comptes)
   - Intervalle de collecte des données

6. Cliquez sur **Valider la configuration** pour tester la connexion

7. Finalisez en cliquant sur **Enregistrer**

### Intégration avec Microsoft Azure

Pour configurer l'intégration avec Microsoft Azure :

![Intégration Azure](/home/ubuntu/cortex_xdr_manuel/images/azure_integration.png)

*Figure 10.8 : Configuration de l'intégration Microsoft Azure*

1. Dans le centre d'intégrations, sélectionnez **Microsoft Azure**

2. Cliquez sur **Configurer**

3. Renseignez les paramètres d'authentification :
   - **Tenant ID** : ID de votre locataire Azure
   - **Client ID** : ID d'application de l'application enregistrée
   - **Client Secret** : Clé secrète de l'application

4. Configuration des services à surveiller :
   - **Azure Activity Log** : Journaux d'activité de la plateforme
   - **Azure Security Center** : Alertes de sécurité
   - **Azure Network Watcher** : Trafic réseau
   - **Azure AD** : Événements d'authentification et d'identité
   - **Azure Storage** : Activité de stockage

5. Options avancées :
   - Filtres par groupe de ressources
   - Filtres par abonnement
   - Intervalle de collecte des données

6. Cliquez sur **Tester la connexion** pour valider la configuration

7. Finalisez en cliquant sur **Enregistrer**

### Intégration avec Google Cloud Platform

Pour configurer l'intégration avec Google Cloud Platform :

![Intégration GCP](/home/ubuntu/cortex_xdr_manuel/images/gcp_integration.png)

*Figure 10.9 : Configuration de l'intégration Google Cloud Platform*

1. Dans le centre d'intégrations, sélectionnez **Google Cloud Platform**

2. Cliquez sur **Configurer**

3. Méthode d'authentification :
   - **Option 1 : Compte de service** (recommandée)
     - Téléchargez le fichier JSON de clé du compte de service
     - Importez-le dans la configuration
   
   - **Option 2 : OAuth**
     - Suivez le processus d'authentification OAuth
     - Accordez les permissions requises

4. Configuration des services à surveiller :
   - **Cloud Audit Logs** : Journaux d'audit
   - **Security Command Center** : Alertes de sécurité
   - **VPC Flow Logs** : Trafic réseau
   - **Cloud Storage** : Activité de stockage
   - **Cloud Functions** : Exécution de fonctions serverless

5. Options avancées :
   - Filtres par projet
   - Filtres par région
   - Intervalle de collecte des données

6. Cliquez sur **Valider** pour tester la connexion

7. Finalisez en cliquant sur **Enregistrer**

## 10.4 Intégrations de Threat Intelligence

Les intégrations de Threat Intelligence permettent d'enrichir les données de Cortex XDR avec des informations sur les menaces provenant de sources externes.

### Configuration de VirusTotal

Pour intégrer VirusTotal comme source de Threat Intelligence :

![Intégration VirusTotal](/home/ubuntu/cortex_xdr_manuel/images/virustotal_integration.png)

*Figure 10.10 : Configuration de l'intégration VirusTotal*

1. Dans le centre d'intégrations, sélectionnez **VirusTotal**

2. Cliquez sur **Configurer**

3. Renseignez les paramètres d'API :
   - **Clé API** : Votre clé API VirusTotal
   - **Type d'API** : Public (gratuit) ou Premium

4. Configurez les options d'enrichissement :
   - **Enrichissement automatique** : Activation/désactivation
   - **Types d'indicateurs** : Fichiers, URLs, domaines, IPs
   - **Seuil de détection** : Nombre minimum de moteurs positifs

5. Options avancées :
   - Limitation de requêtes API
   - Mise en cache des résultats
   - Durée de validité des données

6. Cliquez sur **Tester l'API** pour valider la configuration

7. Finalisez en cliquant sur **Enregistrer**

### Configuration d'AlienVault OTX

Pour intégrer AlienVault Open Threat Exchange :

![Intégration AlienVault OTX](/home/ubuntu/cortex_xdr_manuel/images/alienvault_integration.png)

*Figure 10.11 : Configuration de l'intégration AlienVault OTX*

1. Dans le centre d'intégrations, sélectionnez **AlienVault OTX**

2. Cliquez sur **Configurer**

3. Renseignez les paramètres d'API :
   - **Clé API** : Votre clé API OTX
   - **URL** : URL de l'API (généralement par défaut)

4. Configurez les options de collecte :
   - **Pulses à collecter** : Tous ou spécifiques
   - **Types d'indicateurs** : Hashes, URLs, domaines, IPs, YARA
   - **Tags** : Filtrage par tags spécifiques

5. Options de synchronisation :
   - Fréquence de mise à jour
   - Période historique à importer
   - Gestion des doublons

6. Cliquez sur **Tester la connexion** pour valider la configuration

7. Finalisez en cliquant sur **Enregistrer**

### Configuration d'un flux TAXII

Pour intégrer un flux TAXII (Trusted Automated eXchange of Indicator Information) :

![Intégration TAXII](/home/ubuntu/cortex_xdr_manuel/images/taxii_integration.png)

*Figure 10.12 : Configuration d'un flux TAXII*

1. Dans le centre d'intégrations, sélectionnez **TAXII Feed**

2. Cliquez sur **Configurer**

3. Renseignez les paramètres de connexion :
   - **URL du serveur** : URL du point de découverte TAXII
   - **Version TAXII** : 1.x ou 2.x
   - **Collection** : Nom de la collection à utiliser
   - **Authentification** : Identifiants si nécessaire

4. Configurez les options de collecte :
   - **Types d'indicateurs** : Sélectionnez les types à importer
   - **Filtres** : Par type de menace, sévérité, etc.
   - **Confiance** : Score de confiance à attribuer

5. Options de synchronisation :
   - Fréquence de mise à jour
   - Période historique à importer
   - Gestion des conflits avec d'autres sources

6. Cliquez sur **Tester la connexion** pour valider la configuration

7. Finalisez en cliquant sur **Enregistrer**

## 10.5 Intégrations de ticketing et ITSM

Les intégrations avec les systèmes de gestion de tickets permettent d'automatiser le workflow de réponse aux incidents.

### Intégration avec ServiceNow

Pour configurer l'intégration avec ServiceNow :

![Intégration ServiceNow](/home/ubuntu/cortex_xdr_manuel/images/servicenow_integration.png)

*Figure 10.13 : Configuration de l'intégration ServiceNow*

1. Dans le centre d'intégrations, sélectionnez **ServiceNow**

2. Cliquez sur **Configurer**

3. Renseignez les paramètres de connexion :
   - **URL de l'instance** : URL de votre instance ServiceNow
   - **Nom d'utilisateur** : Compte de service ServiceNow
   - **Mot de passe** : Mot de passe du compte
   - **Client ID et Secret** : Si vous utilisez OAuth

4. Configurez le mappage des incidents :
   - **Table cible** : Généralement incident ou u_security_incident
   - **Mappage des champs** : Correspondance entre champs Cortex XDR et ServiceNow
   - **Modèle de description** : Format du contenu détaillé

5. Options de synchronisation bidirectionnelle :
   - **Création automatique** : Critères pour la création de tickets
   - **Mise à jour bidirectionnelle** : Synchronisation des statuts et commentaires
   - **Fermeture automatique** : Règles de fermeture automatique

6. Cliquez sur **Tester la connexion** pour valider la configuration

7. Finalisez en cliquant sur **Enregistrer**

### Intégration avec Jira

Pour configurer l'intégration avec Jira :

![Intégration Jira](/home/ubuntu/cortex_xdr_manuel/images/jira_integration.png)

*Figure 10.14 : Configuration de l'intégration Jira*

1. Dans le centre d'intégrations, sélectionnez **Jira**

2. Cliquez sur **Configurer**

3. Renseignez les paramètres de connexion :
   - **URL Jira** : URL de votre instance Jira
   - **Nom d'utilisateur** : Compte Jira avec droits suffisants
   - **Token API** ou **Mot de passe** : Selon la méthode d'authentification

4. Configurez les paramètres du projet :
   - **Projet** : Code du projet Jira (ex: SEC)
   - **Type de ticket** : Généralement "Incident" ou "Bug"
   - **Priorité par défaut** : Mappage des sévérités Cortex XDR vers priorités Jira

5. Mappage des champs :
   - Configuration des champs standard (résumé, description, assigné)
   - Configuration des champs personnalisés
   - Mappage des statuts et résolutions

6. Options avancées :
   - Pièces jointes automatiques
   - Création de sous-tâches
   - Règles de mise à jour

7. Cliquez sur **Tester** pour valider la configuration

8. Finalisez en cliquant sur **Enregistrer**

### Intégration avec Microsoft Teams

Pour configurer l'intégration avec Microsoft Teams :

![Intégration Microsoft Teams](/home/ubuntu/cortex_xdr_manuel/images/teams_integration.png)

*Figure 10.15 : Configuration de l'intégration Microsoft Teams*

1. Dans le centre d'intégrations, sélectionnez **Microsoft Teams**

2. Cliquez sur **Configurer**

3. Configuration du webhook :
   - Créez un webhook entrant dans le canal Teams souhaité
   - Copiez l'URL du webhook dans la configuration

4. Configurez les notifications :
   - **Types d'événements** : Incidents, alertes, mises à jour de statut
   - **Sévérité minimale** : Niveau de sévérité déclenchant une notification
   - **Format des messages** : Structure et contenu des notifications

5. Options avancées :
   - Cartes adaptatives personnalisées
   - Boutons d'action rapide
   - Agrégation des notifications

6. Cliquez sur **Envoyer un message test** pour valider la configuration

7. Finalisez en cliquant sur **Enregistrer**

## 10.6 Gestion et surveillance des intégrations

Une fois vos intégrations configurées, il est essentiel de les surveiller et de les gérer efficacement.

### Tableau de bord des intégrations

Pour surveiller l'état de toutes vos intégrations :

![Tableau de bord des intégrations](/home/ubuntu/cortex_xdr_manuel/images/integrations_dashboard.png)

*Figure 10.16 : Tableau de bord de surveillance des intégrations*

1. Dans l'interface d'administration, naviguez vers **Configuration de la plateforme > Statut des intégrations**

2. Le tableau de bord affiche :
   - Liste de toutes les intégrations configurées
   - Statut actuel (Actif, Dégradé, En erreur, Désactivé)
   - Dernière synchronisation réussie
   - Métriques de performance (temps de réponse, volume de données)

3. Filtres disponibles :
   - Par catégorie d'intégration
   - Par statut
   - Par période d'activité

4. Options de tri :
   - Par nom
   - Par statut
   - Par dernière activité
   - Par performance

### Dépannage des intégrations

Pour résoudre les problèmes d'une intégration :

![Dépannage d'intégration](/home/ubuntu/cortex_xdr_manuel/images/integration_troubleshooting.png)

*Figure 10.17 : Interface de dépannage des intégrations*

1. Dans le tableau de bord des intégrations, cliquez sur une intégration en erreur

2. La page de détails affiche :
   - Journal des erreurs récentes
   - Messages d'erreur détaillés
   - Statistiques de performance
   - Historique des statuts

3. Actions de dépannage disponibles :
   - **Tester la connexion** : Vérifie les paramètres d'authentification
   - **Synchronisation forcée** : Déclenche une synchronisation immédiate
   - **Réinitialiser les compteurs d'erreur** : Efface l'historique des erreurs
   - **Redémarrer l'intégration** : Arrête et relance le processus d'intégration

4. Outils de diagnostic avancés :
   - Logs détaillés (niveau debug)
   - Analyse des performances
   - Vérification des permissions

### Gestion des quotas et limitations

Pour gérer les quotas et limitations des intégrations :

![Gestion des quotas](/home/ubuntu/cortex_xdr_manuel/images/integration_quotas.png)

*Figure 10.18 : Gestion des quotas et limitations des intégrations*

1. Dans les paramètres avancés de chaque intégration, accédez à l'onglet **Quotas et limitations**

2. Configurez les limites de ressources :
   - **Limite de requêtes API** : Nombre maximum de requêtes par minute/heure
   - **Taille maximale des lots** : Nombre d'éléments par transaction
   - **Limite de bande passante** : Débit maximal en Mo/s
   - **Fenêtre de limitation** : Période de calcul des quotas

3. Options de gestion des dépassements :
   - **File d'attente** : Mise en attente des requêtes excédentaires
   - **Rejet** : Abandon des requêtes au-delà du quota
   - **Throttling adaptatif** : Ajustement dynamique selon la charge

4. Alertes et notifications :
   - Configuration d'alertes en cas d'approche des limites
   - Notifications de dépassement de quota
   - Rapports d'utilisation périodiques

### Audit des activités d'intégration

Pour auditer les activités des intégrations :

![Audit des intégrations](/home/ubuntu/cortex_xdr_manuel/images/integration_audit.png)

*Figure 10.19 : Interface d'audit des activités d'intégration*

1. Naviguez vers **Configuration de la plateforme > Audit > Intégrations**

2. Le journal d'audit affiche :
   - Modifications de configuration
   - Activations et désactivations
   - Synchronisations manuelles
   - Erreurs critiques
   - Actions administratives

3. Filtres disponibles :
   - Par intégration
   - Par type d'action
   - Par utilisateur
   - Par période

4. Options d'exportation :
   - Export CSV pour analyse externe
   - Rapports périodiques
   - Intégration avec systèmes de conformité
# 11. Bonnes Pratiques et Optimisation - Guide Visuel

## 11.1 Optimisation des performances

Pour tirer le meilleur parti de Cortex XDR, il est essentiel d'optimiser ses performances en fonction de votre environnement spécifique. Cette section présente les meilleures pratiques pour assurer des performances optimales.

![Optimisation des performances](/home/ubuntu/cortex_xdr_manuel/images/performance_optimization.png)

*Figure 11.1 : Tableau de bord d'optimisation des performances*

### Surveillance des performances

Pour surveiller les performances de votre déploiement Cortex XDR :

![Surveillance des performances](/home/ubuntu/cortex_xdr_manuel/images/performance_monitoring.png)

*Figure 11.2 : Interface de surveillance des performances*

1. **Accès au tableau de bord de performances**
   - Dans le menu principal, naviguez vers **Paramètres > Système > Performances**
   - Ou accédez au widget de performances dans le dashboard principal

2. **Métriques clés à surveiller**
   - **Utilisation CPU/mémoire des agents** : Impact sur les endpoints
   - **Latence des alertes** : Délai entre détection et notification
   - **Temps de réponse des requêtes** : Performance des recherches XQL
   - **Taux d'ingestion de données** : Volume de données traitées par jour

3. **Identification des goulots d'étranglement**
   - Analysez les tendances de performance sur différentes périodes
   - Identifiez les pics d'utilisation des ressources
   - Corrélation avec des événements spécifiques (mises à jour, scans)

### Optimisation des agents

Pour réduire l'impact des agents sur les endpoints :

![Optimisation des agents](/home/ubuntu/cortex_xdr_manuel/images/agent_optimization.png)

*Figure 11.3 : Configuration d'optimisation des agents*

1. **Ajustement des paramètres de scan**
   - **Planification intelligente** : Programmez les scans complets pendant les heures creuses
   - **Limitation de ressources** : Définissez des limites d'utilisation CPU/mémoire
   - **Exclusions judicieuses** : Excluez les dossiers à fort trafic mais faible risque

2. **Configuration par type d'endpoint**
   - **Serveurs critiques** : Privilégiez la stabilité, limitez les scans intensifs
   - **Postes de travail** : Équilibrez protection et expérience utilisateur
   - **Endpoints à ressources limitées** : Utilisez des profils légers

3. **Mise en cache et optimisation locale**
   - Activez le cache local pour les vérifications répétitives
   - Configurez la rétention des données locales
   - Optimisez la fréquence de synchronisation avec le cloud

### Optimisation de la console

Pour améliorer les performances de la console Cortex XDR :

![Optimisation de la console](/home/ubuntu/cortex_xdr_manuel/images/console_optimization.png)

*Figure 11.4 : Paramètres d'optimisation de la console*

1. **Gestion des données**
   - **Période de rétention** : Ajustez selon vos besoins réels
   - **Agrégation des données** : Activez l'agrégation pour les données anciennes
   - **Archivage automatique** : Configurez des règles d'archivage pour les incidents résolus

2. **Optimisation des dashboards**
   - Limitez le nombre de widgets par dashboard
   - Utilisez des périodes de rafraîchissement appropriées
   - Privilégiez les visualisations agrégées pour les grands volumes de données

3. **Configuration des requêtes**
   - Créez des index personnalisés pour les recherches fréquentes
   - Limitez la portée temporelle des requêtes par défaut
   - Utilisez des requêtes optimisées (avec filtres efficaces en premier)

## 11.2 Réduction des faux positifs

La gestion efficace des faux positifs est cruciale pour maintenir l'efficacité opérationnelle d'un SOC utilisant Cortex XDR.

### Analyse des faux positifs

Pour identifier et comprendre les sources de faux positifs :

![Analyse des faux positifs](/home/ubuntu/cortex_xdr_manuel/images/false_positive_analysis.png)

*Figure 11.5 : Interface d'analyse des faux positifs*

1. **Accès à l'analyse des faux positifs**
   - Dans le menu principal, naviguez vers **Paramètres > Détection > Analyse des faux positifs**
   - Ou générez un rapport personnalisé depuis la section Rapports

2. **Métriques et visualisations**
   - Distribution des faux positifs par type de règle
   - Tendances temporelles des faux positifs
   - Endpoints générant le plus de faux positifs
   - Règles avec les taux de faux positifs les plus élevés

3. **Analyse détaillée**
   - Sélectionnez une règle spécifique pour voir les détails
   - Examinez les modèles communs dans les faux positifs
   - Identifiez les applications légitimes fréquemment signalées

### Ajustement des règles de détection

Pour affiner les règles et réduire les faux positifs :

![Ajustement des règles](/home/ubuntu/cortex_xdr_manuel/images/rule_tuning.png)

*Figure 11.6 : Interface d'ajustement des règles*

1. **Accès à l'éditeur de règles**
   - Naviguez vers **Paramètres > Détection > Règles de détection**
   - Sélectionnez la règle à ajuster

2. **Techniques d'ajustement**
   - **Ajout de conditions** : Rendez la règle plus spécifique
   - **Ajustement des seuils** : Modifiez les seuils de déclenchement
   - **Filtres contextuels** : Ajoutez des filtres basés sur le contexte (utilisateur, application, heure)
   - **Période d'observation** : Ajustez la fenêtre temporelle d'analyse

3. **Test et validation**
   - Utilisez le mode "Test" pour évaluer l'impact des modifications
   - Comparez les résultats avant/après ajustement
   - Validez que les vrais positifs sont toujours détectés

### Configuration des exclusions

Pour créer des exclusions efficaces et sécurisées :

![Configuration des exclusions](/home/ubuntu/cortex_xdr_manuel/images/exclusions_configuration.png)

*Figure 11.7 : Interface de configuration des exclusions*

1. **Types d'exclusions**
   - **Exclusions par fichier/hash** : Pour les applications légitimes connues
   - **Exclusions par chemin** : Pour les dossiers d'applications spécifiques
   - **Exclusions par certificat** : Pour les éditeurs de confiance
   - **Exclusions par processus** : Pour les comportements légitimes connus

2. **Bonnes pratiques pour les exclusions**
   - Soyez aussi spécifique que possible (évitez les exclusions trop larges)
   - Documentez la raison de chaque exclusion
   - Définissez une date de révision pour les exclusions temporaires
   - Utilisez des hashes plutôt que des noms de fichiers quand c'est possible

3. **Gestion des exclusions**
   - Révisez régulièrement la liste des exclusions
   - Supprimez les exclusions obsolètes
   - Consolidez les exclusions similaires
   - Surveillez l'impact des exclusions sur la sécurité globale

## 11.3 Stratégies de déploiement

Un déploiement bien planifié de Cortex XDR est essentiel pour maximiser la protection tout en minimisant les perturbations.

### Déploiement par phases

Pour un déploiement progressif et contrôlé :

![Déploiement par phases](/home/ubuntu/cortex_xdr_manuel/images/phased_deployment.png)

*Figure 11.8 : Planification d'un déploiement par phases*

1. **Phase 1 : Pilote**
   - Déployez sur un petit groupe d'endpoints représentatifs (5-10%)
   - Incluez différents types de systèmes et cas d'usage
   - Configurez en mode surveillance uniquement
   - Collectez les retours et ajustez la configuration

2. **Phase 2 : Déploiement initial**
   - Étendez à un groupe plus large (20-30%)
   - Activez progressivement les fonctionnalités de protection
   - Surveillez attentivement les performances et les faux positifs
   - Affinez les politiques et exclusions

3. **Phase 3 : Déploiement complet**
   - Déployez sur le reste de l'environnement
   - Utilisez des vagues planifiées par département ou fonction
   - Activez toutes les protections selon les politiques définies
   - Établissez des processus de surveillance continue

4. **Phase 4 : Optimisation**
   - Analysez les données de performance et de détection
   - Optimisez les politiques par groupe d'endpoints
   - Intégrez avec d'autres systèmes de sécurité
   - Formez les équipes à l'utilisation avancée

### Stratégies par type d'environnement

Adaptez votre approche selon les différents environnements :

![Stratégies par environnement](/home/ubuntu/cortex_xdr_manuel/images/environment_strategies.png)

*Figure 11.9 : Stratégies de déploiement par type d'environnement*

1. **Environnements de production**
   - Privilégiez la stabilité et la fiabilité
   - Testez exhaustivement avant déploiement
   - Planifiez des fenêtres de maintenance
   - Prévoyez des procédures de rollback

2. **Environnements de développement**
   - Équilibrez protection et flexibilité
   - Créez des exclusions pour les outils de développement
   - Configurez des alertes sans blocage automatique
   - Collaborez étroitement avec les équipes de développement

3. **Infrastructures critiques**
   - Déployez d'abord en mode surveillance
   - Validez avec les propriétaires des systèmes
   - Créez des politiques spécifiques très précises
   - Testez l'impact sur les performances des applications critiques

4. **Environnements cloud**
   - Utilisez les API de déploiement automatisé
   - Intégrez dans les templates d'infrastructure
   - Adaptez les politiques aux services cloud spécifiques
   - Configurez la protection des conteneurs et serverless

### Automatisation du déploiement

Pour un déploiement à grande échelle efficace :

![Automatisation du déploiement](/home/ubuntu/cortex_xdr_manuel/images/deployment_automation.png)

*Figure 11.10 : Outils d'automatisation du déploiement*

1. **Méthodes de déploiement automatisé**
   - **GPO/Active Directory** : Pour environnements Windows
   - **Scripts de déploiement** : Pour environnements mixtes
   - **Outils de gestion de configuration** : Ansible, Chef, Puppet
   - **Intégration MDM** : Pour appareils mobiles et macOS

2. **Configuration de l'installation silencieuse**
   - Paramètres de ligne de commande pour installation sans interaction
   - Options de configuration pré-déploiement
   - Vérification post-installation automatisée

3. **Surveillance du déploiement**
   - Tableaux de bord de progression du déploiement
   - Alertes pour les échecs d'installation
   - Rapports de couverture par groupe ou département
   - Vérification de la conformité des versions

## 11.4 Maintenance et mises à jour

Une stratégie de maintenance efficace garantit que votre déploiement Cortex XDR reste à jour et performant.

### Gestion des mises à jour

Pour gérer efficacement les mises à jour de Cortex XDR :

![Gestion des mises à jour](/home/ubuntu/cortex_xdr_manuel/images/update_management.png)

*Figure 11.11 : Interface de gestion des mises à jour*

1. **Planification des mises à jour**
   - Consultez régulièrement le calendrier de versions
   - Planifiez les mises à jour dans votre cycle de maintenance
   - Prévoyez des fenêtres de maintenance adaptées
   - Coordonnez avec d'autres mises à jour de sécurité

2. **Stratégie de mise à jour par phases**
   - Testez d'abord sur un groupe pilote
   - Déployez progressivement par groupes d'endpoints
   - Surveillez les problèmes potentiels entre chaque phase
   - Prévoyez une procédure de rollback

3. **Configuration des politiques de mise à jour**
   - **Automatique** : Pour les endpoints non critiques
   - **Planifiée** : Pour contrôler le moment précis
   - **Manuelle** : Pour les systèmes critiques
   - **Différée** : Pour les environnements sensibles

### Surveillance de la santé du système

Pour maintenir un environnement Cortex XDR sain :

![Surveillance de la santé](/home/ubuntu/cortex_xdr_manuel/images/health_monitoring.png)

*Figure 11.12 : Tableau de bord de santé du système*

1. **Indicateurs clés de santé**
   - **Statut de connexion des agents** : Pourcentage d'agents connectés
   - **Versions des agents** : Distribution des versions
   - **Problèmes détectés** : Agents en erreur ou dégradés
   - **Utilisation des ressources** : CPU, mémoire, disque

2. **Alertes de santé système**
   - Configuration des seuils d'alerte
   - Notifications en cas de problèmes
   - Escalade automatique pour les problèmes critiques
   - Rapports périodiques de santé

3. **Actions correctives**
   - Redémarrage à distance des agents problématiques
   - Réinstallation automatique des agents défectueux
   - Synchronisation forcée des politiques
   - Diagnostic à distance des problèmes

### Sauvegarde et restauration

Pour protéger votre configuration Cortex XDR :

![Sauvegarde et restauration](/home/ubuntu/cortex_xdr_manuel/images/backup_restore.png)

*Figure 11.13 : Interface de sauvegarde et restauration*

1. **Éléments à sauvegarder**
   - Politiques de sécurité
   - Règles de détection personnalisées
   - Configurations d'intégration
   - Dashboards et rapports personnalisés
   - Listes blanches et exclusions

2. **Options de sauvegarde**
   - **Sauvegarde manuelle** : Export à la demande
   - **Sauvegarde planifiée** : Automatisation périodique
   - **Sauvegarde avant modification** : Protection contre les erreurs
   - **Versionnement** : Conservation de plusieurs versions

3. **Procédures de restauration**
   - Restauration complète de la configuration
   - Restauration sélective d'éléments spécifiques
   - Comparaison des versions avant restauration
   - Validation post-restauration

## 11.5 Bonnes pratiques pour les analystes SOC

Des pratiques efficaces pour les analystes SOC permettent de maximiser la valeur de Cortex XDR dans les opérations quotidiennes.

### Organisation du workflow

Pour optimiser le workflow des analystes :

![Organisation du workflow](/home/ubuntu/cortex_xdr_manuel/images/soc_workflow.png)

*Figure 11.14 : Organisation du workflow pour analystes SOC*

1. **Priorisation des alertes**
   - Utilisez les scores de risque pour prioriser
   - Créez des vues personnalisées par type de menace
   - Configurez des filtres pour les différents niveaux d'analyste
   - Établissez des SLA par niveau de sévérité

2. **Répartition du travail**
   - Assignez les incidents par domaine d'expertise
   - Utilisez des files d'attente par équipe ou fonction
   - Implémentez un système de rotation pour les alertes de faible priorité
   - Prévoyez des escalades pour les incidents non traités

3. **Documentation standardisée**
   - Créez des modèles pour les notes d'investigation
   - Standardisez la nomenclature des cas
   - Documentez systématiquement les actions entreprises
   - Utilisez des tags cohérents pour faciliter les recherches futures

### Techniques d'investigation efficaces

Pour des investigations plus rapides et précises :

![Techniques d'investigation](/home/ubuntu/cortex_xdr_manuel/images/investigation_techniques.png)

*Figure 11.15 : Techniques d'investigation efficaces*

1. **Approche structurée**
   - Commencez par une vue d'ensemble de l'incident
   - Établissez une chronologie des événements
   - Identifiez le point d'entrée initial
   - Tracez la propagation de la menace

2. **Utilisation efficace des outils**
   - Maîtrisez les requêtes XQL pour des recherches précises
   - Utilisez les visualisations de processus pour comprendre les relations
   - Exploitez les timeline interactives pour la chronologie
   - Combinez plusieurs sources de données pour une vue complète

3. **Techniques avancées**
   - Recherche de comportements similaires sur d'autres endpoints
   - Corrélation avec des incidents historiques
   - Enrichissement avec des sources de threat intelligence
   - Analyse comportementale pour détecter les anomalies subtiles

### Amélioration continue

Pour développer constamment les compétences et l'efficacité :

![Amélioration continue](/home/ubuntu/cortex_xdr_manuel/images/continuous_improvement.png)

*Figure 11.16 : Processus d'amélioration continue*

1. **Revue post-incident**
   - Analysez les incidents significatifs en équipe
   - Identifiez ce qui a bien fonctionné et les points à améliorer
   - Documentez les leçons apprises
   - Mettez à jour les procédures en conséquence

2. **Métriques de performance**
   - Temps moyen de détection (MTTD)
   - Temps moyen de réponse (MTTR)
   - Taux de faux positifs
   - Précision des classifications d'incidents

3. **Formation continue**
   - Partagez les connaissances sur les nouvelles menaces
   - Organisez des exercices de simulation
   - Suivez les formations Cortex XDR avancées
   - Participez à des communautés de pratique
# 12. Glossaire et Ressources - Guide Visuel

## 12.1 Glossaire des termes techniques

Cette section fournit un glossaire complet des termes techniques utilisés dans Cortex XDR et dans ce manuel, organisé alphabétiquement pour une référence rapide.

![Glossaire illustré](/home/ubuntu/cortex_xdr_manuel/images/illustrated_glossary.png)

*Figure 12.1 : Glossaire illustré des termes techniques*

### A-C

**Agent Cortex XDR**  
Logiciel léger installé sur les endpoints qui collecte des données, applique des politiques de sécurité et exécute des actions de protection et de réponse.

**Alerte**  
Notification générée lorsqu'une activité suspecte ou malveillante est détectée par Cortex XDR. Les alertes peuvent être générées par des règles de détection, des analyses comportementales ou des signatures de menaces.

**Analyse comportementale**  
Technique de détection qui identifie les activités anormales en analysant le comportement des utilisateurs, des systèmes et des applications par rapport à une référence établie.

**Analyse forensique**  
Processus d'investigation approfondie pour collecter, préserver et analyser des preuves numériques après une compromission ou un incident de sécurité.

**API (Application Programming Interface)**  
Interface permettant à Cortex XDR d'interagir programmatiquement avec d'autres systèmes et applications.

**Attaque de la chaîne d'approvisionnement**  
Attaque ciblant les fournisseurs ou partenaires d'une organisation pour compromettre indirectement la cible principale.

**BIOCs (Behavioral Indicators of Compromise)**  
Indicateurs basés sur des modèles de comportement suspects plutôt que sur des signatures statiques, permettant de détecter des menaces inconnues ou sophistiquées.

**Blocage automatique**  
Fonction qui arrête automatiquement les activités malveillantes détectées sans intervention manuelle d'un analyste.

**Chasse aux menaces (Threat Hunting)**  
Processus proactif de recherche de menaces qui n'ont pas été détectées par les systèmes de sécurité automatisés.

**Corrélation d'événements**  
Processus d'analyse qui établit des relations entre différents événements de sécurité pour identifier des modèles d'attaque plus larges.

### D-F

**Dashboard**  
Interface visuelle présentant des données de sécurité agrégées et des métriques clés pour une surveillance et une analyse efficaces.

**Détection d'anomalies**  
Technique qui identifie les écarts par rapport aux modèles normaux d'activité pour détecter des comportements potentiellement malveillants.

**EDR (Endpoint Detection and Response)**  
Technologie de sécurité qui surveille en continu les endpoints pour détecter et répondre aux menaces avancées.

**Endpoint**  
Tout appareil connecté au réseau, comme un ordinateur, un serveur, un appareil mobile ou un objet connecté.

**Exclusion**  
Configuration qui exempte certains fichiers, processus ou activités des analyses de sécurité pour éviter les faux positifs ou les problèmes de performance.

**Exfiltration de données**  
Extraction non autorisée de données sensibles d'un système ou réseau par un attaquant.

**Faux positif**  
Alerte de sécurité incorrecte qui identifie une activité légitime comme malveillante.

**Faux négatif**  
Échec de détection d'une activité réellement malveillante par les systèmes de sécurité.

**Flux de données (Data Stream)**  
Flux continu d'informations de sécurité provenant de diverses sources et analysé par Cortex XDR.

### G-I

**Groupe d'endpoints**  
Collection logique d'endpoints partageant des caractéristiques communes ou des politiques de sécurité.

**Hash**  
Valeur numérique unique générée à partir d'un fichier, utilisée pour identifier et vérifier l'intégrité des fichiers.

**Incident**  
Événement ou série d'événements de sécurité corrélés qui représentent une menace potentielle ou confirmée pour l'organisation.

**Indicateur de compromission (IOC)**  
Artefact observé dans un réseau ou système qui indique avec une forte probabilité une intrusion ou une activité malveillante.

**Intégration**  
Connexion entre Cortex XDR et d'autres systèmes ou services pour partager des données et automatiser des processus.

**Isolation réseau**  
Mesure de sécurité qui sépare un endpoint compromis du reste du réseau tout en maintenant la connexion avec la plateforme de sécurité.

### J-L

**Journal d'audit**  
Enregistrement chronologique des activités système et utilisateur, utilisé pour la conformité et les investigations de sécurité.

**KSPM (Kubernetes Security Posture Management)**  
Fonctionnalité qui évalue et améliore la posture de sécurité des environnements Kubernetes.

**Latéralisation (Mouvement latéral)**  
Technique utilisée par les attaquants pour se déplacer horizontalement dans un réseau après avoir compromis un point d'entrée initial.

**Ligne de base (Baseline)**  
Profil d'activité normale établi pour un système ou un réseau, utilisé comme référence pour détecter les anomalies.

**Liste blanche (Whitelist)**  
Liste d'applications, processus ou activités approuvés qui sont exemptés des contrôles de sécurité.

**Liste noire (Blacklist)**  
Liste d'applications, processus ou activités connus comme malveillants et systématiquement bloqués.

### M-O

**Malware**  
Logiciel malveillant conçu pour endommager, perturber ou accéder illégalement à des systèmes informatiques.

**MITRE ATT&CK**  
Framework qui documente les tactiques, techniques et procédures (TTP) utilisées par les attaquants, servant de référence pour la classification des menaces.

**Module de protection**  
Composant spécifique de Cortex XDR qui fournit une protection contre un type particulier de menace (anti-malware, anti-exploit, etc.).

**NGAV (Next-Generation Antivirus)**  
Solution antivirus avancée qui utilise l'apprentissage automatique et l'analyse comportementale pour détecter les menaces inconnues.

**Orchestration**  
Automatisation et coordination de multiples systèmes de sécurité et processus de réponse.

### P-R

**Persistance**  
Technique utilisée par les attaquants pour maintenir leur accès à un système compromis après un redémarrage.

**Politique de sécurité**  
Ensemble de règles et de paramètres qui définissent comment les agents Cortex XDR protègent les endpoints.

**Quarantaine**  
Isolation d'un fichier malveillant pour empêcher son exécution ou sa propagation.

**Ransomware**  
Type de malware qui chiffre les données de la victime et exige une rançon pour leur déchiffrement.

**Règle de détection**  
Ensemble de conditions qui, lorsqu'elles sont remplies, déclenchent une alerte de sécurité.

**Remédiation**  
Actions entreprises pour corriger un problème de sécurité et restaurer les systèmes à un état sécurisé.

**Réponse automatisée**  
Actions prédéfinies exécutées automatiquement en réponse à des alertes ou incidents spécifiques.

### S-U

**Sandbox**  
Environnement isolé utilisé pour exécuter et analyser des fichiers ou programmes suspects sans risque pour le système réel.

**Score de risque**  
Valeur numérique attribuée à une alerte ou un incident pour indiquer son niveau de gravité et sa priorité.

**SIEM (Security Information and Event Management)**  
Système qui collecte, analyse et corrèle les données de sécurité provenant de diverses sources.

**SOAR (Security Orchestration, Automation and Response)**  
Plateforme qui automatise et orchestre les processus de réponse aux incidents de sécurité.

**Telemetry**  
Données collectées à partir des endpoints et du réseau pour analyse de sécurité.

**Threat Intelligence**  
Informations sur les menaces actuelles et émergentes, utilisées pour améliorer la détection et la prévention.

**TTP (Tactiques, Techniques et Procédures)**  
Méthodes et comportements utilisés par les attaquants lors de leurs opérations.

### V-Z

**Vulnérabilité**  
Faiblesse dans un système ou une application qui peut être exploitée par des attaquants.

**XDR (Extended Detection and Response)**  
Solution de sécurité qui unifie la détection et la réponse aux menaces à travers plusieurs couches de sécurité (endpoints, réseau, cloud, etc.).

**XQL (XDR Query Language)**  
Langage de requête spécifique à Cortex XDR permettant d'interroger et d'analyser les données de sécurité.

**Zero Trust**  
Modèle de sécurité qui ne fait confiance à aucun utilisateur ou système par défaut, exigeant une vérification continue.

**Zero-day**  
Vulnérabilité inconnue du fabricant et pour laquelle aucun correctif n'est disponible.

## 12.2 Ressources supplémentaires

Cette section fournit des ressources additionnelles pour approfondir vos connaissances et optimiser votre utilisation de Cortex XDR.

![Centre de ressources](/home/ubuntu/cortex_xdr_manuel/images/resource_center.png)

*Figure 12.2 : Centre de ressources Cortex XDR*

### Documentation officielle

Pour accéder à la documentation officielle la plus récente :

![Documentation officielle](/home/ubuntu/cortex_xdr_manuel/images/official_documentation.png)

*Figure 12.3 : Accès à la documentation officielle*

1. **Documentation en ligne**
   - Site web : [https://docs-cortex.paloaltonetworks.com](https://docs-cortex.paloaltonetworks.com)
   - Guides utilisateur complets
   - Notes de version et nouveautés
   - Guides de dépannage

2. **Accès depuis la console**
   - Cliquez sur l'icône d'aide (?) dans le coin supérieur droit
   - Sélectionnez "Documentation"
   - La documentation contextuelle s'ouvre, pertinente pour la page actuelle

3. **Ressources téléchargeables**
   - Guides d'administration au format PDF
   - Fiches de référence rapide
   - Guides de déploiement
   - Livres blancs techniques

### Formation et certification

Pour développer vos compétences sur Cortex XDR :

![Formation et certification](/home/ubuntu/cortex_xdr_manuel/images/training_certification.png)

*Figure 12.4 : Options de formation et certification*

1. **Formations officielles**
   - Portail de formation : [https://education.paloaltonetworks.com](https://education.paloaltonetworks.com)
   - Cours en ligne et en présentiel
   - Laboratoires pratiques
   - Webinaires et démonstrations

2. **Parcours de certification**
   - PCNSE (Palo Alto Networks Certified Network Security Engineer)
   - PCNSC (Palo Alto Networks Certified Security Consultant)
   - Certifications spécialisées Cortex

3. **Ressources d'auto-formation**
   - Tutoriels vidéo
   - Environnements de laboratoire virtuels
   - Études de cas
   - Exercices pratiques

### Communauté et support

Pour obtenir de l'aide et partager des connaissances :

![Communauté et support](/home/ubuntu/cortex_xdr_manuel/images/community_support.png)

*Figure 12.5 : Ressources communautaires et support*

1. **Portail de support**
   - Accès : [https://support.paloaltonetworks.com](https://support.paloaltonetworks.com)
   - Base de connaissances
   - Soumission de tickets
   - Téléchargement de logiciels
   - Vérification de l'état des services

2. **Communauté Live**
   - Forum d'utilisateurs
   - Discussions techniques
   - Partage de bonnes pratiques
   - Questions et réponses

3. **Programmes et événements**
   - Groupes d'utilisateurs régionaux
   - Conférences annuelles
   - Webinaires thématiques
   - Ateliers techniques

### Ressources de threat intelligence

Pour rester informé sur les menaces actuelles :

![Ressources de threat intelligence](/home/ubuntu/cortex_xdr_manuel/images/threat_intelligence_resources.png)

*Figure 12.6 : Ressources de threat intelligence*

1. **Unit 42**
   - Blog : [https://unit42.paloaltonetworks.com](https://unit42.paloaltonetworks.com)
   - Rapports de recherche
   - Analyses de menaces
   - Bulletins de sécurité

2. **AutoFocus**
   - Portail de threat intelligence
   - Analyses de malware
   - Indicateurs de compromission
   - Tendances des menaces

3. **Ressources partenaires**
   - MITRE ATT&CK
   - VirusTotal
   - AlienVault OTX
   - Communautés ISAC sectorielles

## 12.3 Checklist de configuration

Cette checklist vous aide à vérifier que votre déploiement Cortex XDR est correctement configuré et optimisé.

![Checklist de configuration](/home/ubuntu/cortex_xdr_manuel/images/configuration_checklist.png)

*Figure 12.7 : Checklist interactive de configuration*

### Configuration initiale

Vérifiez que ces éléments fondamentaux sont configurés :

- [ ] **Compte administrateur**
  - [ ] Mot de passe fort défini
  - [ ] Authentification multifacteur activée
  - [ ] Contact de récupération configuré

- [ ] **Utilisateurs et rôles**
  - [ ] Rôles personnalisés créés selon les besoins
  - [ ] Principe du moindre privilège appliqué
  - [ ] Utilisateurs assignés aux rôles appropriés

- [ ] **Groupes d'endpoints**
  - [ ] Structure logique définie (par fonction, département, etc.)
  - [ ] Tous les endpoints assignés à au moins un groupe
  - [ ] Hiérarchie de groupes configurée si nécessaire

- [ ] **Politiques de sécurité**
  - [ ] Politique par défaut configurée
  - [ ] Politiques spécifiques créées pour différents groupes
  - [ ] Toutes les politiques testées avant déploiement complet

### Protection et détection

Vérifiez que ces fonctionnalités de protection sont activées et configurées :

- [ ] **Protection anti-malware**
  - [ ] Analyse à l'accès activée
  - [ ] Analyses planifiées configurées
  - [ ] Actions automatiques définies

- [ ] **Protection anti-exploit**
  - [ ] Niveau de protection approprié sélectionné
  - [ ] Techniques pertinentes activées
  - [ ] Exclusions nécessaires configurées

- [ ] **Protection comportementale**
  - [ ] Détection d'activités suspectes activée
  - [ ] Protection contre les ransomwares activée
  - [ ] Seuils ajustés selon l'environnement

- [ ] **Règles de détection**
  - [ ] Règles par défaut révisées et ajustées
  - [ ] Règles personnalisées créées pour les besoins spécifiques
  - [ ] Tests effectués pour valider l'efficacité

### Réponse et investigation

Vérifiez que ces capacités de réponse sont configurées :

- [ ] **Actions automatisées**
  - [ ] Règles d'action automatique définies
  - [ ] Niveaux d'autorisation configurés
  - [ ] Notifications d'actions configurées

- [ ] **Playbooks**
  - [ ] Playbooks de base configurés
  - [ ] Assignation automatique configurée
  - [ ] Intégration avec les systèmes de ticketing

- [ ] **Outils d'investigation**
  - [ ] Requêtes XQL personnalisées créées
  - [ ] Dashboards d'investigation configurés
  - [ ] Modèles de rapport définis

### Intégrations et notifications

Vérifiez que ces intégrations sont configurées :

- [ ] **Intégrations SIEM/SOAR**
  - [ ] Connexion établie et testée
  - [ ] Mappage des champs configuré
  - [ ] Flux de données vérifié

- [ ] **Threat Intelligence**
  - [ ] Sources externes connectées
  - [ ] Fréquence de mise à jour définie
  - [ ] Application aux détections vérifiée

- [ ] **Notifications**
  - [ ] Canaux de notification configurés
  - [ ] Règles de notification définies
  - [ ] Tests de notification effectués

### Maintenance et optimisation

Vérifiez que ces processus de maintenance sont en place :

- [ ] **Sauvegarde de configuration**
  - [ ] Sauvegarde initiale complète effectuée
  - [ ] Processus de sauvegarde régulière défini
  - [ ] Procédure de restauration testée

- [ ] **Gestion des mises à jour**
  - [ ] Stratégie de mise à jour définie
  - [ ] Groupes de test identifiés
  - [ ] Calendrier de maintenance établi

- [ ] **Surveillance des performances**
  - [ ] Métriques clés identifiées
  - [ ] Alertes de performance configurées
  - [ ] Processus d'optimisation défini

## 12.4 FAQ - Questions fréquemment posées

Cette section répond aux questions les plus fréquemment posées par les utilisateurs de Cortex XDR.

![FAQ illustrée](/home/ubuntu/cortex_xdr_manuel/images/illustrated_faq.png)

*Figure 12.8 : FAQ illustrée*

### Questions générales

**Q: Quelle est la différence entre Cortex XDR et un EDR traditionnel ?**

R: Contrairement aux solutions EDR traditionnelles qui se concentrent uniquement sur les endpoints, Cortex XDR est une solution de détection et réponse étendue (Extended Detection and Response) qui intègre et corrèle les données provenant de multiples sources : endpoints, réseau, cloud et identités. Cette approche unifiée permet une détection plus précise des menaces complexes et une vision plus complète des incidents de sécurité.

![Comparaison XDR vs EDR](/home/ubuntu/cortex_xdr_manuel/images/xdr_vs_edr.png)

*Figure 12.9 : Comparaison entre XDR et EDR traditionnel*

**Q: Cortex XDR remplace-t-il mon antivirus existant ?**

R: Oui, Cortex XDR inclut des capacités NGAV (Next-Generation Antivirus) qui remplacent les solutions antivirus traditionnelles. Il combine la détection basée sur les signatures avec des analyses comportementales et l'apprentissage automatique pour offrir une protection supérieure contre les malwares connus et inconnus. Lors du déploiement, l'agent Cortex XDR peut automatiquement désinstaller les solutions antivirus compatibles pour éviter les conflits.

**Q: Quelle est la charge système typique de l'agent Cortex XDR ?**

R: L'agent Cortex XDR est conçu pour être léger avec une empreinte système minimale. En fonctionnement normal, l'utilisation CPU est généralement inférieure à 2% et l'utilisation mémoire entre 100-200 MB. Pendant les analyses planifiées, l'utilisation peut temporairement augmenter, mais des contrôles de limitation des ressources permettent de s'assurer que l'impact sur les performances reste minimal.

### Installation et déploiement

**Q: Comment déployer Cortex XDR à grande échelle ?**

R: Pour un déploiement à grande échelle, plusieurs méthodes sont disponibles :
- Utilisation de GPO/Active Directory pour les environnements Windows
- Scripts de déploiement automatisés pour les environnements mixtes
- Intégration avec des outils de gestion de configuration comme SCCM, Ansible, Chef ou Puppet
- Déploiement via des solutions MDM pour les appareils mobiles et macOS
- Intégration dans les images système standard

Le déploiement par phases est recommandé, en commençant par un groupe pilote avant d'étendre progressivement à l'ensemble de l'organisation.

**Q: Quels sont les prérequis système pour l'agent Cortex XDR ?**

R: Les prérequis système varient selon le système d'exploitation, mais généralement :

Pour Windows :
- Windows 7 SP1 ou supérieur / Windows Server 2008 R2 SP1 ou supérieur
- Processeur 1 GHz ou plus rapide
- 2 GB RAM minimum (4 GB recommandé)
- 1 GB d'espace disque disponible

Pour macOS :
- macOS 10.13 (High Sierra) ou supérieur
- Processeur Intel ou Apple Silicon
- 2 GB RAM minimum
- 1 GB d'espace disque disponible

Pour Linux :
- Distributions majeures (RHEL, CentOS, Ubuntu, SUSE)
- Kernel 3.10 ou supérieur
- 2 GB RAM minimum
- 1 GB d'espace disque disponible

**Q: Comment gérer les conflits avec d'autres solutions de sécurité ?**

R: Pour éviter les conflits :
1. Identifiez toutes les solutions de sécurité existantes avant le déploiement
2. Consultez la liste de compatibilité dans la documentation Cortex XDR
3. Désinstallez les solutions incompatibles ou configurez des exclusions mutuelles
4. Déployez d'abord en mode surveillance uniquement pour identifier les problèmes potentiels
5. Activez progressivement les fonctionnalités de protection en surveillant les impacts

Dans certains cas, Cortex XDR peut coexister avec d'autres solutions de sécurité en mode de compatibilité, mais cela n'est généralement pas recommandé pour des performances optimales.

### Utilisation quotidienne

**Q: Comment réduire le nombre de faux positifs ?**

R: Pour réduire les faux positifs :
1. Ajustez les seuils de sévérité des règles de détection
2. Créez des exclusions spécifiques pour les applications légitimes qui déclenchent régulièrement des alertes
3. Utilisez la fonctionnalité d'apprentissage pour que le système s'adapte à votre environnement
4. Documentez et marquez systématiquement les faux positifs pour améliorer la détection
5. Mettez régulièrement à jour les politiques de sécurité en fonction des retours d'expérience

![Réduction des faux positifs](/home/ubuntu/cortex_xdr_manuel/images/reducing_false_positives.png)

*Figure 12.10 : Processus de réduction des faux positifs*

**Q: Comment investiguer efficacement un incident ?**

R: Pour une investigation efficace :
1. Commencez par examiner le résumé de l'incident pour comprendre sa portée et sa sévérité
2. Analysez la chronologie pour établir la séquence des événements
3. Identifiez le point d'entrée initial (patient zéro)
4. Examinez les artefacts associés (fichiers, processus, connexions réseau)
5. Utilisez les outils de visualisation pour comprendre les relations entre les événements
6. Recherchez des activités similaires sur d'autres endpoints pour identifier une propagation
7. Documentez vos découvertes et actions dans les notes d'incident

**Q: Comment personnaliser les dashboards pour mon équipe ?**

R: Pour personnaliser les dashboards :
1. Accédez à la section Dashboards et cliquez sur "Créer un dashboard"
2. Sélectionnez un modèle ou commencez avec une page vide
3. Ajoutez des widgets pertinents (graphiques, tableaux, métriques)
4. Configurez chaque widget avec les requêtes XQL appropriées
5. Organisez la disposition selon vos besoins
6. Définissez des filtres globaux pour permettre une exploration interactive
7. Partagez le dashboard avec les membres de votre équipe ou gardez-le privé

Chaque rôle dans l'équipe SOC peut bénéficier de dashboards spécifiques : vue opérationnelle pour les analystes, vue tactique pour les responsables d'équipe, et vue stratégique pour les CISO.

### Dépannage

**Q: Que faire si un agent ne se connecte pas à la console ?**

R: Si un agent ne se connecte pas :
1. Vérifiez la connectivité réseau de l'endpoint
2. Assurez-vous que les ports requis sont ouverts (443/TCP par défaut)
3. Vérifiez que le service de l'agent est en cours d'exécution sur l'endpoint
4. Consultez les journaux de l'agent dans le dossier d'installation
5. Vérifiez les certificats et l'horloge système de l'endpoint
6. Essayez de redémarrer le service de l'agent
7. En dernier recours, réinstallez l'agent

**Q: Comment résoudre les problèmes de performance liés à l'agent ?**

R: Pour résoudre les problèmes de performance :
1. Mettez à jour l'agent vers la dernière version
2. Vérifiez les exclusions pour les applications critiques
3. Ajustez les paramètres de scan (planification, intensité)
4. Vérifiez les conflits avec d'autres solutions de sécurité
5. Collectez les journaux de diagnostic pour analyse
6. Appliquez les recommandations d'optimisation de la documentation
7. Contactez le support technique si le problème persiste

![Dépannage de performance](/home/ubuntu/cortex_xdr_manuel/images/performance_troubleshooting.png)

*Figure 12.11 : Processus de dépannage des problèmes de performance*

**Q: Que faire en cas d'échec d'une mise à jour d'agent ?**

R: En cas d'échec de mise à jour :
1. Vérifiez les prérequis système pour la nouvelle version
2. Consultez les journaux de mise à jour sur l'endpoint
3. Essayez une réinstallation manuelle de l'agent
4. Vérifiez les conflits potentiels avec d'autres logiciels
5. Utilisez l'outil de dépannage de mise à jour disponible dans la console
6. Appliquez les correctifs ou workarounds documentés
7. Escaladez au support technique avec les journaux de diagnostic
