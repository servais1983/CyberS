# ğŸ§  Volatility - Analyse Forensique de la MÃ©moire

## ğŸ“Œ Qu'est-ce que Volatility ?

**Volatility** est un framework open-source destinÃ© Ã  lâ€™analyse de la mÃ©moire volatile (RAM) dâ€™un systÃ¨me informatique. Il permet aux enquÃªteurs forensiques de :
- Extraire des informations sensibles (processus, connexions rÃ©seau, DLL, etc.)
- Analyser les traces dâ€™un logiciel malveillant
- DÃ©terminer lâ€™Ã©tat dâ€™un systÃ¨me Ã  un moment donnÃ©

Volatility est indÃ©pendant du systÃ¨me dâ€™exploitation de lâ€™hÃ´te et peut analyser des images mÃ©moire de **Windows, Linux, macOS**, etc.

Il existe deux principales versions :
- **Volatility 2.x** (Python 2, plus utilisÃ©e mais moins maintenue)
- **Volatility 3** (Python 3, rÃ©Ã©criture complÃ¨te avec une meilleure structure modulaire)

---

## âš™ï¸ Installation

### Volatility 2.x (Linux)
```bash
git clone https://github.com/volatilityfoundation/volatility.git
cd volatility
python2 vol.py -h
Volatility 3 (Linux ou Windows)
bash
Copier
Modifier
git clone https://github.com/volatilityfoundation/volatility3.git
cd volatility3
python3 vol.py -h
ğŸ§  Formats de fichiers supportÃ©s
.raw (dump brut)

.mem, .lime (Linux)

.vmem (VMware)

.dmp / .hiberfil.sys (Windows)

.elf, .core, .crash (Linux)

ğŸ” Commandes gÃ©nÃ©rales (Volatility 3)
bash
Copier
Modifier
python3 vol.py -f <fichier_memoire> windows.info
python3 vol.py -f <fichier_memoire> -p <profile> <plugin>
ğŸªŸ Modules Volatility pour Windows
ğŸ”§ Informations systÃ¨me
windows.info â€” Infos sur lâ€™OS, version, build, etc.

windows.pslist â€” Liste des processus actifs

windows.pstree â€” Arborescence des processus

windows.psscan â€” Recherche de processus (inclus processus cachÃ©s)

windows.modules â€” Liste des modules chargÃ©s

ğŸ“‚ Fichiers et registres
windows.filescan â€” Recherche de fichiers en mÃ©moire

windows.registry.printkey â€” Affiche une clÃ© de registre

windows.registry.hivescan â€” Recherche de hives en mÃ©moire

windows.registry.hivelist â€” Liste des hives

ğŸŒ RÃ©seau
windows.netscan â€” Connexions rÃ©seau et sockets (TCP/UDP)

ğŸ” Mots de passe et utilisateurs
windows.hashdump â€” Dump des mots de passe NTLM

windows.lsadump â€” Extraction des secrets du LSA

ğŸ§Ÿ DÃ©tection de malwares
windows.malfind â€” Recherche dâ€™injections de code

windows.ssdt â€” Analyse de la SSDT (rootkits)

windows.callbacks â€” VÃ©rifie les callbacks suspects

ğŸ§ Modules Volatility pour Linux
ğŸ”§ Informations systÃ¨me
linux_banner â€” Version du kernel

linux_pslist â€” Liste des processus

linux_pstree â€” Arborescence des processus

linux_psaux â€” Processus avec arguments

linux_proc_maps â€” Cartographie mÃ©moire dâ€™un processus

linux_cpuinfo â€” Infos CPU

ğŸ“‚ Fichiers et modules
linux_lsmod â€” Liste des modules noyau

linux_check_afinfo â€” VÃ©rifie les fonctions socket

linux_find_file â€” Recherche de fichiers en mÃ©moire

ğŸ”’ SÃ©curitÃ© et utilisateurs
linux_bash â€” Affiche les historiques Bash

linux_passwd â€” Montre les utilisateurs et leurs mots de passe

linux_shadow_hashes â€” Dump des hashes depuis /etc/shadow

ğŸŒ RÃ©seau
linux_netstat â€” Ports et connexions

linux_ifconfig â€” Interfaces rÃ©seau

ğŸ“˜ Exemples de commandes
bash
Copier
Modifier
# Windows - Liste des processus
python3 vol.py -f win10.raw windows.pslist

# Windows - Recherche de rootkits via malfind
python3 vol.py -f win10.raw windows.malfind

# Linux - Affiche lâ€™historique bash
python3 vol.py -f linux.lime linux_bash

# Linux - Liste les processus
python3 vol.py -f linux.lime linux_pslist
ğŸ›  Astuces
Toujours utiliser windows.psscan en plus de pslist pour dÃ©tecter les processus cachÃ©s.

Utiliser malfind pour dÃ©tecter les injections en mÃ©moire.

Combinez hivelist + printkey pour explorer les clÃ©s de registre.

ğŸ“š Liens utiles
Site officiel : https://www.volatilityfoundation.org/

Repo GitHub Volatility 3 : https://github.com/volatilityfoundation/volatility3

Profils Linux avec LiME : https://github.com/504ensicsLabs/LiME


## ğŸ§¾ Analyse du Registre Windows avec Volatility

Le **registre Windows** contient une Ã©norme quantitÃ© d'informations sur le systÃ¨me, les logiciels, les utilisateurs, les configurations, etc. Volatility permet d'extraire et d'examiner ces donnÃ©es **directement depuis l'image mÃ©moire**, sans avoir besoin dâ€™un accÃ¨s au disque.

---

### ğŸ“œ Modules liÃ©s au registre

#### `windows.registry.hivescan`
- **But** : Scanne la mÃ©moire Ã  la recherche de structures de registre (`CMHIVE`).
- **UtilitÃ©** : Identifier les emplacements des hives (bases de registre) dans la mÃ©moire, y compris celles non rÃ©pertoriÃ©es.

#### `windows.registry.hivelist`
- **But** : Affiche une liste des hives (bases du registre) trouvÃ©es dans la mÃ©moire.
- **Affiche** :
  - L'adresse mÃ©moire
  - Le chemin du fichier hive (par ex. `\SystemRoot\System32\Config\SAM`)
  - Le nom associÃ© (SAM, SYSTEM, SOFTWARE, NTUSER.DATâ€¦)

#### `windows.registry.printkey`
- **But** : Affiche le contenu d'une **clÃ© spÃ©cifique** dans le registre.
- **Usage** :
  ```bash
  python3 vol.py -f win10.raw windows.registry.printkey --key "Software\\Microsoft\\Windows\\CurrentVersion\\Run"
UtilitÃ© :

Voir les programmes lancÃ©s au dÃ©marrage (Run, RunOnce)

Explorer des valeurs prÃ©cises dans les branches NTUSER, SYSTEM, etc.

windows.registry.userassist
But : Affiche les programmes utilisÃ©s rÃ©cemment via les clÃ©s UserAssist

UtilitÃ© : RÃ©vÃ©ler les habitudes dâ€™utilisation dâ€™un utilisateur

ğŸ§ª Exemple de Workflow : Analyse du registre
Lister les hives disponibles

bash
Copier
Modifier
python3 vol.py -f win10.raw windows.registry.hivelist
RÃ©sultat attendu :

pgsql
Copier
Modifier
Virtual            Physical           Name
0xfffff8a000022000 0x122000           \SystemRoot\System32\Config\SYSTEM
0xfffff8a000070000 0x170000           \??\C:\Users\User\ntuser.dat
Explorer une clÃ© du registre SYSTEM

bash
Copier
Modifier
python3 vol.py -f win10.raw windows.registry.printkey --key "Select" --hive-offset 0xfffff8a000022000
Explorer les programmes lancÃ©s au dÃ©marrage dâ€™un utilisateur

bash
Copier
Modifier
python3 vol.py -f win10.raw windows.registry.printkey --key "Software\\Microsoft\\Windows\\CurrentVersion\\Run" --hive-offset 0xfffff8a000070000
ğŸ“‚ Types de hives utiles
Hive	Contenu principal
SYSTEM	Infos sur les pilotes, services, contrÃ´le du dÃ©marrage
SOFTWARE	Infos sur les programmes installÃ©s
SAM	Comptes utilisateurs locaux, SID, groupes
SECURITY	Infos sur les politiques de sÃ©curitÃ©
NTUSER.DAT	ParamÃ¨tres spÃ©cifiques Ã  l'utilisateur

ğŸ” Astuce pratique
Combinez hivelist avec printkey pour naviguer et extraire n'importe quelle valeur de registre.

Les valeurs comme Run, LastVisitedMRU, TypedURLs ou MountPoints2 rÃ©vÃ¨lent souvent des indices dâ€™activitÃ©s malveillantes ou dâ€™utilisation suspecte.

ğŸ“˜ Exemple avancÃ© : Extraction du SID utilisateur
Identifier le hive SAM :

bash
Copier
Modifier
python3 vol.py -f win10.raw windows.registry.hivelist
Extraire les utilisateurs :

bash
Copier
Modifier
python3 vol.py -f win10.raw windows.registry.printkey --key "SAM\\Domains\\Account\\Users\\Names" --hive-offset 0xfffff8a000034000
Cela donne les noms d'utilisateurs et permet d'aller plus loin pour rÃ©cupÃ©rer les SID ou analyser les droits associÃ©s.

ğŸ” SÃ©curitÃ© et malveillance
Les artefacts du registre sont prÃ©cieux pour :

DÃ©tecter les persistances (Run, Services, etc.)

RÃ©vÃ©ler les utilisateurs actifs

Identifier les logiciels malveillants configurÃ©s pour se relancer

go
Copier
Modifier

